USE WAREHOUSE PIPE_LARGE;
USE SCHEMA SCRATCH.ROBINPATEL;

CREATE OR REPLACE TABLE MODULE_CURRENT_TERRITORY
(
    ID                                               NUMBER,
    VERSION                                          NUMBER,
    CURRENCY                                         VARCHAR,
    LOCALE                                           VARCHAR,
    NAME                                             VARCHAR,
    HOLD                                             DOUBLE,
    REWARD_FRIEND_BUY                                DOUBLE,
    REWARD_REFERRER_FRIEND                           DOUBLE,
    DEFAULT_AFFILIATE_ID                             NUMBER,
    DEFAULT_API_AFFILIATE_ID                         NUMBER,
    DOUBLE_OPT_IN_REQUIRED                           NUMBER,
    MIN_BOOK_VALUE_FOR_REFERAL_CREDIT                NUMBER,
    ALTERNATE_LINKS_HTML                             VARCHAR,
    DEFAULT_SUPPORT_EMAIL                            VARCHAR,
    DEFAULT_SUPPORT_NUMBER                           VARCHAR,
    MOBILE_GOOGLE_ANALYTICS_ID                       VARCHAR,
    EXACT_TARGET_ADHOC_PUBLICATION_LIST_ID           NUMBER,
    EXACT_TARGET_ADHOC_SUBSCRIBER_LIST_ID            NUMBER,
    EXACT_TARGET_ALL_SUBSCRIBERS_PUBLICATION_LIST_ID NUMBER,
    EXACT_TARGET_EDITORS_PICK_PUBLICATION_LIST_ID    NUMBER,
    EXACT_TARGET_EXACT_TARGET_AFFILIATE_ID           NUMBER,
    EXACT_TARGET_HAND_PICKED_SUBSCRIBER_LIST_ID      NUMBER,
    EXACT_TARGET_WEEKLY_PUBLICATION_LIST_ID          NUMBER,
    EXACT_TARGET_WEEKLY_SUBSCRIBER_LIST_ID           NUMBER,
    DEFAULT_AIRPORT_ID                               NUMBER,
    APP_STORE_URL                                    VARCHAR,
    GOOGLE_PLAY_STORE_URL                            VARCHAR,
    TERMS_AND_CONDITIONS_REQUIRED                    NUMBER,
    FLIGHT_FINDER_REDIRECT_BASE_URL                  VARCHAR,
    PHRASE_APP_LOCALE_NAME                           VARCHAR,
    COUNTRY_NAME                                     VARCHAR,
    SHOW_BOOKING_TERMS_DISCLAIMER                    NUMBER,
    CSS_LOCATION                                     VARCHAR,
    MOBILE_CSS_LOCATION                              VARCHAR,
    GOOGLE_MAPS_DEFAULT_LATITUDE                     DOUBLE,
    GOOGLE_MAPS_DEFAULT_LONGITUDE                    DOUBLE,
    GOOGLE_MAPS_DEFAULT_ZOOM                         DOUBLE,
    SYNC_SALE_PERFORMANCE_DATA                       NUMBER,
    DISPLAY_DEPOSIT_INFO                             NUMBER,
    ALLOW_HAND_PICKED_UNSUBSCRIBING                  NUMBER,
    DEFAULT_FILTER_PAGE_LINK                         VARCHAR,
    SMART_STAY                                       NUMBER,
    OPTIMIZELY_SNIPPET_PATH                          VARCHAR,
    MOBILE_OPTIMIZELY_SNIPPET_PATH                   VARCHAR,
    BACKFILL_ENABLED                                 NUMBER,
    BACKFILL_THRESHOLD                               NUMBER,
    IMPRESSUM_REQUIRED                               NUMBER,
    COOKIE_POLICY                                    NUMBER,
    HREF_LANG                                        VARCHAR,
    OVERWRITE_TERRITORY_NAME_FOR_EXACT_TARGET        VARCHAR,
    DISCLAIMER_TEXTIA                                NUMBER,
    SHOW_DESTINATION_FILTER                          NUMBER,
    FORCED_CURRENCY_SYMBOL                           VARCHAR,
    SHOW_TYPE_FILTER                                 NUMBER,
    TERMS_AND_CONDITIONS_CLAUSES_REQUIRED            NUMBER,
    BLOG_LINK                                        VARCHAR,
    DISPLAY_COMPANY_INFO                             NUMBER,
    DISPLAY_IN_SEO_FOOTER                            NUMBER,
    FUSION_ENABLED                                   NUMBER,
    MOBILE_WRAP_GOOGLE_ANALYTICS_ID                  VARCHAR,
    CAREERS_URL                                      VARCHAR,
    IS_CEE_TERRITORY                                 NUMBER,
    IS_ABLE_TO_SELL_FLIGHTS                          NUMBER,
    IS_COLLECTION_PANELS_ENABLED                     NUMBER,
    DEFAULT_WRAP_APP_AFFILIATE_ID                    NUMBER,
    TRACKING_SCRIPT_HEAD                             VARCHAR,
    TRACKING_SCRIPT_BODY                             VARCHAR,
    ZERO_DEPOSIT_ALLOWED                             NUMBER,
    DISPLAY_ZERO_DEPOSIT_INFO                        NUMBER,
    SHOW_TAX_INCLUSIVE_RATES                         NUMBER,
    NIN_ENABLED                                      NUMBER,
    SHOW_SALES_INVOLVEMENT                           BOOLEAN,
    SHOW_URGENCY_ON_BOOKING_FORM                     BOOLEAN,
    SHOW_LOW_PRICE_GUARANTEE_BLOCK                   BOOLEAN,
    SHOW_PRICE_GUARANTEE_BAR                         BOOLEAN,
    FILENAME                                         VARCHAR,
    FILE_ROW_NUMBER                                  NUMBER,
    SCHEDULE_TSTAMP                                  TIMESTAMPNTZ,
    SCHEDULE                                         VARCHAR,
    FLUX_PERIODS                                     NUMBER,
    EXTRACTED_AT                                     TIMESTAMPNTZ,
    DATASET_NAME                                     VARCHAR,
    DATA_SOURCE                                      VARCHAR,
    LOADED_AT                                        TIMESTAMPNTZ,
    UPDATED_AT                                       TIMESTAMPLTZ
)
    CLUSTER BY (CAST(SCHEDULE_TSTAMP AS DATE));

MERGE INTO MODULE_CURRENT_TERRITORY AS TARGET
    USING (
        WITH row_number AS ( --create index based on import recency
            SELECT t.*,
                   ROW_NUMBER() OVER (PARTITION BY t.id ORDER BY t.LOADED_AT DESC) AS rn
            FROM TERRITORY_STREAM t
--             WHERE LOADED_AT >= TIMESTAMPADD('hour', -1, '{schedule_tstamp}'::TIMESTAMP) -- TODO: for batch incremental load
        )
        SELECT ID,
               VERSION,
               CURRENCY,
               LOCALE,
               NAME,
               HOLD,
               REWARD_FRIEND_BUY,
               REWARD_REFERRER_FRIEND,
               DEFAULT_AFFILIATE_ID,
               DEFAULT_API_AFFILIATE_ID,
               DOUBLE_OPT_IN_REQUIRED,
               MIN_BOOK_VALUE_FOR_REFERAL_CREDIT,
               ALTERNATE_LINKS_HTML,
               DEFAULT_SUPPORT_EMAIL,
               DEFAULT_SUPPORT_NUMBER,
               MOBILE_GOOGLE_ANALYTICS_ID,
               EXACT_TARGET_ADHOC_PUBLICATION_LIST_ID,
               EXACT_TARGET_ADHOC_SUBSCRIBER_LIST_ID,
               EXACT_TARGET_ALL_SUBSCRIBERS_PUBLICATION_LIST_ID,
               EXACT_TARGET_EDITORS_PICK_PUBLICATION_LIST_ID,
               EXACT_TARGET_EXACT_TARGET_AFFILIATE_ID,
               EXACT_TARGET_HAND_PICKED_SUBSCRIBER_LIST_ID,
               EXACT_TARGET_WEEKLY_PUBLICATION_LIST_ID,
               EXACT_TARGET_WEEKLY_SUBSCRIBER_LIST_ID,
               DEFAULT_AIRPORT_ID,
               APP_STORE_URL,
               GOOGLE_PLAY_STORE_URL,
               TERMS_AND_CONDITIONS_REQUIRED,
               FLIGHT_FINDER_REDIRECT_BASE_URL,
               PHRASE_APP_LOCALE_NAME,
               COUNTRY_NAME,
               SHOW_BOOKING_TERMS_DISCLAIMER,
               CSS_LOCATION,
               MOBILE_CSS_LOCATION,
               GOOGLE_MAPS_DEFAULT_LATITUDE,
               GOOGLE_MAPS_DEFAULT_LONGITUDE,
               GOOGLE_MAPS_DEFAULT_ZOOM,
               SYNC_SALE_PERFORMANCE_DATA,
               DISPLAY_DEPOSIT_INFO,
               ALLOW_HAND_PICKED_UNSUBSCRIBING,
               DEFAULT_FILTER_PAGE_LINK,
               SMART_STAY,
               OPTIMIZELY_SNIPPET_PATH,
               MOBILE_OPTIMIZELY_SNIPPET_PATH,
               BACKFILL_ENABLED,
               BACKFILL_THRESHOLD,
               IMPRESSUM_REQUIRED,
               COOKIE_POLICY,
               HREF_LANG,
               OVERWRITE_TERRITORY_NAME_FOR_EXACT_TARGET,
               DISCLAIMER_TEXTIA,
               SHOW_DESTINATION_FILTER,
               FORCED_CURRENCY_SYMBOL,
               SHOW_TYPE_FILTER,
               TERMS_AND_CONDITIONS_CLAUSES_REQUIRED,
               BLOG_LINK,
               DISPLAY_COMPANY_INFO,
               DISPLAY_IN_SEO_FOOTER,
               FUSION_ENABLED,
               MOBILE_WRAP_GOOGLE_ANALYTICS_ID,
               CAREERS_URL,
               IS_CEE_TERRITORY,
               IS_ABLE_TO_SELL_FLIGHTS,
               IS_COLLECTION_PANELS_ENABLED,
               DEFAULT_WRAP_APP_AFFILIATE_ID,
               TRACKING_SCRIPT_HEAD,
               TRACKING_SCRIPT_BODY,
               ZERO_DEPOSIT_ALLOWED,
               DISPLAY_ZERO_DEPOSIT_INFO,
               SHOW_TAX_INCLUSIVE_RATES,
               NIN_ENABLED,
               SHOW_SALES_INVOLVEMENT,
               SHOW_URGENCY_ON_BOOKING_FORM,
               SHOW_LOW_PRICE_GUARANTEE_BLOCK,
               SHOW_PRICE_GUARANTEE_BAR,
               FILENAME,
               FILE_ROW_NUMBER,
               SCHEDULE_TSTAMP,
               SCHEDULE,
               FLUX_PERIODS,
               EXTRACTED_AT,
               DATASET_NAME,
               DATA_SOURCE,
               LOADED_AT,
               CURRENT_TIMESTAMP AS UPDATED_AT
        FROM row_number
        WHERE rn = 1
    ) AS BATCH ON TARGET.ID = BATCH.ID
    WHEN NOT MATCHED
        THEN INSERT (ID,
                     VERSION,
                     CURRENCY,
                     LOCALE,
                     NAME,
                     HOLD,
                     REWARD_FRIEND_BUY,
                     REWARD_REFERRER_FRIEND,
                     DEFAULT_AFFILIATE_ID,
                     DEFAULT_API_AFFILIATE_ID,
                     DOUBLE_OPT_IN_REQUIRED,
                     MIN_BOOK_VALUE_FOR_REFERAL_CREDIT,
                     ALTERNATE_LINKS_HTML,
                     DEFAULT_SUPPORT_EMAIL,
                     DEFAULT_SUPPORT_NUMBER,
                     MOBILE_GOOGLE_ANALYTICS_ID,
                     EXACT_TARGET_ADHOC_PUBLICATION_LIST_ID,
                     EXACT_TARGET_ADHOC_SUBSCRIBER_LIST_ID,
                     EXACT_TARGET_ALL_SUBSCRIBERS_PUBLICATION_LIST_ID,
                     EXACT_TARGET_EDITORS_PICK_PUBLICATION_LIST_ID,
                     EXACT_TARGET_EXACT_TARGET_AFFILIATE_ID,
                     EXACT_TARGET_HAND_PICKED_SUBSCRIBER_LIST_ID,
                     EXACT_TARGET_WEEKLY_PUBLICATION_LIST_ID,
                     EXACT_TARGET_WEEKLY_SUBSCRIBER_LIST_ID,
                     DEFAULT_AIRPORT_ID,
                     APP_STORE_URL,
                     GOOGLE_PLAY_STORE_URL,
                     TERMS_AND_CONDITIONS_REQUIRED,
                     FLIGHT_FINDER_REDIRECT_BASE_URL,
                     PHRASE_APP_LOCALE_NAME,
                     COUNTRY_NAME,
                     SHOW_BOOKING_TERMS_DISCLAIMER,
                     CSS_LOCATION,
                     MOBILE_CSS_LOCATION,
                     GOOGLE_MAPS_DEFAULT_LATITUDE,
                     GOOGLE_MAPS_DEFAULT_LONGITUDE,
                     GOOGLE_MAPS_DEFAULT_ZOOM,
                     SYNC_SALE_PERFORMANCE_DATA,
                     DISPLAY_DEPOSIT_INFO,
                     ALLOW_HAND_PICKED_UNSUBSCRIBING,
                     DEFAULT_FILTER_PAGE_LINK,
                     SMART_STAY,
                     OPTIMIZELY_SNIPPET_PATH,
                     MOBILE_OPTIMIZELY_SNIPPET_PATH,
                     BACKFILL_ENABLED,
                     BACKFILL_THRESHOLD,
                     IMPRESSUM_REQUIRED,
                     COOKIE_POLICY,
                     HREF_LANG,
                     OVERWRITE_TERRITORY_NAME_FOR_EXACT_TARGET,
                     DISCLAIMER_TEXTIA,
                     SHOW_DESTINATION_FILTER,
                     FORCED_CURRENCY_SYMBOL,
                     SHOW_TYPE_FILTER,
                     TERMS_AND_CONDITIONS_CLAUSES_REQUIRED,
                     BLOG_LINK,
                     DISPLAY_COMPANY_INFO,
                     DISPLAY_IN_SEO_FOOTER,
                     FUSION_ENABLED,
                     MOBILE_WRAP_GOOGLE_ANALYTICS_ID,
                     CAREERS_URL,
                     IS_CEE_TERRITORY,
                     IS_ABLE_TO_SELL_FLIGHTS,
                     IS_COLLECTION_PANELS_ENABLED,
                     DEFAULT_WRAP_APP_AFFILIATE_ID,
                     TRACKING_SCRIPT_HEAD,
                     TRACKING_SCRIPT_BODY,
                     ZERO_DEPOSIT_ALLOWED,
                     DISPLAY_ZERO_DEPOSIT_INFO,
                     SHOW_TAX_INCLUSIVE_RATES,
                     NIN_ENABLED,
                     SHOW_SALES_INVOLVEMENT,
                     SHOW_URGENCY_ON_BOOKING_FORM,
                     SHOW_LOW_PRICE_GUARANTEE_BLOCK,
                     SHOW_PRICE_GUARANTEE_BAR,
                     FILENAME,
                     FILE_ROW_NUMBER,
                     SCHEDULE_TSTAMP,
                     SCHEDULE,
                     FLUX_PERIODS,
                     EXTRACTED_AT,
                     DATASET_NAME,
                     DATA_SOURCE,
                     LOADED_AT,
                     UPDATED_AT)
        VALUES (BATCH.ID,
                BATCH.VERSION,
                BATCH.CURRENCY,
                BATCH.LOCALE,
                BATCH.NAME,
                BATCH.HOLD,
                BATCH.REWARD_FRIEND_BUY,
                BATCH.REWARD_REFERRER_FRIEND,
                BATCH.DEFAULT_AFFILIATE_ID,
                BATCH.DEFAULT_API_AFFILIATE_ID,
                BATCH.DOUBLE_OPT_IN_REQUIRED,
                BATCH.MIN_BOOK_VALUE_FOR_REFERAL_CREDIT,
                BATCH.ALTERNATE_LINKS_HTML,
                BATCH.DEFAULT_SUPPORT_EMAIL,
                BATCH.DEFAULT_SUPPORT_NUMBER,
                BATCH.MOBILE_GOOGLE_ANALYTICS_ID,
                BATCH.EXACT_TARGET_ADHOC_PUBLICATION_LIST_ID,
                BATCH.EXACT_TARGET_ADHOC_SUBSCRIBER_LIST_ID,
                BATCH.EXACT_TARGET_ALL_SUBSCRIBERS_PUBLICATION_LIST_ID,
                BATCH.EXACT_TARGET_EDITORS_PICK_PUBLICATION_LIST_ID,
                BATCH.EXACT_TARGET_EXACT_TARGET_AFFILIATE_ID,
                BATCH.EXACT_TARGET_HAND_PICKED_SUBSCRIBER_LIST_ID,
                BATCH.EXACT_TARGET_WEEKLY_PUBLICATION_LIST_ID,
                BATCH.EXACT_TARGET_WEEKLY_SUBSCRIBER_LIST_ID,
                BATCH.DEFAULT_AIRPORT_ID,
                BATCH.APP_STORE_URL,
                BATCH.GOOGLE_PLAY_STORE_URL,
                BATCH.TERMS_AND_CONDITIONS_REQUIRED,
                BATCH.FLIGHT_FINDER_REDIRECT_BASE_URL,
                BATCH.PHRASE_APP_LOCALE_NAME,
                BATCH.COUNTRY_NAME,
                BATCH.SHOW_BOOKING_TERMS_DISCLAIMER,
                BATCH.CSS_LOCATION,
                BATCH.MOBILE_CSS_LOCATION,
                BATCH.GOOGLE_MAPS_DEFAULT_LATITUDE,
                BATCH.GOOGLE_MAPS_DEFAULT_LONGITUDE,
                BATCH.GOOGLE_MAPS_DEFAULT_ZOOM,
                BATCH.SYNC_SALE_PERFORMANCE_DATA,
                BATCH.DISPLAY_DEPOSIT_INFO,
                BATCH.ALLOW_HAND_PICKED_UNSUBSCRIBING,
                BATCH.DEFAULT_FILTER_PAGE_LINK,
                BATCH.SMART_STAY,
                BATCH.OPTIMIZELY_SNIPPET_PATH,
                BATCH.MOBILE_OPTIMIZELY_SNIPPET_PATH,
                BATCH.BACKFILL_ENABLED,
                BATCH.BACKFILL_THRESHOLD,
                BATCH.IMPRESSUM_REQUIRED,
                BATCH.COOKIE_POLICY,
                BATCH.HREF_LANG,
                BATCH.OVERWRITE_TERRITORY_NAME_FOR_EXACT_TARGET,
                BATCH.DISCLAIMER_TEXTIA,
                BATCH.SHOW_DESTINATION_FILTER,
                BATCH.FORCED_CURRENCY_SYMBOL,
                BATCH.SHOW_TYPE_FILTER,
                BATCH.TERMS_AND_CONDITIONS_CLAUSES_REQUIRED,
                BATCH.BLOG_LINK,
                BATCH.DISPLAY_COMPANY_INFO,
                BATCH.DISPLAY_IN_SEO_FOOTER,
                BATCH.FUSION_ENABLED,
                BATCH.MOBILE_WRAP_GOOGLE_ANALYTICS_ID,
                BATCH.CAREERS_URL,
                BATCH.IS_CEE_TERRITORY,
                BATCH.IS_ABLE_TO_SELL_FLIGHTS,
                BATCH.IS_COLLECTION_PANELS_ENABLED,
                BATCH.DEFAULT_WRAP_APP_AFFILIATE_ID,
                BATCH.TRACKING_SCRIPT_HEAD,
                BATCH.TRACKING_SCRIPT_BODY,
                BATCH.ZERO_DEPOSIT_ALLOWED,
                BATCH.DISPLAY_ZERO_DEPOSIT_INFO,
                BATCH.SHOW_TAX_INCLUSIVE_RATES,
                BATCH.NIN_ENABLED,
                BATCH.SHOW_SALES_INVOLVEMENT,
                BATCH.SHOW_URGENCY_ON_BOOKING_FORM,
                BATCH.SHOW_LOW_PRICE_GUARANTEE_BLOCK,
                BATCH.SHOW_PRICE_GUARANTEE_BAR,
                BATCH.FILENAME,
                BATCH.FILE_ROW_NUMBER,
                BATCH.SCHEDULE_TSTAMP,
                BATCH.SCHEDULE,
                BATCH.FLUX_PERIODS,
                BATCH.EXTRACTED_AT,
                BATCH.DATASET_NAME,
                BATCH.DATA_SOURCE,
                BATCH.LOADED_AT,
                BATCH.UPDATED_AT)
    WHEN MATCHED AND TARGET.LOADED_AT < BATCH.LOADED_AT
        THEN UPDATE SET
        TARGET.ID = BATCH.ID,
        TARGET.VERSION = BATCH.VERSION,
        TARGET.CURRENCY = BATCH.CURRENCY,
        TARGET.LOCALE = BATCH.LOCALE,
        TARGET.NAME = BATCH.NAME,
        TARGET.HOLD = BATCH.HOLD,
        TARGET.REWARD_FRIEND_BUY = BATCH.REWARD_FRIEND_BUY,
        TARGET.REWARD_REFERRER_FRIEND = BATCH.REWARD_REFERRER_FRIEND,
        TARGET.DEFAULT_AFFILIATE_ID = BATCH.DEFAULT_AFFILIATE_ID,
        TARGET.DEFAULT_API_AFFILIATE_ID = BATCH.DEFAULT_API_AFFILIATE_ID,
        TARGET.DOUBLE_OPT_IN_REQUIRED = BATCH.DOUBLE_OPT_IN_REQUIRED,
        TARGET.MIN_BOOK_VALUE_FOR_REFERAL_CREDIT = BATCH.MIN_BOOK_VALUE_FOR_REFERAL_CREDIT,
        TARGET.ALTERNATE_LINKS_HTML = BATCH.ALTERNATE_LINKS_HTML,
        TARGET.DEFAULT_SUPPORT_EMAIL = BATCH.DEFAULT_SUPPORT_EMAIL,
        TARGET.DEFAULT_SUPPORT_NUMBER = BATCH.DEFAULT_SUPPORT_NUMBER,
        TARGET.MOBILE_GOOGLE_ANALYTICS_ID = BATCH.MOBILE_GOOGLE_ANALYTICS_ID,
        TARGET.EXACT_TARGET_ADHOC_PUBLICATION_LIST_ID = BATCH.EXACT_TARGET_ADHOC_PUBLICATION_LIST_ID,
        TARGET.EXACT_TARGET_ADHOC_SUBSCRIBER_LIST_ID = BATCH.EXACT_TARGET_ADHOC_SUBSCRIBER_LIST_ID,
        TARGET.EXACT_TARGET_ALL_SUBSCRIBERS_PUBLICATION_LIST_ID = BATCH.EXACT_TARGET_ALL_SUBSCRIBERS_PUBLICATION_LIST_ID,
        TARGET.EXACT_TARGET_EDITORS_PICK_PUBLICATION_LIST_ID = BATCH.EXACT_TARGET_EDITORS_PICK_PUBLICATION_LIST_ID,
        TARGET.EXACT_TARGET_EXACT_TARGET_AFFILIATE_ID = BATCH.EXACT_TARGET_EXACT_TARGET_AFFILIATE_ID,
        TARGET.EXACT_TARGET_HAND_PICKED_SUBSCRIBER_LIST_ID = BATCH.EXACT_TARGET_HAND_PICKED_SUBSCRIBER_LIST_ID,
        TARGET.EXACT_TARGET_WEEKLY_PUBLICATION_LIST_ID = BATCH.EXACT_TARGET_WEEKLY_PUBLICATION_LIST_ID,
        TARGET.EXACT_TARGET_WEEKLY_SUBSCRIBER_LIST_ID = BATCH.EXACT_TARGET_WEEKLY_SUBSCRIBER_LIST_ID,
        TARGET.DEFAULT_AIRPORT_ID = BATCH.DEFAULT_AIRPORT_ID,
        TARGET.APP_STORE_URL = BATCH.APP_STORE_URL,
        TARGET.GOOGLE_PLAY_STORE_URL = BATCH.GOOGLE_PLAY_STORE_URL,
        TARGET.TERMS_AND_CONDITIONS_REQUIRED = BATCH.TERMS_AND_CONDITIONS_REQUIRED,
        TARGET.FLIGHT_FINDER_REDIRECT_BASE_URL = BATCH.FLIGHT_FINDER_REDIRECT_BASE_URL,
        TARGET.PHRASE_APP_LOCALE_NAME = BATCH.PHRASE_APP_LOCALE_NAME,
        TARGET.COUNTRY_NAME = BATCH.COUNTRY_NAME,
        TARGET.SHOW_BOOKING_TERMS_DISCLAIMER = BATCH.SHOW_BOOKING_TERMS_DISCLAIMER,
        TARGET.CSS_LOCATION = BATCH.CSS_LOCATION,
        TARGET.MOBILE_CSS_LOCATION = BATCH.MOBILE_CSS_LOCATION,
        TARGET.GOOGLE_MAPS_DEFAULT_LATITUDE = BATCH.GOOGLE_MAPS_DEFAULT_LATITUDE,
        TARGET.GOOGLE_MAPS_DEFAULT_LONGITUDE = BATCH.GOOGLE_MAPS_DEFAULT_LONGITUDE,
        TARGET.GOOGLE_MAPS_DEFAULT_ZOOM = BATCH.GOOGLE_MAPS_DEFAULT_ZOOM,
        TARGET.SYNC_SALE_PERFORMANCE_DATA = BATCH.SYNC_SALE_PERFORMANCE_DATA,
        TARGET.DISPLAY_DEPOSIT_INFO = BATCH.DISPLAY_DEPOSIT_INFO,
        TARGET.ALLOW_HAND_PICKED_UNSUBSCRIBING = BATCH.ALLOW_HAND_PICKED_UNSUBSCRIBING,
        TARGET.DEFAULT_FILTER_PAGE_LINK = BATCH.DEFAULT_FILTER_PAGE_LINK,
        TARGET.SMART_STAY = BATCH.SMART_STAY,
        TARGET.OPTIMIZELY_SNIPPET_PATH = BATCH.OPTIMIZELY_SNIPPET_PATH,
        TARGET.MOBILE_OPTIMIZELY_SNIPPET_PATH = BATCH.MOBILE_OPTIMIZELY_SNIPPET_PATH,
        TARGET.BACKFILL_ENABLED = BATCH.BACKFILL_ENABLED,
        TARGET.BACKFILL_THRESHOLD = BATCH.BACKFILL_THRESHOLD,
        TARGET.IMPRESSUM_REQUIRED = BATCH.IMPRESSUM_REQUIRED,
        TARGET.COOKIE_POLICY = BATCH.COOKIE_POLICY,
        TARGET.HREF_LANG = BATCH.HREF_LANG,
        TARGET.OVERWRITE_TERRITORY_NAME_FOR_EXACT_TARGET = BATCH.OVERWRITE_TERRITORY_NAME_FOR_EXACT_TARGET,
        TARGET.DISCLAIMER_TEXTIA = BATCH.DISCLAIMER_TEXTIA,
        TARGET.SHOW_DESTINATION_FILTER = BATCH.SHOW_DESTINATION_FILTER,
        TARGET.FORCED_CURRENCY_SYMBOL = BATCH.FORCED_CURRENCY_SYMBOL,
        TARGET.SHOW_TYPE_FILTER = BATCH.SHOW_TYPE_FILTER,
        TARGET.TERMS_AND_CONDITIONS_CLAUSES_REQUIRED = BATCH.TERMS_AND_CONDITIONS_CLAUSES_REQUIRED,
        TARGET.BLOG_LINK = BATCH.BLOG_LINK,
        TARGET.DISPLAY_COMPANY_INFO = BATCH.DISPLAY_COMPANY_INFO,
        TARGET.DISPLAY_IN_SEO_FOOTER = BATCH.DISPLAY_IN_SEO_FOOTER,
        TARGET.FUSION_ENABLED = BATCH.FUSION_ENABLED,
        TARGET.MOBILE_WRAP_GOOGLE_ANALYTICS_ID = BATCH.MOBILE_WRAP_GOOGLE_ANALYTICS_ID,
        TARGET.CAREERS_URL = BATCH.CAREERS_URL,
        TARGET.IS_CEE_TERRITORY = BATCH.IS_CEE_TERRITORY,
        TARGET.IS_ABLE_TO_SELL_FLIGHTS = BATCH.IS_ABLE_TO_SELL_FLIGHTS,
        TARGET.IS_COLLECTION_PANELS_ENABLED = BATCH.IS_COLLECTION_PANELS_ENABLED,
        TARGET.DEFAULT_WRAP_APP_AFFILIATE_ID = BATCH.DEFAULT_WRAP_APP_AFFILIATE_ID,
        TARGET.TRACKING_SCRIPT_HEAD = BATCH.TRACKING_SCRIPT_HEAD,
        TARGET.TRACKING_SCRIPT_BODY = BATCH.TRACKING_SCRIPT_BODY,
        TARGET.ZERO_DEPOSIT_ALLOWED = BATCH.ZERO_DEPOSIT_ALLOWED,
        TARGET.DISPLAY_ZERO_DEPOSIT_INFO = BATCH.DISPLAY_ZERO_DEPOSIT_INFO,
        TARGET.SHOW_TAX_INCLUSIVE_RATES = BATCH.SHOW_TAX_INCLUSIVE_RATES,
        TARGET.NIN_ENABLED = BATCH.NIN_ENABLED,
        TARGET.SHOW_SALES_INVOLVEMENT = BATCH.SHOW_SALES_INVOLVEMENT,
        TARGET.SHOW_URGENCY_ON_BOOKING_FORM = BATCH.SHOW_URGENCY_ON_BOOKING_FORM,
        TARGET.SHOW_LOW_PRICE_GUARANTEE_BLOCK = BATCH.SHOW_LOW_PRICE_GUARANTEE_BLOCK,
        TARGET.SHOW_PRICE_GUARANTEE_BAR = BATCH.SHOW_PRICE_GUARANTEE_BAR,
        TARGET.FILENAME = BATCH.FILENAME,
        TARGET.FILE_ROW_NUMBER = BATCH.FILE_ROW_NUMBER,
        TARGET.SCHEDULE_TSTAMP = BATCH.SCHEDULE_TSTAMP,
        TARGET.SCHEDULE = BATCH.SCHEDULE,
        TARGET.FLUX_PERIODS = BATCH.FLUX_PERIODS,
        TARGET.EXTRACTED_AT = BATCH.EXTRACTED_AT,
        TARGET.DATASET_NAME = BATCH.DATASET_NAME,
        TARGET.DATA_SOURCE = BATCH.DATA_SOURCE,
        TARGET.LOADED_AT = BATCH.LOADED_AT,
        TARGET.UPDATED_AT = BATCH.UPDATED_AT
;