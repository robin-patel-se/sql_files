USE ROLE personal_role__robinpatel
;

CREATE SCHEMA IF NOT EXISTS raw_vault_dev_robin.sfsc
;

CREATE OR REPLACE TRANSIENT TABLE raw_vault_dev_robin.sfsc.account_m_z
	CLONE raw_vault.sfsc.account_m_z
;

CREATE SCHEMA IF NOT EXISTS hygiene_vault_dev_robin.sfsc
;

CREATE OR REPLACE TRANSIENT TABLE hygiene_vault_dev_robin.sfsc.account_m_z
	CLONE hygiene_vault.sfsc.account_m_z
;

CREATE SCHEMA IF NOT EXISTS latest_vault_dev_robin.sfsc
;

CREATE OR REPLACE TRANSIENT TABLE latest_vault_dev_robin.sfsc.account_m_z
	CLONE latest_vault.sfsc.account_m_z

CREATE OR REPLACE TRANSIENT TABLE latest_vault_dev_robin.sfsc.account_a_l
	CLONE latest_vault.sfsc.account_a_l
;

/*
dataset_task \
    --include 'incoming.sfsc.account_m_z' \
    --kind 'incoming' \
    --operation LatestRecordsOperation \
    --method 'run' \
    --upstream \
    --start '2025-09-17 00:00:00' \
    --end '2025-09-17 00:00:00'

dataset_task \
    --include 'incoming.sfsc.account_m_z' \
    --kind 'incoming' \
    --operation IngestOperation \
    --method 'run' \
    --upstream \
    --start '2025-08-01 00:00:00' \
    --end '2025-08-02 00:00:00'


dataset_task \
    --include 'incoming.sfsc.account_m_z' \
    --kind 'incoming' \
    --operation HygieneOperation \
    --method 'run' \
	--upstream \
    --start '2025-08-01 00:00:00' \
    --end '2025-08-02 00:00:00'


dataset_task \
    --include 'incoming.sfsc.account_m_z' \
    --kind 'incoming' \
    --operation LatestRecordsOperation \
    --method 'run' \
    --start '2025-08-01 00:00:00' \
    --end '2025-08-02 00:00:00'
*/


------------------------------------------------------------------------------------------------------------------------
-- pre dep step

------------------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE TRANSIENT TABLE raw_vault_dev_robin.sfsc.account_m_z_20250917 CLONE raw_vault_dev_robin.sfsc.account_m_z
;

DROP TABLE raw_vault_dev_robin.sfsc.account_m_z
;

SELECT GET_DDL('table', 'hygiene_vault.sfsc.account_m_z')
;

CREATE OR REPLACE TRANSIENT TABLE raw_vault_dev_robin.sfsc.account_m_z CLUSTER BY (TO_DATE(schedule_tstamp))
(
	dataset_name                                VARCHAR       NOT NULL,
	dataset_source                              VARCHAR       NOT NULL,
	schedule_interval                           VARCHAR       NOT NULL,
	schedule_tstamp                             TIMESTAMP_NTZ NOT NULL,
	run_tstamp                                  TIMESTAMP_NTZ NOT NULL,
	loaded_at                                   TIMESTAMP_NTZ NOT NULL,
	filename                                    VARCHAR       NOT NULL,
	file_row_number                             NUMBER        NOT NULL,
	extract_metadata                            VARIANT,
	id                                          VARCHAR,
	lastmodifieddate                            VARCHAR,
	manual__c                                   VARCHAR,
	marketing_addendum__c                       VARCHAR,
	marketing_id__c                             VARCHAR,
	master_contract_field_updated_by__c         VARCHAR,
	master_contract_signed__c                   VARCHAR,
	master_contract_signed_group__c             VARCHAR,
	master_contract_wf__c                       VARCHAR,
	master_group_field_updated_by__c            VARCHAR,
	masteraccount__c                            VARCHAR,
	masteraccountid__c                          VARCHAR,
	masterrecordid                              VARCHAR,
	media_contact_territory__pc                 VARCHAR,
	most_recent_addendum_request__c             VARCHAR,
	most_recent_addendum_status__c              VARCHAR,
	most_recent_booking__c                      VARCHAR,
	most_recent_chain_addendum_status__c        VARCHAR,
	most_recent_close_date__c                   VARCHAR,
	most_recent_commission__c                   VARCHAR,
	most_recent_contract_effective_date__c      VARCHAR,
	most_recent_contract_effective_date_ro__c   VARCHAR,
	most_recent_contract_effective_date_uk__c   VARCHAR,
	most_recent_cw_close_date__c                VARCHAR,
	most_recent_deal_end_date__c                VARCHAR,
	most_recent_finance_edit_datetime__c        VARCHAR,
	most_recent_group_chain_addendum_request__c VARCHAR,
	most_recent_ihp_addendum_request__c         VARCHAR,
	most_recent_ihp_addendum_status__c          VARCHAR,
	most_recent_ihp_contract_signed_date__c     VARCHAR,
	most_recent_margin__c                       VARCHAR,
	most_recent_master_contract_signed_date__c  VARCHAR,
	most_recent_opp__c                          VARCHAR,
	most_recent_package_destination__c          VARCHAR,
	most_recent_pd_proposed_start_date__c       VARCHAR,
	most_recent_proposed_start_date__c          VARCHAR,
	most_recent_proposed_start_date__pc         VARCHAR,
	most_recent_sale_id__c                      VARCHAR,
	most_recent_successful_deal__c              VARCHAR,
	most_recent_successful_sync__c              VARCHAR,
	most_recent_sync_datetime__c                VARCHAR,
	most_recent_sync_outcome__c                 VARCHAR,
	most_recent_ta_check__c                     VARCHAR,
	name                                        VARCHAR,
	nearest_airport_code__c                     VARCHAR,
	need_periods__c                             VARCHAR,
	new_business_challenge__c                   VARCHAR,
	next_proposed_start_date__c                 VARCHAR,
	no_gdpr_clause_signed_approved_by_sd__c     VARCHAR,
	notes__pc                                   VARCHAR,
	notes_on_working_with_se__c                 VARCHAR,
	ns_category__c                              VARCHAR,
	ns_category_customer__c                     VARCHAR,
	ns_contract_type__c                         VARCHAR,
	ns_update_bank_details__c                   VARCHAR,
	nscrm__balance__c                           VARCHAR,
	nscrm__credit_hold__c                       VARCHAR,
	nscrm__credit_limit__c                      VARCHAR,
	nscrm__days_overdue__c                      VARCHAR,
	nscrm__ns_credit_term_id__c                 VARCHAR,
	nscrm__ns_customer_category_id__c           VARCHAR,
	nscrm__ns_internal_id__c                    VARCHAR,
	nscrm__ns_internal_id__pc                   VARCHAR,
	nscrm__ns_sales_rep_id__c                   VARCHAR,
	nscrm__ns_shipping_item_id__c               VARCHAR,
	nscrm__ns_subsidiary_id__c                  VARCHAR,
	nscrm__ns_tax_item_id__c                    VARCHAR,
	nscrm__overdue_balance__c                   VARCHAR,
	nscrm__subsidiary__c                        VARCHAR,
	nscrm__taxable__c                           VARCHAR,
	number_of_active_addendums__c               VARCHAR,
	number_of_addendums__c                      VARCHAR,
	number_of_bookings__c                       VARCHAR,
	number_of_floors__c                         VARCHAR,
	number_of_opps__c                           VARCHAR,
	number_of_personal_injuries__c              VARCHAR,
	number_of_rooms__c                          VARCHAR,
	numberofemployees                           VARCHAR,
	open_opps__pc                               VARCHAR,
	opportunity_listing_fee__c                  VARCHAR,
	opportunity_to_pull_offers_from__c          VARCHAR,
	opted_in_for_always_on__c                   VARCHAR,
	opted_in_for_refundable_deals__c            VARCHAR,
	opted_in_for_suvc__c                        VARCHAR,
	original_contractor__c                      VARCHAR,
	overduebalance_netsuite__c                  VARCHAR,
	ownerid                                     VARCHAR,
	package_bank_country_selection__c           VARCHAR,
	parent_customer_ns_id__c                    VARCHAR,
	parent_ns_id__c                             VARCHAR,
	parent_vendor_ns_id__c                      VARCHAR,
	parentid                                    VARCHAR,
	partner_membership__c                       VARCHAR,
	partner_product__c                          VARCHAR,
	partner_region__c                           VARCHAR,
	partner_stage__c                            VARCHAR,
	payment_ns_id__c                            VARCHAR,
	payment_process__c                          VARCHAR,
	payment_process_ns_id__c                    VARCHAR,
	payment_terms_contracts__c                  VARCHAR,
	payment_terms_days__c                       VARCHAR,
	payment_terms_days_in_house_packages__c     VARCHAR,
	payment_terms_days_ns_id__c                 VARCHAR,
	person_account_email_address__c             VARCHAR,
	person_account_status__c                    VARCHAR,
	person_account_subscription_staatus__c      VARCHAR,
	person_account_territory__c                 VARCHAR,
	person_address_city__c                      VARCHAR,
	person_address_country__c                   VARCHAR,
	person_address_line_1__c                    VARCHAR,
	person_address_line_2__c                    VARCHAR,
	person_address_post_code__c                 VARCHAR,
	person_referred_by__c                       VARCHAR,
	personassistantname                         VARCHAR,
	personassistantphone                        VARCHAR,
	personbirthdate                             VARCHAR,
	personcontactid                             VARCHAR,
	persondepartment                            VARCHAR,
	personemail                                 VARCHAR,
	personemailbounceddate                      VARCHAR,
	personemailbouncedreason                    VARCHAR,
	personhasoptedoutofemail                    VARCHAR,
	personhomephone                             VARCHAR,
	personlastcurequestdate                     VARCHAR,
	personlastcuupdatedate                      VARCHAR,
	personleadsource                            VARCHAR,
	personmailingcity                           VARCHAR,
	personmailingcountry                        VARCHAR,
	personmailingcountrycode                    VARCHAR,
	personmailinggeocodeaccuracy                VARCHAR,
	personmailinglatitude                       VARCHAR,
	personmailinglongitude                      VARCHAR,
	personmailingpostalcode                     VARCHAR,
	personmailingstate                          VARCHAR,
	personmailingstatecode                      VARCHAR,
	personmailingstreet                         VARCHAR,
	personmobilephone                           VARCHAR,
	personothercity                             VARCHAR,
	personothercountry                          VARCHAR,
	personothercountrycode                      VARCHAR,
	personothergeocodeaccuracy                  VARCHAR,
	personotherlatitude                         VARCHAR,
	personotherlongitude                        VARCHAR,
	personotherphone                            VARCHAR,
	personotherpostalcode                       VARCHAR,
	personotherstate                            VARCHAR,
	personotherstatecode                        VARCHAR,
	personotherstreet                           VARCHAR,
	persontitle                                 VARCHAR,
	phone                                       VARCHAR,
	photourl                                    VARCHAR,
	posu_cluster__c                             VARCHAR,
	postandcommentprocessed__c                  VARCHAR,
	pre_qualification_status__c                 VARCHAR,
	pre_qualification_dach__c                   VARCHAR,
	pre_qualification_row__c                    VARCHAR,
	pre_qualification_uk__c                     VARCHAR,
	previous_account_name__c                    VARCHAR,
	price_check_url__c                          VARCHAR,
	primary__pc                                 VARCHAR,
	primary_contact__c                          VARCHAR,
	primary_contact_email__c                    VARCHAR,
	primary_contact_job_title__c                VARCHAR,
	primary_contact_phone__c                    VARCHAR,
	primary_contact_to_confirm_preview_link__c  VARCHAR,
	printtransactions_netsuite__c               VARCHAR,
	property_id__c                              VARCHAR,
	public_liability_insurance__c               VARCHAR,
	public_liability_insurance_confirmed__c     VARCHAR,
	public_liability_insurance_expiry__c        VARCHAR,
	qc_account_name__c                          VARCHAR,
	qc_contact_email__c                         VARCHAR,
	qc_contact_job_role__c                      VARCHAR,
	qc_contact_name__c                          VARCHAR,
	qc_contact_phone__c                         VARCHAR,
	qc_destination__c                           VARCHAR,
	qc_rating_t_a__c                            VARCHAR,
	qc_region__c                                VARCHAR,
	qc_rooms__c                                 VARCHAR,
	qc_shipping_address__c                      VARCHAR,
	qc_star_rating__c                           VARCHAR,
	qc_sub_region__c                            VARCHAR,
	qc_tripadvisor_link__c                      VARCHAR,
	qc_tripadvisor_rating__c                    VARCHAR,
	qc_website__c                               VARCHAR,
	rate_query_end_date__c                      VARCHAR,
	rate_query_start_date__c                    VARCHAR,
	rating_booking_com__c                       VARCHAR,
	rating_ta__c                                VARCHAR,
	rating                                      VARCHAR,
	reason_for_omission__c                      VARCHAR,
	record_count__c                             VARCHAR,
	recordstocheck__c                           VARCHAR,
	recordtypeid                                VARCHAR,
	recovered_amount__c                         VARCHAR,
	recoveries_next_steps_or_issues__c          VARCHAR,
	recoveries_owner__c                         VARCHAR,
	recoveries_payment_method__c                VARCHAR,
	recoveries_status__c                        VARCHAR,
	recovery_date__c                            VARCHAR,
	red_flag__c                                 VARCHAR,
	red_flag__pc                                VARCHAR,
	red_flag_date_time__c                       VARCHAR,
	red_flag_reason__c                          VARCHAR,
	red_flag_tp__c                              VARCHAR,
	red_flagged_by__c                           VARCHAR,
	region__c                                   VARCHAR,
	region_type__c                              VARCHAR,
	remove_red_flag__c                          VARCHAR,
	salutation                                  VARCHAR,
	saq_contact__c                              VARCHAR,
	saq_created__c                              VARCHAR,
	saq_form_link__c                            VARCHAR,
	saq_management_approval_needed__c           VARCHAR,
	saq_passed_date__c                          VARCHAR,
	saq_sent_date__c                            VARCHAR,
	saq_signed_date__c                          VARCHAR,
	saq_status__c                               VARCHAR,
	shippingcity                                VARCHAR,
	shippingcountry                             VARCHAR,
	shippingcountrycode                         VARCHAR,
	shippinggeocodeaccuracy                     VARCHAR,
	shippinglatitude                            VARCHAR,
	shippinglongitude                           VARCHAR,
	shippingpostalcode                          VARCHAR,
	shippingstate                               VARCHAR,
	shippingstatecode                           VARCHAR,
	shippingstreet                              VARCHAR,
	sicdesc                                     VARCHAR,
	stage_netsuite__c                           VARCHAR,
	star_rating__c                              VARCHAR,
	star_rating__pc                             VARCHAR,
	sub_affiliate_brand__c                      VARCHAR,
	sub_region__c                               VARCHAR,
	subsidiaries__c                             VARCHAR,
	sum_of_margin__c                            VARCHAR,
	sum_of_visits__c                            VARCHAR,
	swift__c                                    VARCHAR,
	swift_in_house_packages__c                  VARCHAR,
	swift_travelist__c                          VARCHAR,
	swift_validation__c                         VARCHAR,
	swift_validation_row__c                     VARCHAR,
	swift_value_netsuite__c                     VARCHAR,
	synxis_id__c                                VARCHAR,
	systemmodstamp                              VARCHAR,
	target_account_list__c                      VARCHAR,
	tax_item__c                                 VARCHAR,
	taxable_netsuite__c                         VARCHAR,
	taxexempt_netsuite__c                       VARCHAR,
	telephone_ins_prov__c                       VARCHAR,
	telephone_sales_commission__c               VARCHAR,
	temp_contact_checkbox__pc                   VARCHAR,
	third_party_notes__c                        VARCHAR,
	third_party_opt_in__c                       VARCHAR,
	third_party_payment_notes__c                VARCHAR,
	third_party_provider__c                     VARCHAR,
	today__c                                    VARCHAR,
	today_number__c                             VARCHAR,
	today_text__c                               VARCHAR,
	total_credit_cashed__c                      VARCHAR,
	total_member_spend__c                       VARCHAR,
	total_reviews_ta__c                         VARCHAR,
	travelbird_id__c                            VARCHAR,
	travelist_active__c                         VARCHAR,
	trimmed_hotel_name_contracts__c             VARCHAR,
	tripadvisor_link__c                         VARCHAR,
	tripadvisor_rating__c                       VARCHAR,
	trivago_link__c                             VARCHAR,
	tvl_company_signed_date__c                  VARCHAR,
	tvl_old_contract_version__c                 VARCHAR,
	type_ebd__c                                 VARCHAR,
	type_of_third_party__c                      VARCHAR,
	type                                        VARCHAR,
	uk_contact_status__c                        VARCHAR,
	uk_opportunity_status__c                    VARCHAR,
	update_customer_ns__c                       VARCHAR,
	update_vendor_ns__c                         VARCHAR,
	user_who_experienced_error__c               VARCHAR,
	vat_number__c                               VARCHAR,
	vat_number_id_ns__c                         VARCHAR,
	vat_number_in_house_packages__c             VARCHAR,
	vat_number_travelist__c                     VARCHAR,
	vat_number_validation__c                    VARCHAR,
	vat_number_validation_row__c                VARCHAR,
	vatregnumber_netsuite__c                    VARCHAR,
	vcc_netsuite__c                             VARCHAR,
	vendor_customer_sync_readiness__c           VARCHAR,
	vendor_id_netsuite__c                       VARCHAR,
	vendor_insert_ns__c                         VARCHAR,
	version_8_contract_approval_way__c          VARCHAR,
	virtual_credit_card__c                      VARCHAR,
	virtual_credit_card_in_house_packages__c    VARCHAR,
	virtual_credit_card_ns_id__c                VARCHAR,
	voucher_opt_in__c                           VARCHAR,
	web_phone__pc                               VARCHAR,
	website_sales_commission__c                 VARCHAR,
	website                                     VARCHAR,
	weekly_opt_in__c                            VARCHAR,
	wheelchair_accessible__c                    VARCHAR,
	zero_deposit__c                             VARCHAR,
	zoho_account_id__c                          VARCHAR,
	zoho_contact_id__pc                         VARCHAR,
	PRIMARY KEY (dataset_name, dataset_source, schedule_interval, schedule_tstamp, run_tstamp, filename,
				 file_row_number)
)
;

INSERT INTO raw_vault_dev_robin.sfsc.account_m_z (dataset_name,
												  dataset_source,
												  schedule_interval,
												  schedule_tstamp,
												  run_tstamp,
												  loaded_at,
												  filename,
												  file_row_number,
												  extract_metadata,
												  id,
												  lastmodifieddate,
												  manual__c,
												  marketing_addendum__c,
												  marketing_id__c,
												  master_contract_field_updated_by__c,
												  master_contract_signed__c,
												  master_contract_signed_group__c,
												  master_contract_wf__c,
												  master_group_field_updated_by__c,
												  masteraccount__c,
												  masteraccountid__c,
												  masterrecordid,
												  media_contact_territory__pc,
												  most_recent_addendum_request__c,
												  most_recent_addendum_status__c,
												  most_recent_booking__c,
												  most_recent_chain_addendum_status__c,
												  most_recent_close_date__c,
												  most_recent_commission__c,
												  most_recent_contract_effective_date__c,
												  most_recent_contract_effective_date_ro__c,
												  most_recent_contract_effective_date_uk__c,
												  most_recent_cw_close_date__c,
												  most_recent_deal_end_date__c,
												  most_recent_finance_edit_datetime__c,
												  most_recent_group_chain_addendum_request__c,
												  most_recent_ihp_addendum_request__c,
												  most_recent_ihp_addendum_status__c,
												  most_recent_ihp_contract_signed_date__c,
												  most_recent_margin__c,
												  most_recent_master_contract_signed_date__c,
												  most_recent_opp__c,
												  most_recent_package_destination__c,
												  most_recent_pd_proposed_start_date__c,
												  most_recent_proposed_start_date__c,
												  most_recent_proposed_start_date__pc,
												  most_recent_sale_id__c,
												  most_recent_successful_deal__c,
												  most_recent_successful_sync__c,
												  most_recent_sync_datetime__c,
												  most_recent_sync_outcome__c,
												  most_recent_ta_check__c,
												  name,
												  nearest_airport_code__c,
												  need_periods__c,
												  new_business_challenge__c,
												  next_proposed_start_date__c,
												  no_gdpr_clause_signed_approved_by_sd__c,
												  notes__pc,
												  notes_on_working_with_se__c,
												  ns_category__c,
												  ns_category_customer__c,
												  ns_contract_type__c,
												  ns_update_bank_details__c,
												  nscrm__balance__c,
												  nscrm__credit_hold__c,
												  nscrm__credit_limit__c,
												  nscrm__days_overdue__c,
												  nscrm__ns_credit_term_id__c,
												  nscrm__ns_customer_category_id__c,
												  nscrm__ns_internal_id__c,
												  nscrm__ns_internal_id__pc,
												  nscrm__ns_sales_rep_id__c,
												  nscrm__ns_shipping_item_id__c,
												  nscrm__ns_subsidiary_id__c,
												  nscrm__ns_tax_item_id__c,
												  nscrm__overdue_balance__c,
												  nscrm__subsidiary__c,
												  nscrm__taxable__c,
												  number_of_active_addendums__c,
												  number_of_addendums__c,
												  number_of_bookings__c,
												  number_of_floors__c,
												  number_of_opps__c,
												  number_of_personal_injuries__c,
												  number_of_rooms__c,
												  numberofemployees,
												  open_opps__pc,
												  opportunity_listing_fee__c,
												  opportunity_to_pull_offers_from__c,
												  opted_in_for_always_on__c,
												  opted_in_for_refundable_deals__c,
												  opted_in_for_suvc__c,
												  original_contractor__c,
												  overduebalance_netsuite__c,
												  ownerid,
												  package_bank_country_selection__c,
												  parent_customer_ns_id__c,
												  parent_ns_id__c,
												  parent_vendor_ns_id__c,
												  parentid,
												  partner_membership__c,
												  partner_product__c,
												  partner_region__c,
												  partner_stage__c,
												  payment_ns_id__c,
												  payment_process__c,
												  payment_process_ns_id__c,
												  payment_terms_contracts__c,
												  payment_terms_days__c,
												  payment_terms_days_in_house_packages__c,
												  payment_terms_days_ns_id__c,
												  person_account_email_address__c,
												  person_account_status__c,
												  person_account_subscription_staatus__c,
												  person_account_territory__c,
												  person_address_city__c,
												  person_address_country__c,
												  person_address_line_1__c,
												  person_address_line_2__c,
												  person_address_post_code__c,
												  person_referred_by__c,
												  personassistantname,
												  personassistantphone,
												  personbirthdate,
												  personcontactid,
												  persondepartment,
												  personemail,
												  personemailbounceddate,
												  personemailbouncedreason,
												  personhasoptedoutofemail,
												  personhomephone,
												  personlastcurequestdate,
												  personlastcuupdatedate,
												  personleadsource,
												  personmailingcity,
												  personmailingcountry,
												  personmailingcountrycode,
												  personmailinggeocodeaccuracy,
												  personmailinglatitude,
												  personmailinglongitude,
												  personmailingpostalcode,
												  personmailingstate,
												  personmailingstatecode,
												  personmailingstreet,
												  personmobilephone,
												  personothercity,
												  personothercountry,
												  personothercountrycode,
												  personothergeocodeaccuracy,
												  personotherlatitude,
												  personotherlongitude,
												  personotherphone,
												  personotherpostalcode,
												  personotherstate,
												  personotherstatecode,
												  personotherstreet,
												  persontitle,
												  phone,
												  photourl,
												  posu_cluster__c,
												  postandcommentprocessed__c,
												  pre_qualification_status__c,
												  pre_qualification_dach__c,
												  pre_qualification_row__c,
												  pre_qualification_uk__c,
												  previous_account_name__c,
												  price_check_url__c,
												  primary__pc,
												  primary_contact__c,
												  primary_contact_email__c,
												  primary_contact_job_title__c,
												  primary_contact_phone__c,
												  primary_contact_to_confirm_preview_link__c,
												  printtransactions_netsuite__c,
												  property_id__c,
												  public_liability_insurance__c,
												  public_liability_insurance_confirmed__c,
												  public_liability_insurance_expiry__c,
												  qc_account_name__c,
												  qc_contact_email__c,
												  qc_contact_job_role__c,
												  qc_contact_name__c,
												  qc_contact_phone__c,
												  qc_destination__c,
												  qc_rating_t_a__c,
												  qc_region__c,
												  qc_rooms__c,
												  qc_shipping_address__c,
												  qc_star_rating__c,
												  qc_sub_region__c,
												  qc_tripadvisor_link__c,
												  qc_tripadvisor_rating__c,
												  qc_website__c,
												  rate_query_end_date__c,
												  rate_query_start_date__c,
												  rating_booking_com__c,
												  rating_ta__c,
												  rating,
												  reason_for_omission__c,
												  record_count__c,
												  recordstocheck__c,
												  recordtypeid,
												  recovered_amount__c,
												  recoveries_next_steps_or_issues__c,
												  recoveries_owner__c,
												  recoveries_payment_method__c,
												  recoveries_status__c,
												  recovery_date__c,
												  red_flag__c,
												  red_flag__pc,
												  red_flag_date_time__c,
												  red_flag_reason__c,
												  red_flag_tp__c,
												  red_flagged_by__c,
												  region__c,
												  region_type__c,
												  remove_red_flag__c,
												  salutation,
												  saq_contact__c,
												  saq_created__c,
												  saq_form_link__c,
												  saq_management_approval_needed__c,
												  saq_passed_date__c,
												  saq_sent_date__c,
												  saq_signed_date__c,
												  saq_status__c,
												  shippingcity,
												  shippingcountry,
												  shippingcountrycode,
												  shippinggeocodeaccuracy,
												  shippinglatitude,
												  shippinglongitude,
												  shippingpostalcode,
												  shippingstate,
												  shippingstatecode,
												  shippingstreet,
												  sicdesc,
												  stage_netsuite__c,
												  star_rating__c,
												  star_rating__pc,
												  sub_affiliate_brand__c,
												  sub_region__c,
												  subsidiaries__c,
												  sum_of_margin__c,
												  sum_of_visits__c,
												  swift__c,
												  swift_in_house_packages__c,
												  swift_travelist__c,
												  swift_validation__c,
												  swift_validation_row__c,
												  swift_value_netsuite__c,
												  synxis_id__c,
												  systemmodstamp,
												  target_account_list__c,
												  tax_item__c,
												  taxable_netsuite__c,
												  taxexempt_netsuite__c,
												  telephone_ins_prov__c,
												  telephone_sales_commission__c,
												  temp_contact_checkbox__pc,
												  third_party_notes__c,
												  third_party_opt_in__c,
												  third_party_payment_notes__c,
												  third_party_provider__c,
												  today__c,
												  today_number__c,
												  today_text__c,
												  total_credit_cashed__c,
												  total_member_spend__c,
												  total_reviews_ta__c,
												  travelbird_id__c,
												  travelist_active__c,
												  trimmed_hotel_name_contracts__c,
												  tripadvisor_link__c,
												  tripadvisor_rating__c,
												  trivago_link__c,
												  tvl_company_signed_date__c,
												  tvl_old_contract_version__c,
												  type_ebd__c,
												  type_of_third_party__c,
												  type,
												  uk_contact_status__c,
												  uk_opportunity_status__c,
												  update_customer_ns__c,
												  update_vendor_ns__c,
												  user_who_experienced_error__c,
												  vat_number__c,
												  vat_number_id_ns__c,
												  vat_number_in_house_packages__c,
												  vat_number_travelist__c,
												  vat_number_validation__c,
												  vat_number_validation_row__c,
												  vatregnumber_netsuite__c,
												  vcc_netsuite__c,
												  vendor_customer_sync_readiness__c,
												  vendor_id_netsuite__c,
												  vendor_insert_ns__c,
												  version_8_contract_approval_way__c,
												  virtual_credit_card__c,
												  virtual_credit_card_in_house_packages__c,
												  virtual_credit_card_ns_id__c,
												  voucher_opt_in__c,
												  web_phone__pc,
												  website_sales_commission__c,
												  website,
												  weekly_opt_in__c,
												  wheelchair_accessible__c,
												  zero_deposit__c,
												  zoho_account_id__c,
												  zoho_contact_id__pc)
SELECT
	dataset_name,
	dataset_source,
	schedule_interval,
	schedule_tstamp,
	run_tstamp,
	loaded_at,
	filename,
	file_row_number,
	extract_metadata,
	id,
	lastmodifieddate,
	manual__c,
	marketing_addendum__c,
	marketing_id__c,
	master_contract_field_updated_by__c,
	master_contract_signed__c,
	master_contract_signed_group__c,
	master_contract_wf__c,
	master_group_field_updated_by__c,
	masteraccount__c,
	masteraccountid__c,
	masterrecordid,
	media_contact_territory__pc,
	most_recent_addendum_request__c,
	most_recent_addendum_status__c,
	most_recent_booking__c,
	most_recent_chain_addendum_status__c,
	most_recent_close_date__c,
	most_recent_commission__c,
	most_recent_contract_effective_date__c,
	most_recent_contract_effective_date_ro__c,
	most_recent_contract_effective_date_uk__c,
	most_recent_cw_close_date__c,
	most_recent_deal_end_date__c,
	most_recent_finance_edit_datetime__c,
	most_recent_group_chain_addendum_request__c,
	most_recent_ihp_addendum_request__c,
	most_recent_ihp_addendum_status__c,
	most_recent_ihp_contract_signed_date__c,
	most_recent_margin__c,
	most_recent_master_contract_signed_date__c,
	most_recent_opp__c,
	most_recent_package_destination__c,
	most_recent_pd_proposed_start_date__c,
	most_recent_proposed_start_date__c,
	most_recent_proposed_start_date__pc,
	most_recent_sale_id__c,
	most_recent_successful_deal__c,
	most_recent_successful_sync__c,
	most_recent_sync_datetime__c,
	most_recent_sync_outcome__c,
	most_recent_ta_check__c,
	name,
	nearest_airport_code__c,
	need_periods__c,
	new_business_challenge__c,
	next_proposed_start_date__c,
	no_gdpr_clause_signed_approved_by_sd__c,
	notes__pc,
	notes_on_working_with_se__c,
	ns_category__c,
	ns_category_customer__c,
	ns_contract_type__c,
	ns_update_bank_details__c,
	nscrm__balance__c,
	nscrm__credit_hold__c,
	nscrm__credit_limit__c,
	nscrm__days_overdue__c,
	nscrm__ns_credit_term_id__c,
	nscrm__ns_customer_category_id__c,
	nscrm__ns_internal_id__c,
	nscrm__ns_internal_id__pc,
	nscrm__ns_sales_rep_id__c,
	nscrm__ns_shipping_item_id__c,
	nscrm__ns_subsidiary_id__c,
	nscrm__ns_tax_item_id__c,
	nscrm__overdue_balance__c,
	nscrm__subsidiary__c,
	nscrm__taxable__c,
	number_of_active_addendums__c,
	number_of_addendums__c,
	number_of_bookings__c,
	number_of_floors__c,
	number_of_opps__c,
	number_of_personal_injuries__c,
	number_of_rooms__c,
	numberofemployees,
	open_opps__pc,
	opportunity_listing_fee__c,
	opportunity_to_pull_offers_from__c,
	opted_in_for_always_on__c,
	opted_in_for_refundable_deals__c,
	opted_in_for_suvc__c,
	original_contractor__c,
	overduebalance_netsuite__c,
	ownerid,
	package_bank_country_selection__c,
	parent_customer_ns_id__c,
	parent_ns_id__c,
	parent_vendor_ns_id__c,
	parentid,
	partner_membership__c,
	partner_product__c,
	partner_region__c,
	partner_stage__c,
	payment_ns_id__c,
	payment_process__c,
	payment_process_ns_id__c,
	payment_terms_contracts__c,
	payment_terms_days__c,
	payment_terms_days_in_house_packages__c,
	payment_terms_days_ns_id__c,
	person_account_email_address__c,
	person_account_status__c,
	person_account_subscription_staatus__c,
	person_account_territory__c,
	person_address_city__c,
	person_address_country__c,
	person_address_line_1__c,
	person_address_line_2__c,
	person_address_post_code__c,
	person_referred_by__c,
	personassistantname,
	personassistantphone,
	personbirthdate,
	personcontactid,
	persondepartment,
	personemail,
	personemailbounceddate,
	personemailbouncedreason,
	personhasoptedoutofemail,
	personhomephone,
	personlastcurequestdate,
	personlastcuupdatedate,
	personleadsource,
	personmailingcity,
	personmailingcountry,
	personmailingcountrycode,
	personmailinggeocodeaccuracy,
	personmailinglatitude,
	personmailinglongitude,
	personmailingpostalcode,
	personmailingstate,
	personmailingstatecode,
	personmailingstreet,
	personmobilephone,
	personothercity,
	personothercountry,
	personothercountrycode,
	personothergeocodeaccuracy,
	personotherlatitude,
	personotherlongitude,
	personotherphone,
	personotherpostalcode,
	personotherstate,
	personotherstatecode,
	personotherstreet,
	persontitle,
	phone,
	photourl,
	posu_cluster__c,
	postandcommentprocessed__c,
	pre_qualification_status__c,
	NULL,
	NULL,
	NULL,
	previous_account_name__c,
	price_check_url__c,
	primary__pc,
	primary_contact__c,
	primary_contact_email__c,
	primary_contact_job_title__c,
	primary_contact_phone__c,
	primary_contact_to_confirm_preview_link__c,
	printtransactions_netsuite__c,
	property_id__c,
	public_liability_insurance__c,
	public_liability_insurance_confirmed__c,
	public_liability_insurance_expiry__c,
	qc_account_name__c,
	qc_contact_email__c,
	qc_contact_job_role__c,
	qc_contact_name__c,
	qc_contact_phone__c,
	qc_destination__c,
	qc_rating_t_a__c,
	qc_region__c,
	qc_rooms__c,
	qc_shipping_address__c,
	qc_star_rating__c,
	qc_sub_region__c,
	qc_tripadvisor_link__c,
	qc_tripadvisor_rating__c,
	qc_website__c,
	rate_query_end_date__c,
	rate_query_start_date__c,
	rating_booking_com__c,
	rating_ta__c,
	rating,
	reason_for_omission__c,
	record_count__c,
	recordstocheck__c,
	recordtypeid,
	recovered_amount__c,
	recoveries_next_steps_or_issues__c,
	recoveries_owner__c,
	recoveries_payment_method__c,
	recoveries_status__c,
	recovery_date__c,
	red_flag__c,
	red_flag__pc,
	red_flag_date_time__c,
	red_flag_reason__c,
	red_flag_tp__c,
	red_flagged_by__c,
	region__c,
	region_type__c,
	remove_red_flag__c,
	salutation,
	saq_contact__c,
	saq_created__c,
	saq_form_link__c,
	saq_management_approval_needed__c,
	saq_passed_date__c,
	saq_sent_date__c,
	saq_signed_date__c,
	saq_status__c,
	shippingcity,
	shippingcountry,
	shippingcountrycode,
	shippinggeocodeaccuracy,
	shippinglatitude,
	shippinglongitude,
	shippingpostalcode,
	shippingstate,
	shippingstatecode,
	shippingstreet,
	sicdesc,
	stage_netsuite__c,
	star_rating__c,
	star_rating__pc,
	sub_affiliate_brand__c,
	sub_region__c,
	subsidiaries__c,
	sum_of_margin__c,
	sum_of_visits__c,
	swift__c,
	swift_in_house_packages__c,
	swift_travelist__c,
	swift_validation__c,
	swift_validation_row__c,
	swift_value_netsuite__c,
	synxis_id__c,
	systemmodstamp,
	target_account_list__c,
	tax_item__c,
	taxable_netsuite__c,
	taxexempt_netsuite__c,
	telephone_ins_prov__c,
	telephone_sales_commission__c,
	temp_contact_checkbox__pc,
	third_party_notes__c,
	third_party_opt_in__c,
	third_party_payment_notes__c,
	third_party_provider__c,
	today__c,
	today_number__c,
	today_text__c,
	total_credit_cashed__c,
	total_member_spend__c,
	total_reviews_ta__c,
	travelbird_id__c,
	travelist_active__c,
	trimmed_hotel_name_contracts__c,
	tripadvisor_link__c,
	tripadvisor_rating__c,
	trivago_link__c,
	tvl_company_signed_date__c,
	tvl_old_contract_version__c,
	type_ebd__c,
	type_of_third_party__c,
	type,
	uk_contact_status__c,
	uk_opportunity_status__c,
	update_customer_ns__c,
	update_vendor_ns__c,
	user_who_experienced_error__c,
	vat_number__c,
	vat_number_id_ns__c,
	vat_number_in_house_packages__c,
	vat_number_travelist__c,
	vat_number_validation__c,
	vat_number_validation_row__c,
	vatregnumber_netsuite__c,
	vcc_netsuite__c,
	vendor_customer_sync_readiness__c,
	vendor_id_netsuite__c,
	vendor_insert_ns__c,
	version_8_contract_approval_way__c,
	virtual_credit_card__c,
	virtual_credit_card_in_house_packages__c,
	virtual_credit_card_ns_id__c,
	voucher_opt_in__c,
	web_phone__pc,
	website_sales_commission__c,
	website,
	weekly_opt_in__c,
	wheelchair_accessible__c,
	zero_deposit__c,
	zoho_account_id__c,
	zoho_contact_id__pc
FROM raw_vault_dev_robin.sfsc.account_m_z_20250917 a
;

------------------------------------------------------------------------------------------------------------------------
-- hygiene

CREATE OR REPLACE TRANSIENT TABLE hygiene_vault_dev_robin.sfsc.account_m_z_20250918 CLONE hygiene_vault_dev_robin.sfsc.account_m_z
;

DROP TABLE hygiene_vault_dev_robin.sfsc.account_m_z
;

CREATE OR REPLACE TABLE hygiene_vault_dev_robin.sfsc.account_m_z
(
	-- (lineage) metadata for the current job
	schedule_tstamp                                      TIMESTAMP NOT NULL,
	run_tstamp                                           TIMESTAMP NOT NULL,
	operation_id                                         VARCHAR   NOT NULL,
	created_at                                           TIMESTAMP NOT NULL,
	updated_at                                           TIMESTAMP NOT NULL,

	-- (lineage) original metadata of row itself
	row_dataset_name                                     VARCHAR   NOT NULL,
	row_dataset_source                                   VARCHAR   NOT NULL,
	row_loaded_at                                        TIMESTAMP NOT NULL,
	row_schedule_tstamp                                  TIMESTAMP NOT NULL,
	row_run_tstamp                                       TIMESTAMP NOT NULL,
	row_filename                                         VARCHAR   NOT NULL,
	row_file_row_number                                  INT       NOT NULL,
	row_extract_metadata                                 VARIANT,


	-- transformed columns


	-- original columns
	id                                                   VARCHAR,
	lastmodifieddate                                     TIMESTAMP,
	manual__c                                            BOOLEAN,
	marketing_addendum__c                                BOOLEAN,
	marketing_id__c                                      VARCHAR,
	master_contract_field_updated_by__c                  VARCHAR,
	master_contract_signed__c                            BOOLEAN,
	master_contract_signed_group__c                      BOOLEAN,
	master_contract_wf__c                                BOOLEAN,
	master_group_field_updated_by__c                     VARCHAR,
	masteraccount__c                                     VARCHAR,
	masteraccountid__c                                   VARCHAR,
	masterrecordid                                       VARCHAR,
	media_contact_territory__pc                          VARCHAR,
	most_recent_addendum_request__c                      VARCHAR,
	most_recent_addendum_status__c                       VARCHAR,
	most_recent_booking__c                               TIMESTAMP,
	most_recent_chain_addendum_status__c                 VARCHAR,
	most_recent_close_date__c                            DATE,
	most_recent_commission__c                            DOUBLE PRECISION,
	most_recent_contract_effective_date__c               DATE,
	most_recent_contract_effective_date_ro__c            VARCHAR,
	most_recent_contract_effective_date_uk__c            VARCHAR,
	most_recent_cw_close_date__c                         DATE,
	most_recent_deal_end_date__c                         DATE,
	most_recent_finance_edit_datetime__c                 TIMESTAMP,
	most_recent_group_chain_addendum_request__c          VARCHAR,
	most_recent_ihp_addendum_request__c                  VARCHAR,
	most_recent_ihp_addendum_status__c                   VARCHAR,
	most_recent_ihp_contract_signed_date__c              DATE,
	most_recent_margin__c                                DOUBLE PRECISION,
	most_recent_master_contract_signed_date__c           DATE,
	most_recent_opp__c                                   VARCHAR,
	most_recent_package_destination__c                   VARCHAR,
	most_recent_pd_proposed_start_date__c                DATE,
	most_recent_proposed_start_date__c                   DATE,
	most_recent_proposed_start_date__pc                  DATE,
	most_recent_sale_id__c                               VARCHAR,
	most_recent_successful_deal__c                       DATE,
	most_recent_successful_sync__c                       TIMESTAMP,
	most_recent_sync_datetime__c                         TIMESTAMP,
	most_recent_sync_outcome__c                          VARCHAR,
	most_recent_ta_check__c                              DATE,
	name                                                 VARCHAR,
	nearest_airport_code__c                              VARCHAR,
	need_periods__c                                      VARCHAR,
	new_business_challenge__c                            BOOLEAN,
	next_proposed_start_date__c                          DATE,
	no_gdpr_clause_signed_approved_by_sd__c              BOOLEAN,
	notes__pc                                            VARCHAR,
	notes_on_working_with_se__c                          VARCHAR,
	ns_category__c                                       VARCHAR,
	ns_category_customer__c                              VARCHAR,
	ns_contract_type__c                                  VARCHAR,
	ns_update_bank_details__c                            BOOLEAN,
	nscrm__balance__c                                    DOUBLE PRECISION,
	nscrm__credit_hold__c                                BOOLEAN,
	nscrm__credit_limit__c                               DOUBLE PRECISION,
	nscrm__days_overdue__c                               DOUBLE PRECISION,
	nscrm__ns_credit_term_id__c                          VARCHAR,
	nscrm__ns_customer_category_id__c                    VARCHAR,
	nscrm__ns_internal_id__c                             VARCHAR,
	nscrm__ns_internal_id__pc                            VARCHAR,
	nscrm__ns_sales_rep_id__c                            VARCHAR,
	nscrm__ns_shipping_item_id__c                        VARCHAR,
	nscrm__ns_subsidiary_id__c                           VARCHAR,
	nscrm__ns_tax_item_id__c                             VARCHAR,
	nscrm__overdue_balance__c                            DOUBLE PRECISION,
	nscrm__subsidiary__c                                 VARCHAR,
	nscrm__taxable__c                                    BOOLEAN,
	number_of_active_addendums__c                        DOUBLE PRECISION,
	number_of_addendums__c                               DOUBLE PRECISION,
	number_of_bookings__c                                DOUBLE PRECISION,
	number_of_floors__c                                  DOUBLE PRECISION,
	number_of_opps__c                                    DOUBLE PRECISION,
	number_of_personal_injuries__c                       DOUBLE PRECISION,
	number_of_rooms__c                                   DOUBLE PRECISION,
	numberofemployees                                    INT,
	open_opps__pc                                        DOUBLE PRECISION,
	opportunity_listing_fee__c                           DOUBLE PRECISION,
	opportunity_to_pull_offers_from__c                   VARCHAR,
	opted_in_for_always_on__c                            VARCHAR,
	opted_in_for_refundable_deals__c                     VARCHAR,
	opted_in_for_suvc__c                                 VARCHAR,
	original_contractor__c                               VARCHAR,
	overduebalance_netsuite__c                           DOUBLE PRECISION,
	ownerid                                              VARCHAR,
	package_bank_country_selection__c                    VARCHAR,
	parent_customer_ns_id__c                             VARCHAR,
	parent_ns_id__c                                      VARCHAR,
	parent_vendor_ns_id__c                               VARCHAR,
	parentid                                             VARCHAR,
	partner_membership__c                                VARCHAR,
	partner_product__c                                   VARCHAR,
	partner_region__c                                    VARCHAR,
	partner_stage__c                                     VARCHAR,
	payment_ns_id__c                                     VARCHAR,
	payment_process__c                                   VARCHAR,
	payment_process_ns_id__c                             VARCHAR,
	payment_terms_contracts__c                           VARCHAR,
	payment_terms_days__c                                VARCHAR,
	payment_terms_days_in_house_packages__c              VARCHAR,
	payment_terms_days_ns_id__c                          VARCHAR,
	person_account_email_address__c                      VARCHAR,
	person_account_status__c                             VARCHAR,
	person_account_subscription_staatus__c               VARCHAR,
	person_account_territory__c                          VARCHAR,
	person_address_city__c                               VARCHAR,
	person_address_country__c                            VARCHAR,
	person_address_line_1__c                             VARCHAR,
	person_address_line_2__c                             VARCHAR,
	person_address_post_code__c                          VARCHAR,
	person_referred_by__c                                VARCHAR,
	personassistantname                                  VARCHAR,
	personassistantphone                                 VARCHAR,
	personbirthdate                                      DATE,
	personcontactid                                      VARCHAR,
	persondepartment                                     VARCHAR,
	personemail                                          VARCHAR,
	personemailbounceddate                               TIMESTAMP,
	personemailbouncedreason                             VARCHAR,
	personhasoptedoutofemail                             BOOLEAN,
	personhomephone                                      VARCHAR,
	personlastcurequestdate                              TIMESTAMP,
	personlastcuupdatedate                               TIMESTAMP,
	personleadsource                                     VARCHAR,
	personmailingcity                                    VARCHAR,
	personmailingcountry                                 VARCHAR,
	personmailingcountrycode                             VARCHAR,
	personmailinggeocodeaccuracy                         VARCHAR,
	personmailinglatitude                                DOUBLE PRECISION,
	personmailinglongitude                               DOUBLE PRECISION,
	personmailingpostalcode                              VARCHAR,
	personmailingstate                                   VARCHAR,
	personmailingstatecode                               VARCHAR,
	personmailingstreet                                  VARCHAR,
	personmobilephone                                    VARCHAR,
	personothercity                                      VARCHAR,
	personothercountry                                   VARCHAR,
	personothercountrycode                               VARCHAR,
	personothergeocodeaccuracy                           VARCHAR,
	personotherlatitude                                  DOUBLE PRECISION,
	personotherlongitude                                 DOUBLE PRECISION,
	personotherphone                                     VARCHAR,
	personotherpostalcode                                VARCHAR,
	personotherstate                                     VARCHAR,
	personotherstatecode                                 VARCHAR,
	personotherstreet                                    VARCHAR,
	persontitle                                          VARCHAR,
	phone                                                VARCHAR,
	photourl                                             VARCHAR,
	posu_cluster__c                                      VARCHAR,
	postandcommentprocessed__c                           BOOLEAN,
	pre_qualification_status__c                          VARCHAR,
	pre_qualification_dach__c                            VARCHAR,
	pre_qualification_row__c                             VARCHAR,
	pre_qualification_uk__c                              VARCHAR,
	previous_account_name__c                             VARCHAR,
	price_check_url__c                                   VARCHAR,
	primary__pc                                          BOOLEAN,
	primary_contact__c                                   VARCHAR,
	primary_contact_email__c                             VARCHAR,
	primary_contact_job_title__c                         VARCHAR,
	primary_contact_phone__c                             VARCHAR,
	primary_contact_to_confirm_preview_link__c           VARCHAR,
	printtransactions_netsuite__c                        BOOLEAN,
	property_id__c                                       VARCHAR,
	public_liability_insurance__c                        BOOLEAN,
	public_liability_insurance_confirmed__c              BOOLEAN,
	public_liability_insurance_expiry__c                 DATE,
	qc_account_name__c                                   DOUBLE PRECISION,
	qc_contact_email__c                                  DOUBLE PRECISION,
	qc_contact_job_role__c                               DOUBLE PRECISION,
	qc_contact_name__c                                   DOUBLE PRECISION,
	qc_contact_phone__c                                  DOUBLE PRECISION,
	qc_destination__c                                    DOUBLE PRECISION,
	qc_rating_t_a__c                                     DOUBLE PRECISION,
	qc_region__c                                         DOUBLE PRECISION,
	qc_rooms__c                                          DOUBLE PRECISION,
	qc_shipping_address__c                               DOUBLE PRECISION,
	qc_star_rating__c                                    DOUBLE PRECISION,
	qc_sub_region__c                                     DOUBLE PRECISION,
	qc_tripadvisor_link__c                               DOUBLE PRECISION,
	qc_tripadvisor_rating__c                             DOUBLE PRECISION,
	qc_website__c                                        DOUBLE PRECISION,
	rate_query_end_date__c                               DATE,
	rate_query_start_date__c                             DATE,
	rating                                               VARCHAR,
	rating_booking_com__c                                VARCHAR,
	rating_ta__c                                         DOUBLE PRECISION,
	reason_for_omission__c                               VARCHAR,
	record_count__c                                      DOUBLE PRECISION,
	recordstocheck__c                                    BOOLEAN,
	recordtypeid                                         VARCHAR,
	recovered_amount__c                                  DOUBLE PRECISION,
	recoveries_next_steps_or_issues__c                   VARCHAR,
	recoveries_owner__c                                  VARCHAR,
	recoveries_payment_method__c                         VARCHAR,
	recoveries_status__c                                 VARCHAR,
	recovery_date__c                                     DATE,
	red_flag__c                                          BOOLEAN,
	red_flag__pc                                         BOOLEAN,
	red_flag_date_time__c                                TIMESTAMP,
	red_flag_reason__c                                   VARCHAR,
	red_flag_tp__c                                       BOOLEAN,
	red_flagged_by__c                                    VARCHAR,
	region__c                                            VARCHAR,
	region_type__c                                       VARCHAR,
	remove_red_flag__c                                   BOOLEAN,
	salutation                                           VARCHAR,
	saq_contact__c                                       VARCHAR,
	saq_created__c                                       BOOLEAN,
	saq_form_link__c                                     VARCHAR,
	saq_management_approval_needed__c                    BOOLEAN,
	saq_passed_date__c                                   DATE,
	saq_sent_date__c                                     DATE,
	saq_signed_date__c                                   DATE,
	saq_status__c                                        VARCHAR,
	shippingcity                                         VARCHAR,
	shippingcountry                                      VARCHAR,
	shippingcountrycode                                  VARCHAR,
	shippinggeocodeaccuracy                              VARCHAR,
	shippinglatitude                                     DOUBLE PRECISION,
	shippinglongitude                                    DOUBLE PRECISION,
	shippingpostalcode                                   VARCHAR,
	shippingstate                                        VARCHAR,
	shippingstatecode                                    VARCHAR,
	shippingstreet                                       VARCHAR,
	sicdesc                                              VARCHAR,
	stage_netsuite__c                                    VARCHAR,
	star_rating__c                                       VARCHAR,
	star_rating__pc                                      VARCHAR,
	sub_affiliate_brand__c                               VARCHAR,
	sub_region__c                                        VARCHAR,
	subsidiaries__c                                      VARCHAR,
	sum_of_margin__c                                     DOUBLE PRECISION,
	sum_of_visits__c                                     DOUBLE PRECISION,
	swift__c                                             VARCHAR,
	swift_in_house_packages__c                           VARCHAR,
	swift_travelist__c                                   VARCHAR,
	swift_validation__c                                  VARCHAR,
	swift_validation_row__c                              VARCHAR,
	swift_value_netsuite__c                              VARCHAR,
	synxis_id__c                                         VARCHAR,
	systemmodstamp                                       TIMESTAMP,
	target_account_list__c                               VARCHAR,
	tax_item__c                                          VARCHAR,
	taxable_netsuite__c                                  BOOLEAN,
	taxexempt_netsuite__c                                BOOLEAN,
	telephone_ins_prov__c                                VARCHAR,
	telephone_sales_commission__c                        DOUBLE PRECISION,
	temp_contact_checkbox__pc                            BOOLEAN,
	third_party_notes__c                                 VARCHAR,
	third_party_opt_in__c                                VARCHAR,
	third_party_payment_notes__c                         VARCHAR,
	third_party_provider__c                              VARCHAR,
	today__c                                             VARCHAR,
	today_number__c                                      DATE,
	today_text__c                                        VARCHAR,
	total_credit_cashed__c                               DOUBLE PRECISION,
	total_member_spend__c                                DOUBLE PRECISION,
	total_reviews_ta__c                                  DOUBLE PRECISION,
	travelbird_id__c                                     VARCHAR,
	travelist_active__c                                  BOOLEAN,
	trimmed_hotel_name_contracts__c                      VARCHAR,
	tripadvisor_link__c                                  VARCHAR,
	tripadvisor_rating__c                                DOUBLE PRECISION,
	trivago_link__c                                      VARCHAR,
	tvl_company_signed_date__c                           DATE,
	tvl_old_contract_version__c                          VARCHAR,
	type                                                 VARCHAR,
	type_ebd__c                                          DOUBLE PRECISION,
	type_of_third_party__c                               VARCHAR,
	uk_contact_status__c                                 VARCHAR,
	uk_opportunity_status__c                             VARCHAR,
	update_customer_ns__c                                BOOLEAN,
	update_vendor_ns__c                                  BOOLEAN,
	user_who_experienced_error__c                        VARCHAR,
	vat_number__c                                        VARCHAR,
	vat_number_id_ns__c                                  VARCHAR,
	vat_number_in_house_packages__c                      VARCHAR,
	vat_number_travelist__c                              VARCHAR,
	vat_number_validation__c                             VARCHAR,
	vat_number_validation_row__c                         VARCHAR,
	vatregnumber_netsuite__c                             VARCHAR,
	vcc_netsuite__c                                      DOUBLE PRECISION,
	vendor_customer_sync_readiness__c                    VARCHAR,
	vendor_id_netsuite__c                                VARCHAR,
	vendor_insert_ns__c                                  BOOLEAN,
	version_8_contract_approval_way__c                   VARCHAR,
	virtual_credit_card__c                               VARCHAR,
	virtual_credit_card_in_house_packages__c             VARCHAR,
	virtual_credit_card_ns_id__c                         VARCHAR,
	voucher_opt_in__c                                    VARCHAR,
	web_phone__pc                                        VARCHAR,
	website                                              VARCHAR,
	website_sales_commission__c                          DOUBLE PRECISION,
	weekly_opt_in__c                                     VARCHAR,
	wheelchair_accessible__c                             VARCHAR,
	zero_deposit__c                                      BOOLEAN,
	zoho_account_id__c                                   VARCHAR,
	zoho_contact_id__pc                                  VARCHAR,

	-- validation columns
	failed_some_validation                               INT,
	fails_validation__id__expected_nonnull               INT,
	fails_validation__lastmodifieddate__expected_nonnull INT
)
;

INSERT INTO hygiene_vault_dev_robin.sfsc.account_m_z (schedule_tstamp,
													  run_tstamp,
													  operation_id,
													  created_at,
													  updated_at,
													  row_dataset_name,
													  row_dataset_source,
													  row_loaded_at,
													  row_schedule_tstamp,
													  row_run_tstamp,
													  row_filename,
													  row_file_row_number,
													  row_extract_metadata,
													  id,
													  lastmodifieddate,
													  manual__c,
													  marketing_addendum__c,
													  marketing_id__c,
													  master_contract_field_updated_by__c,
													  master_contract_signed__c,
													  master_contract_signed_group__c,
													  master_contract_wf__c,
													  master_group_field_updated_by__c,
													  masteraccount__c,
													  masteraccountid__c,
													  masterrecordid,
													  media_contact_territory__pc,
													  most_recent_addendum_request__c,
													  most_recent_addendum_status__c,
													  most_recent_booking__c,
													  most_recent_chain_addendum_status__c,
													  most_recent_close_date__c,
													  most_recent_commission__c,
													  most_recent_contract_effective_date__c,
													  most_recent_contract_effective_date_ro__c,
													  most_recent_contract_effective_date_uk__c,
													  most_recent_cw_close_date__c,
													  most_recent_deal_end_date__c,
													  most_recent_finance_edit_datetime__c,
													  most_recent_group_chain_addendum_request__c,
													  most_recent_ihp_addendum_request__c,
													  most_recent_ihp_addendum_status__c,
													  most_recent_ihp_contract_signed_date__c,
													  most_recent_margin__c,
													  most_recent_master_contract_signed_date__c,
													  most_recent_opp__c,
													  most_recent_package_destination__c,
													  most_recent_pd_proposed_start_date__c,
													  most_recent_proposed_start_date__c,
													  most_recent_proposed_start_date__pc,
													  most_recent_sale_id__c,
													  most_recent_successful_deal__c,
													  most_recent_successful_sync__c,
													  most_recent_sync_datetime__c,
													  most_recent_sync_outcome__c,
													  most_recent_ta_check__c,
													  name,
													  nearest_airport_code__c,
													  need_periods__c,
													  new_business_challenge__c,
													  next_proposed_start_date__c,
													  no_gdpr_clause_signed_approved_by_sd__c,
													  notes__pc,
													  notes_on_working_with_se__c,
													  ns_category__c,
													  ns_category_customer__c,
													  ns_contract_type__c,
													  ns_update_bank_details__c,
													  nscrm__balance__c,
													  nscrm__credit_hold__c,
													  nscrm__credit_limit__c,
													  nscrm__days_overdue__c,
													  nscrm__ns_credit_term_id__c,
													  nscrm__ns_customer_category_id__c,
													  nscrm__ns_internal_id__c,
													  nscrm__ns_internal_id__pc,
													  nscrm__ns_sales_rep_id__c,
													  nscrm__ns_shipping_item_id__c,
													  nscrm__ns_subsidiary_id__c,
													  nscrm__ns_tax_item_id__c,
													  nscrm__overdue_balance__c,
													  nscrm__subsidiary__c,
													  nscrm__taxable__c,
													  number_of_active_addendums__c,
													  number_of_addendums__c,
													  number_of_bookings__c,
													  number_of_floors__c,
													  number_of_opps__c,
													  number_of_personal_injuries__c,
													  number_of_rooms__c,
													  numberofemployees,
													  open_opps__pc,
													  opportunity_listing_fee__c,
													  opportunity_to_pull_offers_from__c,
													  opted_in_for_always_on__c,
													  opted_in_for_refundable_deals__c,
													  opted_in_for_suvc__c,
													  original_contractor__c,
													  overduebalance_netsuite__c,
													  ownerid,
													  package_bank_country_selection__c,
													  parent_customer_ns_id__c,
													  parent_ns_id__c,
													  parent_vendor_ns_id__c,
													  parentid,
													  partner_membership__c,
													  partner_product__c,
													  partner_region__c,
													  partner_stage__c,
													  payment_ns_id__c,
													  payment_process__c,
													  payment_process_ns_id__c,
													  payment_terms_contracts__c,
													  payment_terms_days__c,
													  payment_terms_days_in_house_packages__c,
													  payment_terms_days_ns_id__c,
													  person_account_email_address__c,
													  person_account_status__c,
													  person_account_subscription_staatus__c,
													  person_account_territory__c,
													  person_address_city__c,
													  person_address_country__c,
													  person_address_line_1__c,
													  person_address_line_2__c,
													  person_address_post_code__c,
													  person_referred_by__c,
													  personassistantname,
													  personassistantphone,
													  personbirthdate,
													  personcontactid,
													  persondepartment,
													  personemail,
													  personemailbounceddate,
													  personemailbouncedreason,
													  personhasoptedoutofemail,
													  personhomephone,
													  personlastcurequestdate,
													  personlastcuupdatedate,
													  personleadsource,
													  personmailingcity,
													  personmailingcountry,
													  personmailingcountrycode,
													  personmailinggeocodeaccuracy,
													  personmailinglatitude,
													  personmailinglongitude,
													  personmailingpostalcode,
													  personmailingstate,
													  personmailingstatecode,
													  personmailingstreet,
													  personmobilephone,
													  personothercity,
													  personothercountry,
													  personothercountrycode,
													  personothergeocodeaccuracy,
													  personotherlatitude,
													  personotherlongitude,
													  personotherphone,
													  personotherpostalcode,
													  personotherstate,
													  personotherstatecode,
													  personotherstreet,
													  persontitle,
													  phone,
													  photourl,
													  posu_cluster__c,
													  postandcommentprocessed__c,
													  pre_qualification_status__c,
													  pre_qualification_dach__c,
													  pre_qualification_row__c,
													  pre_qualification_uk__c,
													  previous_account_name__c,
													  price_check_url__c,
													  primary__pc,
													  primary_contact__c,
													  primary_contact_email__c,
													  primary_contact_job_title__c,
													  primary_contact_phone__c,
													  primary_contact_to_confirm_preview_link__c,
													  printtransactions_netsuite__c,
													  property_id__c,
													  public_liability_insurance__c,
													  public_liability_insurance_confirmed__c,
													  public_liability_insurance_expiry__c,
													  qc_account_name__c,
													  qc_contact_email__c,
													  qc_contact_job_role__c,
													  qc_contact_name__c,
													  qc_contact_phone__c,
													  qc_destination__c,
													  qc_rating_t_a__c,
													  qc_region__c,
													  qc_rooms__c,
													  qc_shipping_address__c,
													  qc_star_rating__c,
													  qc_sub_region__c,
													  qc_tripadvisor_link__c,
													  qc_tripadvisor_rating__c,
													  qc_website__c,
													  rate_query_end_date__c,
													  rate_query_start_date__c,
													  rating,
													  rating_booking_com__c,
													  rating_ta__c,
													  reason_for_omission__c,
													  record_count__c,
													  recordstocheck__c,
													  recordtypeid,
													  recovered_amount__c,
													  recoveries_next_steps_or_issues__c,
													  recoveries_owner__c,
													  recoveries_payment_method__c,
													  recoveries_status__c,
													  recovery_date__c,
													  red_flag__c,
													  red_flag__pc,
													  red_flag_date_time__c,
													  red_flag_reason__c,
													  red_flag_tp__c,
													  red_flagged_by__c,
													  region__c,
													  region_type__c,
													  remove_red_flag__c,
													  salutation,
													  saq_contact__c,
													  saq_created__c,
													  saq_form_link__c,
													  saq_management_approval_needed__c,
													  saq_passed_date__c,
													  saq_sent_date__c,
													  saq_signed_date__c,
													  saq_status__c,
													  shippingcity,
													  shippingcountry,
													  shippingcountrycode,
													  shippinggeocodeaccuracy,
													  shippinglatitude,
													  shippinglongitude,
													  shippingpostalcode,
													  shippingstate,
													  shippingstatecode,
													  shippingstreet,
													  sicdesc,
													  stage_netsuite__c,
													  star_rating__c,
													  star_rating__pc,
													  sub_affiliate_brand__c,
													  sub_region__c,
													  subsidiaries__c,
													  sum_of_margin__c,
													  sum_of_visits__c,
													  swift__c,
													  swift_in_house_packages__c,
													  swift_travelist__c,
													  swift_validation__c,
													  swift_validation_row__c,
													  swift_value_netsuite__c,
													  synxis_id__c,
													  systemmodstamp,
													  target_account_list__c,
													  tax_item__c,
													  taxable_netsuite__c,
													  taxexempt_netsuite__c,
													  telephone_ins_prov__c,
													  telephone_sales_commission__c,
													  temp_contact_checkbox__pc,
													  third_party_notes__c,
													  third_party_opt_in__c,
													  third_party_payment_notes__c,
													  third_party_provider__c,
													  today__c,
													  today_number__c,
													  today_text__c,
													  total_credit_cashed__c,
													  total_member_spend__c,
													  total_reviews_ta__c,
													  travelbird_id__c,
													  travelist_active__c,
													  trimmed_hotel_name_contracts__c,
													  tripadvisor_link__c,
													  tripadvisor_rating__c,
													  trivago_link__c,
													  tvl_company_signed_date__c,
													  tvl_old_contract_version__c,
													  type,
													  type_ebd__c,
													  type_of_third_party__c,
													  uk_contact_status__c,
													  uk_opportunity_status__c,
													  update_customer_ns__c,
													  update_vendor_ns__c,
													  user_who_experienced_error__c,
													  vat_number__c,
													  vat_number_id_ns__c,
													  vat_number_in_house_packages__c,
													  vat_number_travelist__c,
													  vat_number_validation__c,
													  vat_number_validation_row__c,
													  vatregnumber_netsuite__c,
													  vcc_netsuite__c,
													  vendor_customer_sync_readiness__c,
													  vendor_id_netsuite__c,
													  vendor_insert_ns__c,
													  version_8_contract_approval_way__c,
													  virtual_credit_card__c,
													  virtual_credit_card_in_house_packages__c,
													  virtual_credit_card_ns_id__c,
													  voucher_opt_in__c,
													  web_phone__pc,
													  website,
													  website_sales_commission__c,
													  weekly_opt_in__c,
													  wheelchair_accessible__c,
													  zero_deposit__c,
													  zoho_account_id__c,
													  zoho_contact_id__pc,
													  failed_some_validation,
													  fails_validation__id__expected_nonnull,
													  fails_validation__lastmodifieddate__expected_nonnull)
SELECT
	schedule_tstamp,
	run_tstamp,
	operation_id,
	created_at,
	updated_at,
	row_dataset_name,
	row_dataset_source,
	row_loaded_at,
	row_schedule_tstamp,
	row_run_tstamp,
	row_filename,
	row_file_row_number,
	row_extract_metadata,
	id,
	lastmodifieddate,
	manual__c,
	marketing_addendum__c,
	marketing_id__c,
	master_contract_field_updated_by__c,
	master_contract_signed__c,
	master_contract_signed_group__c,
	master_contract_wf__c,
	master_group_field_updated_by__c,
	masteraccount__c,
	masteraccountid__c,
	masterrecordid,
	media_contact_territory__pc,
	most_recent_addendum_request__c,
	most_recent_addendum_status__c,
	most_recent_booking__c,
	most_recent_chain_addendum_status__c,
	most_recent_close_date__c,
	most_recent_commission__c,
	most_recent_contract_effective_date__c,
	most_recent_contract_effective_date_ro__c,
	most_recent_contract_effective_date_uk__c,
	most_recent_cw_close_date__c,
	most_recent_deal_end_date__c,
	most_recent_finance_edit_datetime__c,
	most_recent_group_chain_addendum_request__c,
	most_recent_ihp_addendum_request__c,
	most_recent_ihp_addendum_status__c,
	most_recent_ihp_contract_signed_date__c,
	most_recent_margin__c,
	most_recent_master_contract_signed_date__c,
	most_recent_opp__c,
	most_recent_package_destination__c,
	most_recent_pd_proposed_start_date__c,
	most_recent_proposed_start_date__c,
	most_recent_proposed_start_date__pc,
	most_recent_sale_id__c,
	most_recent_successful_deal__c,
	most_recent_successful_sync__c,
	most_recent_sync_datetime__c,
	most_recent_sync_outcome__c,
	most_recent_ta_check__c,
	name,
	nearest_airport_code__c,
	need_periods__c,
	new_business_challenge__c,
	next_proposed_start_date__c,
	no_gdpr_clause_signed_approved_by_sd__c,
	notes__pc,
	notes_on_working_with_se__c,
	ns_category__c,
	ns_category_customer__c,
	ns_contract_type__c,
	ns_update_bank_details__c,
	nscrm__balance__c,
	nscrm__credit_hold__c,
	nscrm__credit_limit__c,
	nscrm__days_overdue__c,
	nscrm__ns_credit_term_id__c,
	nscrm__ns_customer_category_id__c,
	nscrm__ns_internal_id__c,
	nscrm__ns_internal_id__pc,
	nscrm__ns_sales_rep_id__c,
	nscrm__ns_shipping_item_id__c,
	nscrm__ns_subsidiary_id__c,
	nscrm__ns_tax_item_id__c,
	nscrm__overdue_balance__c,
	nscrm__subsidiary__c,
	nscrm__taxable__c,
	number_of_active_addendums__c,
	number_of_addendums__c,
	number_of_bookings__c,
	number_of_floors__c,
	number_of_opps__c,
	number_of_personal_injuries__c,
	number_of_rooms__c,
	numberofemployees,
	open_opps__pc,
	opportunity_listing_fee__c,
	opportunity_to_pull_offers_from__c,
	opted_in_for_always_on__c,
	opted_in_for_refundable_deals__c,
	opted_in_for_suvc__c,
	original_contractor__c,
	overduebalance_netsuite__c,
	ownerid,
	package_bank_country_selection__c,
	parent_customer_ns_id__c,
	parent_ns_id__c,
	parent_vendor_ns_id__c,
	parentid,
	partner_membership__c,
	partner_product__c,
	partner_region__c,
	partner_stage__c,
	payment_ns_id__c,
	payment_process__c,
	payment_process_ns_id__c,
	payment_terms_contracts__c,
	payment_terms_days__c,
	payment_terms_days_in_house_packages__c,
	payment_terms_days_ns_id__c,
	person_account_email_address__c,
	person_account_status__c,
	person_account_subscription_staatus__c,
	person_account_territory__c,
	person_address_city__c,
	person_address_country__c,
	person_address_line_1__c,
	person_address_line_2__c,
	person_address_post_code__c,
	person_referred_by__c,
	personassistantname,
	personassistantphone,
	personbirthdate,
	personcontactid,
	persondepartment,
	personemail,
	personemailbounceddate,
	personemailbouncedreason,
	personhasoptedoutofemail,
	personhomephone,
	personlastcurequestdate,
	personlastcuupdatedate,
	personleadsource,
	personmailingcity,
	personmailingcountry,
	personmailingcountrycode,
	personmailinggeocodeaccuracy,
	personmailinglatitude,
	personmailinglongitude,
	personmailingpostalcode,
	personmailingstate,
	personmailingstatecode,
	personmailingstreet,
	personmobilephone,
	personothercity,
	personothercountry,
	personothercountrycode,
	personothergeocodeaccuracy,
	personotherlatitude,
	personotherlongitude,
	personotherphone,
	personotherpostalcode,
	personotherstate,
	personotherstatecode,
	personotherstreet,
	persontitle,
	phone,
	photourl,
	posu_cluster__c,
	postandcommentprocessed__c,
	pre_qualification_status__c,
	NULL,
	NULL,
	NULL,
	previous_account_name__c,
	price_check_url__c,
	primary__pc,
	primary_contact__c,
	primary_contact_email__c,
	primary_contact_job_title__c,
	primary_contact_phone__c,
	primary_contact_to_confirm_preview_link__c,
	printtransactions_netsuite__c,
	property_id__c,
	public_liability_insurance__c,
	public_liability_insurance_confirmed__c,
	public_liability_insurance_expiry__c,
	qc_account_name__c,
	qc_contact_email__c,
	qc_contact_job_role__c,
	qc_contact_name__c,
	qc_contact_phone__c,
	qc_destination__c,
	qc_rating_t_a__c,
	qc_region__c,
	qc_rooms__c,
	qc_shipping_address__c,
	qc_star_rating__c,
	qc_sub_region__c,
	qc_tripadvisor_link__c,
	qc_tripadvisor_rating__c,
	qc_website__c,
	rate_query_end_date__c,
	rate_query_start_date__c,
	rating,
	rating_booking_com__c,
	rating_ta__c,
	reason_for_omission__c,
	record_count__c,
	recordstocheck__c,
	recordtypeid,
	recovered_amount__c,
	recoveries_next_steps_or_issues__c,
	recoveries_owner__c,
	recoveries_payment_method__c,
	recoveries_status__c,
	recovery_date__c,
	red_flag__c,
	red_flag__pc,
	red_flag_date_time__c,
	red_flag_reason__c,
	red_flag_tp__c,
	red_flagged_by__c,
	region__c,
	region_type__c,
	remove_red_flag__c,
	salutation,
	saq_contact__c,
	saq_created__c,
	saq_form_link__c,
	saq_management_approval_needed__c,
	saq_passed_date__c,
	saq_sent_date__c,
	saq_signed_date__c,
	saq_status__c,
	shippingcity,
	shippingcountry,
	shippingcountrycode,
	shippinggeocodeaccuracy,
	shippinglatitude,
	shippinglongitude,
	shippingpostalcode,
	shippingstate,
	shippingstatecode,
	shippingstreet,
	sicdesc,
	stage_netsuite__c,
	star_rating__c,
	star_rating__pc,
	sub_affiliate_brand__c,
	sub_region__c,
	subsidiaries__c,
	sum_of_margin__c,
	sum_of_visits__c,
	swift__c,
	swift_in_house_packages__c,
	swift_travelist__c,
	swift_validation__c,
	swift_validation_row__c,
	swift_value_netsuite__c,
	synxis_id__c,
	systemmodstamp,
	target_account_list__c,
	tax_item__c,
	taxable_netsuite__c,
	taxexempt_netsuite__c,
	telephone_ins_prov__c,
	telephone_sales_commission__c,
	temp_contact_checkbox__pc,
	third_party_notes__c,
	third_party_opt_in__c,
	third_party_payment_notes__c,
	third_party_provider__c,
	today__c,
	today_number__c,
	today_text__c,
	total_credit_cashed__c,
	total_member_spend__c,
	total_reviews_ta__c,
	travelbird_id__c,
	travelist_active__c,
	trimmed_hotel_name_contracts__c,
	tripadvisor_link__c,
	tripadvisor_rating__c,
	trivago_link__c,
	tvl_company_signed_date__c,
	tvl_old_contract_version__c,
	type,
	type_ebd__c,
	type_of_third_party__c,
	uk_contact_status__c,
	uk_opportunity_status__c,
	update_customer_ns__c,
	update_vendor_ns__c,
	user_who_experienced_error__c,
	vat_number__c,
	vat_number_id_ns__c,
	vat_number_in_house_packages__c,
	vat_number_travelist__c,
	vat_number_validation__c,
	vat_number_validation_row__c,
	vatregnumber_netsuite__c,
	vcc_netsuite__c,
	vendor_customer_sync_readiness__c,
	vendor_id_netsuite__c,
	vendor_insert_ns__c,
	version_8_contract_approval_way__c,
	virtual_credit_card__c,
	virtual_credit_card_in_house_packages__c,
	virtual_credit_card_ns_id__c,
	voucher_opt_in__c,
	web_phone__pc,
	website,
	website_sales_commission__c,
	weekly_opt_in__c,
	wheelchair_accessible__c,
	zero_deposit__c,
	zoho_account_id__c,
	zoho_contact_id__pc,
	failed_some_validation,
	fails_validation__id__expected_nonnull,
	fails_validation__lastmodifieddate__expected_nonnull

FROM hygiene_vault_dev_robin.sfsc.account_m_z_20250918
;

-- 	qc sub region
-- sub region

SELECT GET_DDL('table', 'hygiene_vault_dev_robin.sfsc.account_m_z_20250918')
;

------------------------------------------------------------------------------------------------------------------------
-- latest vault

CREATE OR REPLACE TRANSIENT TABLE latest_vault_dev_robin.sfsc.account_m_z_20250919 CLONE latest_vault_dev_robin.sfsc.account_m_z
;

CREATE OR REPLACE TABLE latest_vault_dev_robin.sfsc.account_m_z
(
	-- (lineage) metadata for the current job
	schedule_tstamp                             TIMESTAMP NOT NULL,
	run_tstamp                                  TIMESTAMP NOT NULL,
	operation_id                                VARCHAR   NOT NULL,
	created_at                                  TIMESTAMP NOT NULL,
	updated_at                                  TIMESTAMP NOT NULL,

	-- (lineage) original metadata of row itself
	row_dataset_name                            VARCHAR   NOT NULL,
	row_dataset_source                          VARCHAR   NOT NULL,
	row_loaded_at                               TIMESTAMP NOT NULL,
	row_schedule_tstamp                         TIMESTAMP NOT NULL,
	row_run_tstamp                              TIMESTAMP NOT NULL,
	row_filename                                VARCHAR   NOT NULL,
	row_file_row_number                         INT       NOT NULL,
	row_extract_metadata                        VARIANT,

	-- transformed columns


	-- original columns
	id                                          VARCHAR,
	lastmodifieddate                            TIMESTAMP,
	manual__c                                   BOOLEAN,
	marketing_addendum__c                       BOOLEAN,
	marketing_id__c                             VARCHAR,
	master_contract_field_updated_by__c         VARCHAR,
	master_contract_signed__c                   BOOLEAN,
	master_contract_signed_group__c             BOOLEAN,
	master_contract_wf__c                       BOOLEAN,
	master_group_field_updated_by__c            VARCHAR,
	masteraccount__c                            VARCHAR,
	masteraccountid__c                          VARCHAR,
	masterrecordid                              VARCHAR,
	media_contact_territory__pc                 VARCHAR,
	most_recent_addendum_request__c             VARCHAR,
	most_recent_addendum_status__c              VARCHAR,
	most_recent_booking__c                      TIMESTAMP,
	most_recent_chain_addendum_status__c        VARCHAR,
	most_recent_close_date__c                   DATE,
	most_recent_commission__c                   DOUBLE PRECISION,
	most_recent_contract_effective_date__c      DATE,
	most_recent_contract_effective_date_ro__c   VARCHAR,
	most_recent_contract_effective_date_uk__c   VARCHAR,
	most_recent_cw_close_date__c                DATE,
	most_recent_deal_end_date__c                DATE,
	most_recent_finance_edit_datetime__c        TIMESTAMP,
	most_recent_group_chain_addendum_request__c VARCHAR,
	most_recent_ihp_addendum_request__c         VARCHAR,
	most_recent_ihp_addendum_status__c          VARCHAR,
	most_recent_ihp_contract_signed_date__c     DATE,
	most_recent_margin__c                       DOUBLE PRECISION,
	most_recent_master_contract_signed_date__c  DATE,
	most_recent_opp__c                          VARCHAR,
	most_recent_package_destination__c          VARCHAR,
	most_recent_pd_proposed_start_date__c       DATE,
	most_recent_proposed_start_date__c          DATE,
	most_recent_proposed_start_date__pc         DATE,
	most_recent_sale_id__c                      VARCHAR,
	most_recent_successful_deal__c              DATE,
	most_recent_successful_sync__c              TIMESTAMP,
	most_recent_sync_datetime__c                TIMESTAMP,
	most_recent_sync_outcome__c                 VARCHAR,
	most_recent_ta_check__c                     DATE,
	name                                        VARCHAR,
	nearest_airport_code__c                     VARCHAR,
	need_periods__c                             VARCHAR,
	new_business_challenge__c                   BOOLEAN,
	next_proposed_start_date__c                 DATE,
	no_gdpr_clause_signed_approved_by_sd__c     BOOLEAN,
	notes__pc                                   VARCHAR,
	notes_on_working_with_se__c                 VARCHAR,
	ns_category__c                              VARCHAR,
	ns_category_customer__c                     VARCHAR,
	ns_contract_type__c                         VARCHAR,
	ns_update_bank_details__c                   BOOLEAN,
	nscrm__balance__c                           DOUBLE PRECISION,
	nscrm__credit_hold__c                       BOOLEAN,
	nscrm__credit_limit__c                      DOUBLE PRECISION,
	nscrm__days_overdue__c                      DOUBLE PRECISION,
	nscrm__ns_credit_term_id__c                 VARCHAR,
	nscrm__ns_customer_category_id__c           VARCHAR,
	nscrm__ns_internal_id__c                    VARCHAR,
	nscrm__ns_internal_id__pc                   VARCHAR,
	nscrm__ns_sales_rep_id__c                   VARCHAR,
	nscrm__ns_shipping_item_id__c               VARCHAR,
	nscrm__ns_subsidiary_id__c                  VARCHAR,
	nscrm__ns_tax_item_id__c                    VARCHAR,
	nscrm__overdue_balance__c                   DOUBLE PRECISION,
	nscrm__subsidiary__c                        VARCHAR,
	nscrm__taxable__c                           BOOLEAN,
	number_of_active_addendums__c               DOUBLE PRECISION,
	number_of_addendums__c                      DOUBLE PRECISION,
	number_of_bookings__c                       DOUBLE PRECISION,
	number_of_floors__c                         DOUBLE PRECISION,
	number_of_opps__c                           DOUBLE PRECISION,
	number_of_personal_injuries__c              DOUBLE PRECISION,
	number_of_rooms__c                          DOUBLE PRECISION,
	numberofemployees                           INT,
	open_opps__pc                               DOUBLE PRECISION,
	opportunity_listing_fee__c                  DOUBLE PRECISION,
	opportunity_to_pull_offers_from__c          VARCHAR,
	opted_in_for_always_on__c                   VARCHAR,
	opted_in_for_refundable_deals__c            VARCHAR,
	opted_in_for_suvc__c                        VARCHAR,
	original_contractor__c                      VARCHAR,
	overduebalance_netsuite__c                  DOUBLE PRECISION,
	ownerid                                     VARCHAR,
	package_bank_country_selection__c           VARCHAR,
	parent_customer_ns_id__c                    VARCHAR,
	parent_ns_id__c                             VARCHAR,
	parent_vendor_ns_id__c                      VARCHAR,
	parentid                                    VARCHAR,
	partner_membership__c                       VARCHAR,
	partner_product__c                          VARCHAR,
	partner_region__c                           VARCHAR,
	partner_stage__c                            VARCHAR,
	payment_ns_id__c                            VARCHAR,
	payment_process__c                          VARCHAR,
	payment_process_ns_id__c                    VARCHAR,
	payment_terms_contracts__c                  VARCHAR,
	payment_terms_days__c                       VARCHAR,
	payment_terms_days_in_house_packages__c     VARCHAR,
	payment_terms_days_ns_id__c                 VARCHAR,
	person_account_email_address__c             VARCHAR,
	person_account_status__c                    VARCHAR,
	person_account_subscription_staatus__c      VARCHAR,
	person_account_territory__c                 VARCHAR,
	person_address_city__c                      VARCHAR,
	person_address_country__c                   VARCHAR,
	person_address_line_1__c                    VARCHAR,
	person_address_line_2__c                    VARCHAR,
	person_address_post_code__c                 VARCHAR,
	person_referred_by__c                       VARCHAR,
	personassistantname                         VARCHAR,
	personassistantphone                        VARCHAR,
	personbirthdate                             DATE,
	personcontactid                             VARCHAR,
	persondepartment                            VARCHAR,
	personemail                                 VARCHAR,
	personemailbounceddate                      TIMESTAMP,
	personemailbouncedreason                    VARCHAR,
	personhasoptedoutofemail                    BOOLEAN,
	personhomephone                             VARCHAR,
	personlastcurequestdate                     TIMESTAMP,
	personlastcuupdatedate                      TIMESTAMP,
	personleadsource                            VARCHAR,
	personmailingcity                           VARCHAR,
	personmailingcountry                        VARCHAR,
	personmailingcountrycode                    VARCHAR,
	personmailinggeocodeaccuracy                VARCHAR,
	personmailinglatitude                       DOUBLE PRECISION,
	personmailinglongitude                      DOUBLE PRECISION,
	personmailingpostalcode                     VARCHAR,
	personmailingstate                          VARCHAR,
	personmailingstatecode                      VARCHAR,
	personmailingstreet                         VARCHAR,
	personmobilephone                           VARCHAR,
	personothercity                             VARCHAR,
	personothercountry                          VARCHAR,
	personothercountrycode                      VARCHAR,
	personothergeocodeaccuracy                  VARCHAR,
	personotherlatitude                         DOUBLE PRECISION,
	personotherlongitude                        DOUBLE PRECISION,
	personotherphone                            VARCHAR,
	personotherpostalcode                       VARCHAR,
	personotherstate                            VARCHAR,
	personotherstatecode                        VARCHAR,
	personotherstreet                           VARCHAR,
	persontitle                                 VARCHAR,
	phone                                       VARCHAR,
	photourl                                    VARCHAR,
	posu_cluster__c                             VARCHAR,
	postandcommentprocessed__c                  BOOLEAN,
	pre_qualification_status__c                 VARCHAR,
	pre_qualification_dach__c                   VARCHAR,
	pre_qualification_row__c                    VARCHAR,
	pre_qualification_uk__c                     VARCHAR,
	previous_account_name__c                    VARCHAR,
	price_check_url__c                          VARCHAR,
	primary__pc                                 BOOLEAN,
	primary_contact__c                          VARCHAR,
	primary_contact_email__c                    VARCHAR,
	primary_contact_job_title__c                VARCHAR,
	primary_contact_phone__c                    VARCHAR,
	primary_contact_to_confirm_preview_link__c  VARCHAR,
	printtransactions_netsuite__c               BOOLEAN,
	property_id__c                              VARCHAR,
	public_liability_insurance__c               BOOLEAN,
	public_liability_insurance_confirmed__c     BOOLEAN,
	public_liability_insurance_expiry__c        DATE,
	qc_account_name__c                          DOUBLE PRECISION,
	qc_contact_email__c                         DOUBLE PRECISION,
	qc_contact_job_role__c                      DOUBLE PRECISION,
	qc_contact_name__c                          DOUBLE PRECISION,
	qc_contact_phone__c                         DOUBLE PRECISION,
	qc_destination__c                           DOUBLE PRECISION,
	qc_rating_t_a__c                            DOUBLE PRECISION,
	qc_region__c                                DOUBLE PRECISION,
	qc_rooms__c                                 DOUBLE PRECISION,
	qc_shipping_address__c                      DOUBLE PRECISION,
	qc_star_rating__c                           DOUBLE PRECISION,
	qc_sub_region__c                            DOUBLE PRECISION,
	qc_tripadvisor_link__c                      DOUBLE PRECISION,
	qc_tripadvisor_rating__c                    DOUBLE PRECISION,
	qc_website__c                               DOUBLE PRECISION,
	rate_query_end_date__c                      DATE,
	rate_query_start_date__c                    DATE,
	rating                                      VARCHAR,
	rating_booking_com__c                       VARCHAR,
	rating_ta__c                                DOUBLE PRECISION,
	reason_for_omission__c                      VARCHAR,
	record_count__c                             DOUBLE PRECISION,
	recordstocheck__c                           BOOLEAN,
	recordtypeid                                VARCHAR,
	recovered_amount__c                         DOUBLE PRECISION,
	recoveries_next_steps_or_issues__c          VARCHAR,
	recoveries_owner__c                         VARCHAR,
	recoveries_payment_method__c                VARCHAR,
	recoveries_status__c                        VARCHAR,
	recovery_date__c                            DATE,
	red_flag__c                                 BOOLEAN,
	red_flag__pc                                BOOLEAN,
	red_flag_date_time__c                       TIMESTAMP,
	red_flag_reason__c                          VARCHAR,
	red_flag_tp__c                              BOOLEAN,
	red_flagged_by__c                           VARCHAR,
	region__c                                   VARCHAR,
	region_type__c                              VARCHAR,
	remove_red_flag__c                          BOOLEAN,
	salutation                                  VARCHAR,
	saq_contact__c                              VARCHAR,
	saq_created__c                              BOOLEAN,
	saq_form_link__c                            VARCHAR,
	saq_management_approval_needed__c           BOOLEAN,
	saq_passed_date__c                          DATE,
	saq_sent_date__c                            DATE,
	saq_signed_date__c                          DATE,
	saq_status__c                               VARCHAR,
	shippingcity                                VARCHAR,
	shippingcountry                             VARCHAR,
	shippingcountrycode                         VARCHAR,
	shippinggeocodeaccuracy                     VARCHAR,
	shippinglatitude                            DOUBLE PRECISION,
	shippinglongitude                           DOUBLE PRECISION,
	shippingpostalcode                          VARCHAR,
	shippingstate                               VARCHAR,
	shippingstatecode                           VARCHAR,
	shippingstreet                              VARCHAR,
	sicdesc                                     VARCHAR,
	stage_netsuite__c                           VARCHAR,
	star_rating__c                              VARCHAR,
	star_rating__pc                             VARCHAR,
	sub_affiliate_brand__c                      VARCHAR,
	sub_region__c                               VARCHAR,
	subsidiaries__c                             VARCHAR,
	sum_of_margin__c                            DOUBLE PRECISION,
	sum_of_visits__c                            DOUBLE PRECISION,
	swift__c                                    VARCHAR,
	swift_in_house_packages__c                  VARCHAR,
	swift_travelist__c                          VARCHAR,
	swift_validation__c                         VARCHAR,
	swift_validation_row__c                     VARCHAR,
	swift_value_netsuite__c                     VARCHAR,
	synxis_id__c                                VARCHAR,
	systemmodstamp                              TIMESTAMP,
	target_account_list__c                      VARCHAR,
	tax_item__c                                 VARCHAR,
	taxable_netsuite__c                         BOOLEAN,
	taxexempt_netsuite__c                       BOOLEAN,
	telephone_ins_prov__c                       VARCHAR,
	telephone_sales_commission__c               DOUBLE PRECISION,
	temp_contact_checkbox__pc                   BOOLEAN,
	third_party_notes__c                        VARCHAR,
	third_party_opt_in__c                       VARCHAR,
	third_party_payment_notes__c                VARCHAR,
	third_party_provider__c                     VARCHAR,
	today__c                                    VARCHAR,
	today_number__c                             DATE,
	today_text__c                               VARCHAR,
	total_credit_cashed__c                      DOUBLE PRECISION,
	total_member_spend__c                       DOUBLE PRECISION,
	total_reviews_ta__c                         DOUBLE PRECISION,
	travelbird_id__c                            VARCHAR,
	travelist_active__c                         BOOLEAN,
	trimmed_hotel_name_contracts__c             VARCHAR,
	tripadvisor_link__c                         VARCHAR,
	tripadvisor_rating__c                       DOUBLE PRECISION,
	trivago_link__c                             VARCHAR,
	tvl_company_signed_date__c                  DATE,
	tvl_old_contract_version__c                 VARCHAR,
	type                                        VARCHAR,
	type_ebd__c                                 DOUBLE PRECISION,
	type_of_third_party__c                      VARCHAR,
	uk_contact_status__c                        VARCHAR,
	uk_opportunity_status__c                    VARCHAR,
	update_customer_ns__c                       BOOLEAN,
	update_vendor_ns__c                         BOOLEAN,
	user_who_experienced_error__c               VARCHAR,
	vat_number__c                               VARCHAR,
	vat_number_id_ns__c                         VARCHAR,
	vat_number_in_house_packages__c             VARCHAR,
	vat_number_travelist__c                     VARCHAR,
	vat_number_validation__c                    VARCHAR,
	vat_number_validation_row__c                VARCHAR,
	vatregnumber_netsuite__c                    VARCHAR,
	vcc_netsuite__c                             DOUBLE PRECISION,
	vendor_customer_sync_readiness__c           VARCHAR,
	vendor_id_netsuite__c                       VARCHAR,
	vendor_insert_ns__c                         BOOLEAN,
	version_8_contract_approval_way__c          VARCHAR,
	virtual_credit_card__c                      VARCHAR,
	virtual_credit_card_in_house_packages__c    VARCHAR,
	virtual_credit_card_ns_id__c                VARCHAR,
	voucher_opt_in__c                           VARCHAR,
	web_phone__pc                               VARCHAR,
	website                                     VARCHAR,
	website_sales_commission__c                 DOUBLE PRECISION,
	weekly_opt_in__c                            VARCHAR,
	wheelchair_accessible__c                    VARCHAR,
	zero_deposit__c                             BOOLEAN,
	zoho_account_id__c                          VARCHAR,
	zoho_contact_id__pc                         VARCHAR,
	CONSTRAINT pk_1 PRIMARY KEY (id)
)
;

INSERT INTO latest_vault_dev_robin.sfsc.account_m_z (schedule_tstamp,
													 run_tstamp,
													 operation_id,
													 created_at,
													 updated_at,
													 row_dataset_name,
													 row_dataset_source,
													 row_loaded_at,
													 row_schedule_tstamp,
													 row_run_tstamp,
													 row_filename,
													 row_file_row_number,
													 row_extract_metadata,
													 id,
													 lastmodifieddate,
													 manual__c,
													 marketing_addendum__c,
													 marketing_id__c,
													 master_contract_field_updated_by__c,
													 master_contract_signed__c,
													 master_contract_signed_group__c,
													 master_contract_wf__c,
													 master_group_field_updated_by__c,
													 masteraccount__c,
													 masteraccountid__c,
													 masterrecordid,
													 media_contact_territory__pc,
													 most_recent_addendum_request__c,
													 most_recent_addendum_status__c,
													 most_recent_booking__c,
													 most_recent_chain_addendum_status__c,
													 most_recent_close_date__c,
													 most_recent_commission__c,
													 most_recent_contract_effective_date__c,
													 most_recent_contract_effective_date_ro__c,
													 most_recent_contract_effective_date_uk__c,
													 most_recent_cw_close_date__c,
													 most_recent_deal_end_date__c,
													 most_recent_finance_edit_datetime__c,
													 most_recent_group_chain_addendum_request__c,
													 most_recent_ihp_addendum_request__c,
													 most_recent_ihp_addendum_status__c,
													 most_recent_ihp_contract_signed_date__c,
													 most_recent_margin__c,
													 most_recent_master_contract_signed_date__c,
													 most_recent_opp__c,
													 most_recent_package_destination__c,
													 most_recent_pd_proposed_start_date__c,
													 most_recent_proposed_start_date__c,
													 most_recent_proposed_start_date__pc,
													 most_recent_sale_id__c,
													 most_recent_successful_deal__c,
													 most_recent_successful_sync__c,
													 most_recent_sync_datetime__c,
													 most_recent_sync_outcome__c,
													 most_recent_ta_check__c,
													 name,
													 nearest_airport_code__c,
													 need_periods__c,
													 new_business_challenge__c,
													 next_proposed_start_date__c,
													 no_gdpr_clause_signed_approved_by_sd__c,
													 notes__pc,
													 notes_on_working_with_se__c,
													 ns_category__c,
													 ns_category_customer__c,
													 ns_contract_type__c,
													 ns_update_bank_details__c,
													 nscrm__balance__c,
													 nscrm__credit_hold__c,
													 nscrm__credit_limit__c,
													 nscrm__days_overdue__c,
													 nscrm__ns_credit_term_id__c,
													 nscrm__ns_customer_category_id__c,
													 nscrm__ns_internal_id__c,
													 nscrm__ns_internal_id__pc,
													 nscrm__ns_sales_rep_id__c,
													 nscrm__ns_shipping_item_id__c,
													 nscrm__ns_subsidiary_id__c,
													 nscrm__ns_tax_item_id__c,
													 nscrm__overdue_balance__c,
													 nscrm__subsidiary__c,
													 nscrm__taxable__c,
													 number_of_active_addendums__c,
													 number_of_addendums__c,
													 number_of_bookings__c,
													 number_of_floors__c,
													 number_of_opps__c,
													 number_of_personal_injuries__c,
													 number_of_rooms__c,
													 numberofemployees,
													 open_opps__pc,
													 opportunity_listing_fee__c,
													 opportunity_to_pull_offers_from__c,
													 opted_in_for_always_on__c,
													 opted_in_for_refundable_deals__c,
													 opted_in_for_suvc__c,
													 original_contractor__c,
													 overduebalance_netsuite__c,
													 ownerid,
													 package_bank_country_selection__c,
													 parent_customer_ns_id__c,
													 parent_ns_id__c,
													 parent_vendor_ns_id__c,
													 parentid,
													 partner_membership__c,
													 partner_product__c,
													 partner_region__c,
													 partner_stage__c,
													 payment_ns_id__c,
													 payment_process__c,
													 payment_process_ns_id__c,
													 payment_terms_contracts__c,
													 payment_terms_days__c,
													 payment_terms_days_in_house_packages__c,
													 payment_terms_days_ns_id__c,
													 person_account_email_address__c,
													 person_account_status__c,
													 person_account_subscription_staatus__c,
													 person_account_territory__c,
													 person_address_city__c,
													 person_address_country__c,
													 person_address_line_1__c,
													 person_address_line_2__c,
													 person_address_post_code__c,
													 person_referred_by__c,
													 personassistantname,
													 personassistantphone,
													 personbirthdate,
													 personcontactid,
													 persondepartment,
													 personemail,
													 personemailbounceddate,
													 personemailbouncedreason,
													 personhasoptedoutofemail,
													 personhomephone,
													 personlastcurequestdate,
													 personlastcuupdatedate,
													 personleadsource,
													 personmailingcity,
													 personmailingcountry,
													 personmailingcountrycode,
													 personmailinggeocodeaccuracy,
													 personmailinglatitude,
													 personmailinglongitude,
													 personmailingpostalcode,
													 personmailingstate,
													 personmailingstatecode,
													 personmailingstreet,
													 personmobilephone,
													 personothercity,
													 personothercountry,
													 personothercountrycode,
													 personothergeocodeaccuracy,
													 personotherlatitude,
													 personotherlongitude,
													 personotherphone,
													 personotherpostalcode,
													 personotherstate,
													 personotherstatecode,
													 personotherstreet,
													 persontitle,
													 phone,
													 photourl,
													 posu_cluster__c,
													 postandcommentprocessed__c,
													 pre_qualification_status__c,
													 pre_qualification_dach__c,
													 pre_qualification_row__c,
													 pre_qualification_uk__c,
													 previous_account_name__c,
													 price_check_url__c,
													 primary__pc,
													 primary_contact__c,
													 primary_contact_email__c,
													 primary_contact_job_title__c,
													 primary_contact_phone__c,
													 primary_contact_to_confirm_preview_link__c,
													 printtransactions_netsuite__c,
													 property_id__c,
													 public_liability_insurance__c,
													 public_liability_insurance_confirmed__c,
													 public_liability_insurance_expiry__c,
													 qc_account_name__c,
													 qc_contact_email__c,
													 qc_contact_job_role__c,
													 qc_contact_name__c,
													 qc_contact_phone__c,
													 qc_destination__c,
													 qc_rating_t_a__c,
													 qc_region__c,
													 qc_rooms__c,
													 qc_shipping_address__c,
													 qc_star_rating__c,
													 qc_sub_region__c,
													 qc_tripadvisor_link__c,
													 qc_tripadvisor_rating__c,
													 qc_website__c,
													 rate_query_end_date__c,
													 rate_query_start_date__c,
													 rating,
													 rating_booking_com__c,
													 rating_ta__c,
													 reason_for_omission__c,
													 record_count__c,
													 recordstocheck__c,
													 recordtypeid,
													 recovered_amount__c,
													 recoveries_next_steps_or_issues__c,
													 recoveries_owner__c,
													 recoveries_payment_method__c,
													 recoveries_status__c,
													 recovery_date__c,
													 red_flag__c,
													 red_flag__pc,
													 red_flag_date_time__c,
													 red_flag_reason__c,
													 red_flag_tp__c,
													 red_flagged_by__c,
													 region__c,
													 region_type__c,
													 remove_red_flag__c,
													 salutation,
													 saq_contact__c,
													 saq_created__c,
													 saq_form_link__c,
													 saq_management_approval_needed__c,
													 saq_passed_date__c,
													 saq_sent_date__c,
													 saq_signed_date__c,
													 saq_status__c,
													 shippingcity,
													 shippingcountry,
													 shippingcountrycode,
													 shippinggeocodeaccuracy,
													 shippinglatitude,
													 shippinglongitude,
													 shippingpostalcode,
													 shippingstate,
													 shippingstatecode,
													 shippingstreet,
													 sicdesc,
													 stage_netsuite__c,
													 star_rating__c,
													 star_rating__pc,
													 sub_affiliate_brand__c,
													 sub_region__c,
													 subsidiaries__c,
													 sum_of_margin__c,
													 sum_of_visits__c,
													 swift__c,
													 swift_in_house_packages__c,
													 swift_travelist__c,
													 swift_validation__c,
													 swift_validation_row__c,
													 swift_value_netsuite__c,
													 synxis_id__c,
													 systemmodstamp,
													 target_account_list__c,
													 tax_item__c,
													 taxable_netsuite__c,
													 taxexempt_netsuite__c,
													 telephone_ins_prov__c,
													 telephone_sales_commission__c,
													 temp_contact_checkbox__pc,
													 third_party_notes__c,
													 third_party_opt_in__c,
													 third_party_payment_notes__c,
													 third_party_provider__c,
													 today__c,
													 today_number__c,
													 today_text__c,
													 total_credit_cashed__c,
													 total_member_spend__c,
													 total_reviews_ta__c,
													 travelbird_id__c,
													 travelist_active__c,
													 trimmed_hotel_name_contracts__c,
													 tripadvisor_link__c,
													 tripadvisor_rating__c,
													 trivago_link__c,
													 tvl_company_signed_date__c,
													 tvl_old_contract_version__c,
													 type,
													 type_ebd__c,
													 type_of_third_party__c,
													 uk_contact_status__c,
													 uk_opportunity_status__c,
													 update_customer_ns__c,
													 update_vendor_ns__c,
													 user_who_experienced_error__c,
													 vat_number__c,
													 vat_number_id_ns__c,
													 vat_number_in_house_packages__c,
													 vat_number_travelist__c,
													 vat_number_validation__c,
													 vat_number_validation_row__c,
													 vatregnumber_netsuite__c,
													 vcc_netsuite__c,
													 vendor_customer_sync_readiness__c,
													 vendor_id_netsuite__c,
													 vendor_insert_ns__c,
													 version_8_contract_approval_way__c,
													 virtual_credit_card__c,
													 virtual_credit_card_in_house_packages__c,
													 virtual_credit_card_ns_id__c,
													 voucher_opt_in__c,
													 web_phone__pc,
													 website,
													 website_sales_commission__c,
													 weekly_opt_in__c,
													 wheelchair_accessible__c,
													 zero_deposit__c,
													 zoho_account_id__c,
													 zoho_contact_id__pc)
SELECT
	schedule_tstamp,
	run_tstamp,
	operation_id,
	created_at,
	updated_at,
	row_dataset_name,
	row_dataset_source,
	row_loaded_at,
	row_schedule_tstamp,
	row_run_tstamp,
	row_filename,
	row_file_row_number,
	row_extract_metadata,
	id,
	lastmodifieddate,
	manual__c,
	marketing_addendum__c,
	marketing_id__c,
	master_contract_field_updated_by__c,
	master_contract_signed__c,
	master_contract_signed_group__c,
	master_contract_wf__c,
	master_group_field_updated_by__c,
	masteraccount__c,
	masteraccountid__c,
	masterrecordid,
	media_contact_territory__pc,
	most_recent_addendum_request__c,
	most_recent_addendum_status__c,
	most_recent_booking__c,
	most_recent_chain_addendum_status__c,
	most_recent_close_date__c,
	most_recent_commission__c,
	most_recent_contract_effective_date__c,
	most_recent_contract_effective_date_ro__c,
	most_recent_contract_effective_date_uk__c,
	most_recent_cw_close_date__c,
	most_recent_deal_end_date__c,
	most_recent_finance_edit_datetime__c,
	most_recent_group_chain_addendum_request__c,
	most_recent_ihp_addendum_request__c,
	most_recent_ihp_addendum_status__c,
	most_recent_ihp_contract_signed_date__c,
	most_recent_margin__c,
	most_recent_master_contract_signed_date__c,
	most_recent_opp__c,
	most_recent_package_destination__c,
	most_recent_pd_proposed_start_date__c,
	most_recent_proposed_start_date__c,
	most_recent_proposed_start_date__pc,
	most_recent_sale_id__c,
	most_recent_successful_deal__c,
	most_recent_successful_sync__c,
	most_recent_sync_datetime__c,
	most_recent_sync_outcome__c,
	most_recent_ta_check__c,
	name,
	nearest_airport_code__c,
	need_periods__c,
	new_business_challenge__c,
	next_proposed_start_date__c,
	no_gdpr_clause_signed_approved_by_sd__c,
	notes__pc,
	notes_on_working_with_se__c,
	ns_category__c,
	ns_category_customer__c,
	ns_contract_type__c,
	ns_update_bank_details__c,
	nscrm__balance__c,
	nscrm__credit_hold__c,
	nscrm__credit_limit__c,
	nscrm__days_overdue__c,
	nscrm__ns_credit_term_id__c,
	nscrm__ns_customer_category_id__c,
	nscrm__ns_internal_id__c,
	nscrm__ns_internal_id__pc,
	nscrm__ns_sales_rep_id__c,
	nscrm__ns_shipping_item_id__c,
	nscrm__ns_subsidiary_id__c,
	nscrm__ns_tax_item_id__c,
	nscrm__overdue_balance__c,
	nscrm__subsidiary__c,
	nscrm__taxable__c,
	number_of_active_addendums__c,
	number_of_addendums__c,
	number_of_bookings__c,
	number_of_floors__c,
	number_of_opps__c,
	number_of_personal_injuries__c,
	number_of_rooms__c,
	numberofemployees,
	open_opps__pc,
	opportunity_listing_fee__c,
	opportunity_to_pull_offers_from__c,
	opted_in_for_always_on__c,
	opted_in_for_refundable_deals__c,
	opted_in_for_suvc__c,
	original_contractor__c,
	overduebalance_netsuite__c,
	ownerid,
	package_bank_country_selection__c,
	parent_customer_ns_id__c,
	parent_ns_id__c,
	parent_vendor_ns_id__c,
	parentid,
	partner_membership__c,
	partner_product__c,
	partner_region__c,
	partner_stage__c,
	payment_ns_id__c,
	payment_process__c,
	payment_process_ns_id__c,
	payment_terms_contracts__c,
	payment_terms_days__c,
	payment_terms_days_in_house_packages__c,
	payment_terms_days_ns_id__c,
	person_account_email_address__c,
	person_account_status__c,
	person_account_subscription_staatus__c,
	person_account_territory__c,
	person_address_city__c,
	person_address_country__c,
	person_address_line_1__c,
	person_address_line_2__c,
	person_address_post_code__c,
	person_referred_by__c,
	personassistantname,
	personassistantphone,
	personbirthdate,
	personcontactid,
	persondepartment,
	personemail,
	personemailbounceddate,
	personemailbouncedreason,
	personhasoptedoutofemail,
	personhomephone,
	personlastcurequestdate,
	personlastcuupdatedate,
	personleadsource,
	personmailingcity,
	personmailingcountry,
	personmailingcountrycode,
	personmailinggeocodeaccuracy,
	personmailinglatitude,
	personmailinglongitude,
	personmailingpostalcode,
	personmailingstate,
	personmailingstatecode,
	personmailingstreet,
	personmobilephone,
	personothercity,
	personothercountry,
	personothercountrycode,
	personothergeocodeaccuracy,
	personotherlatitude,
	personotherlongitude,
	personotherphone,
	personotherpostalcode,
	personotherstate,
	personotherstatecode,
	personotherstreet,
	persontitle,
	phone,
	photourl,
	posu_cluster__c,
	postandcommentprocessed__c,
	pre_qualification_status__c,
	NULL,
	NULL,
	NULL,
	previous_account_name__c,
	price_check_url__c,
	primary__pc,
	primary_contact__c,
	primary_contact_email__c,
	primary_contact_job_title__c,
	primary_contact_phone__c,
	primary_contact_to_confirm_preview_link__c,
	printtransactions_netsuite__c,
	property_id__c,
	public_liability_insurance__c,
	public_liability_insurance_confirmed__c,
	public_liability_insurance_expiry__c,
	qc_account_name__c,
	qc_contact_email__c,
	qc_contact_job_role__c,
	qc_contact_name__c,
	qc_contact_phone__c,
	qc_destination__c,
	qc_rating_t_a__c,
	qc_region__c,
	qc_rooms__c,
	qc_shipping_address__c,
	qc_star_rating__c,
	qc_sub_region__c,
	qc_tripadvisor_link__c,
	qc_tripadvisor_rating__c,
	qc_website__c,
	rate_query_end_date__c,
	rate_query_start_date__c,
	rating,
	rating_booking_com__c,
	rating_ta__c,
	reason_for_omission__c,
	record_count__c,
	recordstocheck__c,
	recordtypeid,
	recovered_amount__c,
	recoveries_next_steps_or_issues__c,
	recoveries_owner__c,
	recoveries_payment_method__c,
	recoveries_status__c,
	recovery_date__c,
	red_flag__c,
	red_flag__pc,
	red_flag_date_time__c,
	red_flag_reason__c,
	red_flag_tp__c,
	red_flagged_by__c,
	region__c,
	region_type__c,
	remove_red_flag__c,
	salutation,
	saq_contact__c,
	saq_created__c,
	saq_form_link__c,
	saq_management_approval_needed__c,
	saq_passed_date__c,
	saq_sent_date__c,
	saq_signed_date__c,
	saq_status__c,
	shippingcity,
	shippingcountry,
	shippingcountrycode,
	shippinggeocodeaccuracy,
	shippinglatitude,
	shippinglongitude,
	shippingpostalcode,
	shippingstate,
	shippingstatecode,
	shippingstreet,
	sicdesc,
	stage_netsuite__c,
	star_rating__c,
	star_rating__pc,
	sub_affiliate_brand__c,
	sub_region__c,
	subsidiaries__c,
	sum_of_margin__c,
	sum_of_visits__c,
	swift__c,
	swift_in_house_packages__c,
	swift_travelist__c,
	swift_validation__c,
	swift_validation_row__c,
	swift_value_netsuite__c,
	synxis_id__c,
	systemmodstamp,
	target_account_list__c,
	tax_item__c,
	taxable_netsuite__c,
	taxexempt_netsuite__c,
	telephone_ins_prov__c,
	telephone_sales_commission__c,
	temp_contact_checkbox__pc,
	third_party_notes__c,
	third_party_opt_in__c,
	third_party_payment_notes__c,
	third_party_provider__c,
	today__c,
	today_number__c,
	today_text__c,
	total_credit_cashed__c,
	total_member_spend__c,
	total_reviews_ta__c,
	travelbird_id__c,
	travelist_active__c,
	trimmed_hotel_name_contracts__c,
	tripadvisor_link__c,
	tripadvisor_rating__c,
	trivago_link__c,
	tvl_company_signed_date__c,
	tvl_old_contract_version__c,
	type,
	type_ebd__c,
	type_of_third_party__c,
	uk_contact_status__c,
	uk_opportunity_status__c,
	update_customer_ns__c,
	update_vendor_ns__c,
	user_who_experienced_error__c,
	vat_number__c,
	vat_number_id_ns__c,
	vat_number_in_house_packages__c,
	vat_number_travelist__c,
	vat_number_validation__c,
	vat_number_validation_row__c,
	vatregnumber_netsuite__c,
	vcc_netsuite__c,
	vendor_customer_sync_readiness__c,
	vendor_id_netsuite__c,
	vendor_insert_ns__c,
	version_8_contract_approval_way__c,
	virtual_credit_card__c,
	virtual_credit_card_in_house_packages__c,
	virtual_credit_card_ns_id__c,
	voucher_opt_in__c,
	web_phone__pc,
	website,
	website_sales_commission__c,
	weekly_opt_in__c,
	wheelchair_accessible__c,
	zero_deposit__c,
	zoho_account_id__c,
	zoho_contact_id__pc
FROM latest_vault_dev_robin.sfsc.account_m_z_20250919
;


------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM raw_vault_dev_robin.sfsc.account_m_z amz
WHERE id = '001Tg00000IdEjuIAF'
;

SELECT *
FROM raw_vault_dev_robin.sfsc.account_m_z amz
WHERE amz.pre_qualification_uk__c IS NOT NULL
;

SELECT *
FROM hygiene_vault_dev_robin.sfsc.account_m_z amz
WHERE amz.pre_qualification_uk__c IS NOT NULL
;

SELECT *
FROM latest_vault_dev_robin.sfsc.account_m_z amz
WHERE amz.pre_qualification_uk__c IS NOT NULL
;

SELECT *
FROM raw_vault.sfsc.account_m_z amz
WHERE amz.pre_qualification_status__c IS NOT NULL
  AND TO_TIMESTAMP(amz.lastmodifieddate, 'yyyy-mm-dd "T" HH24:MI:SS.FFTZHTZM') >= CURRENT_DATE - 4
;


------------------------------------------------------------------------------------------------------------------------
-- post deployment

USE ROLE pipelinerunner
;

CREATE OR REPLACE TRANSIENT TABLE raw_vault.sfsc.account_m_z_20250917 CLONE raw_vault.sfsc.account_m_z
;

CREATE OR REPLACE TRANSIENT TABLE hygiene_vault.sfsc.account_m_z_20250918 CLONE hygiene_vault.sfsc.account_m_z
;

CREATE OR REPLACE TRANSIENT TABLE latest_vault.sfsc.account_m_z_20250919 CLONE latest_vault.sfsc.account_m_z
;


CREATE OR REPLACE TRANSIENT TABLE raw_vault.sfsc.account_m_z CLUSTER BY (TO_DATE(schedule_tstamp))
(
	dataset_name                                VARCHAR       NOT NULL,
	dataset_source                              VARCHAR       NOT NULL,
	schedule_interval                           VARCHAR       NOT NULL,
	schedule_tstamp                             TIMESTAMP_NTZ NOT NULL,
	run_tstamp                                  TIMESTAMP_NTZ NOT NULL,
	loaded_at                                   TIMESTAMP_NTZ NOT NULL,
	filename                                    VARCHAR       NOT NULL,
	file_row_number                             NUMBER        NOT NULL,
	extract_metadata                            VARIANT,
	id                                          VARCHAR,
	lastmodifieddate                            VARCHAR,
	manual__c                                   VARCHAR,
	marketing_addendum__c                       VARCHAR,
	marketing_id__c                             VARCHAR,
	master_contract_field_updated_by__c         VARCHAR,
	master_contract_signed__c                   VARCHAR,
	master_contract_signed_group__c             VARCHAR,
	master_contract_wf__c                       VARCHAR,
	master_group_field_updated_by__c            VARCHAR,
	masteraccount__c                            VARCHAR,
	masteraccountid__c                          VARCHAR,
	masterrecordid                              VARCHAR,
	media_contact_territory__pc                 VARCHAR,
	most_recent_addendum_request__c             VARCHAR,
	most_recent_addendum_status__c              VARCHAR,
	most_recent_booking__c                      VARCHAR,
	most_recent_chain_addendum_status__c        VARCHAR,
	most_recent_close_date__c                   VARCHAR,
	most_recent_commission__c                   VARCHAR,
	most_recent_contract_effective_date__c      VARCHAR,
	most_recent_contract_effective_date_ro__c   VARCHAR,
	most_recent_contract_effective_date_uk__c   VARCHAR,
	most_recent_cw_close_date__c                VARCHAR,
	most_recent_deal_end_date__c                VARCHAR,
	most_recent_finance_edit_datetime__c        VARCHAR,
	most_recent_group_chain_addendum_request__c VARCHAR,
	most_recent_ihp_addendum_request__c         VARCHAR,
	most_recent_ihp_addendum_status__c          VARCHAR,
	most_recent_ihp_contract_signed_date__c     VARCHAR,
	most_recent_margin__c                       VARCHAR,
	most_recent_master_contract_signed_date__c  VARCHAR,
	most_recent_opp__c                          VARCHAR,
	most_recent_package_destination__c          VARCHAR,
	most_recent_pd_proposed_start_date__c       VARCHAR,
	most_recent_proposed_start_date__c          VARCHAR,
	most_recent_proposed_start_date__pc         VARCHAR,
	most_recent_sale_id__c                      VARCHAR,
	most_recent_successful_deal__c              VARCHAR,
	most_recent_successful_sync__c              VARCHAR,
	most_recent_sync_datetime__c                VARCHAR,
	most_recent_sync_outcome__c                 VARCHAR,
	most_recent_ta_check__c                     VARCHAR,
	name                                        VARCHAR,
	nearest_airport_code__c                     VARCHAR,
	need_periods__c                             VARCHAR,
	new_business_challenge__c                   VARCHAR,
	next_proposed_start_date__c                 VARCHAR,
	no_gdpr_clause_signed_approved_by_sd__c     VARCHAR,
	notes__pc                                   VARCHAR,
	notes_on_working_with_se__c                 VARCHAR,
	ns_category__c                              VARCHAR,
	ns_category_customer__c                     VARCHAR,
	ns_contract_type__c                         VARCHAR,
	ns_update_bank_details__c                   VARCHAR,
	nscrm__balance__c                           VARCHAR,
	nscrm__credit_hold__c                       VARCHAR,
	nscrm__credit_limit__c                      VARCHAR,
	nscrm__days_overdue__c                      VARCHAR,
	nscrm__ns_credit_term_id__c                 VARCHAR,
	nscrm__ns_customer_category_id__c           VARCHAR,
	nscrm__ns_internal_id__c                    VARCHAR,
	nscrm__ns_internal_id__pc                   VARCHAR,
	nscrm__ns_sales_rep_id__c                   VARCHAR,
	nscrm__ns_shipping_item_id__c               VARCHAR,
	nscrm__ns_subsidiary_id__c                  VARCHAR,
	nscrm__ns_tax_item_id__c                    VARCHAR,
	nscrm__overdue_balance__c                   VARCHAR,
	nscrm__subsidiary__c                        VARCHAR,
	nscrm__taxable__c                           VARCHAR,
	number_of_active_addendums__c               VARCHAR,
	number_of_addendums__c                      VARCHAR,
	number_of_bookings__c                       VARCHAR,
	number_of_floors__c                         VARCHAR,
	number_of_opps__c                           VARCHAR,
	number_of_personal_injuries__c              VARCHAR,
	number_of_rooms__c                          VARCHAR,
	numberofemployees                           VARCHAR,
	open_opps__pc                               VARCHAR,
	opportunity_listing_fee__c                  VARCHAR,
	opportunity_to_pull_offers_from__c          VARCHAR,
	opted_in_for_always_on__c                   VARCHAR,
	opted_in_for_refundable_deals__c            VARCHAR,
	opted_in_for_suvc__c                        VARCHAR,
	original_contractor__c                      VARCHAR,
	overduebalance_netsuite__c                  VARCHAR,
	ownerid                                     VARCHAR,
	package_bank_country_selection__c           VARCHAR,
	parent_customer_ns_id__c                    VARCHAR,
	parent_ns_id__c                             VARCHAR,
	parent_vendor_ns_id__c                      VARCHAR,
	parentid                                    VARCHAR,
	partner_membership__c                       VARCHAR,
	partner_product__c                          VARCHAR,
	partner_region__c                           VARCHAR,
	partner_stage__c                            VARCHAR,
	payment_ns_id__c                            VARCHAR,
	payment_process__c                          VARCHAR,
	payment_process_ns_id__c                    VARCHAR,
	payment_terms_contracts__c                  VARCHAR,
	payment_terms_days__c                       VARCHAR,
	payment_terms_days_in_house_packages__c     VARCHAR,
	payment_terms_days_ns_id__c                 VARCHAR,
	person_account_email_address__c             VARCHAR,
	person_account_status__c                    VARCHAR,
	person_account_subscription_staatus__c      VARCHAR,
	person_account_territory__c                 VARCHAR,
	person_address_city__c                      VARCHAR,
	person_address_country__c                   VARCHAR,
	person_address_line_1__c                    VARCHAR,
	person_address_line_2__c                    VARCHAR,
	person_address_post_code__c                 VARCHAR,
	person_referred_by__c                       VARCHAR,
	personassistantname                         VARCHAR,
	personassistantphone                        VARCHAR,
	personbirthdate                             VARCHAR,
	personcontactid                             VARCHAR,
	persondepartment                            VARCHAR,
	personemail                                 VARCHAR,
	personemailbounceddate                      VARCHAR,
	personemailbouncedreason                    VARCHAR,
	personhasoptedoutofemail                    VARCHAR,
	personhomephone                             VARCHAR,
	personlastcurequestdate                     VARCHAR,
	personlastcuupdatedate                      VARCHAR,
	personleadsource                            VARCHAR,
	personmailingcity                           VARCHAR,
	personmailingcountry                        VARCHAR,
	personmailingcountrycode                    VARCHAR,
	personmailinggeocodeaccuracy                VARCHAR,
	personmailinglatitude                       VARCHAR,
	personmailinglongitude                      VARCHAR,
	personmailingpostalcode                     VARCHAR,
	personmailingstate                          VARCHAR,
	personmailingstatecode                      VARCHAR,
	personmailingstreet                         VARCHAR,
	personmobilephone                           VARCHAR,
	personothercity                             VARCHAR,
	personothercountry                          VARCHAR,
	personothercountrycode                      VARCHAR,
	personothergeocodeaccuracy                  VARCHAR,
	personotherlatitude                         VARCHAR,
	personotherlongitude                        VARCHAR,
	personotherphone                            VARCHAR,
	personotherpostalcode                       VARCHAR,
	personotherstate                            VARCHAR,
	personotherstatecode                        VARCHAR,
	personotherstreet                           VARCHAR,
	persontitle                                 VARCHAR,
	phone                                       VARCHAR,
	photourl                                    VARCHAR,
	posu_cluster__c                             VARCHAR,
	postandcommentprocessed__c                  VARCHAR,
	pre_qualification_status__c                 VARCHAR,
	pre_qualification_dach__c                   VARCHAR,
	pre_qualification_row__c                    VARCHAR,
	pre_qualification_uk__c                     VARCHAR,
	previous_account_name__c                    VARCHAR,
	price_check_url__c                          VARCHAR,
	primary__pc                                 VARCHAR,
	primary_contact__c                          VARCHAR,
	primary_contact_email__c                    VARCHAR,
	primary_contact_job_title__c                VARCHAR,
	primary_contact_phone__c                    VARCHAR,
	primary_contact_to_confirm_preview_link__c  VARCHAR,
	printtransactions_netsuite__c               VARCHAR,
	property_id__c                              VARCHAR,
	public_liability_insurance__c               VARCHAR,
	public_liability_insurance_confirmed__c     VARCHAR,
	public_liability_insurance_expiry__c        VARCHAR,
	qc_account_name__c                          VARCHAR,
	qc_contact_email__c                         VARCHAR,
	qc_contact_job_role__c                      VARCHAR,
	qc_contact_name__c                          VARCHAR,
	qc_contact_phone__c                         VARCHAR,
	qc_destination__c                           VARCHAR,
	qc_rating_t_a__c                            VARCHAR,
	qc_region__c                                VARCHAR,
	qc_rooms__c                                 VARCHAR,
	qc_shipping_address__c                      VARCHAR,
	qc_star_rating__c                           VARCHAR,
	qc_sub_region__c                            VARCHAR,
	qc_tripadvisor_link__c                      VARCHAR,
	qc_tripadvisor_rating__c                    VARCHAR,
	qc_website__c                               VARCHAR,
	rate_query_end_date__c                      VARCHAR,
	rate_query_start_date__c                    VARCHAR,
	rating_booking_com__c                       VARCHAR,
	rating_ta__c                                VARCHAR,
	rating                                      VARCHAR,
	reason_for_omission__c                      VARCHAR,
	record_count__c                             VARCHAR,
	recordstocheck__c                           VARCHAR,
	recordtypeid                                VARCHAR,
	recovered_amount__c                         VARCHAR,
	recoveries_next_steps_or_issues__c          VARCHAR,
	recoveries_owner__c                         VARCHAR,
	recoveries_payment_method__c                VARCHAR,
	recoveries_status__c                        VARCHAR,
	recovery_date__c                            VARCHAR,
	red_flag__c                                 VARCHAR,
	red_flag__pc                                VARCHAR,
	red_flag_date_time__c                       VARCHAR,
	red_flag_reason__c                          VARCHAR,
	red_flag_tp__c                              VARCHAR,
	red_flagged_by__c                           VARCHAR,
	region__c                                   VARCHAR,
	region_type__c                              VARCHAR,
	remove_red_flag__c                          VARCHAR,
	salutation                                  VARCHAR,
	saq_contact__c                              VARCHAR,
	saq_created__c                              VARCHAR,
	saq_form_link__c                            VARCHAR,
	saq_management_approval_needed__c           VARCHAR,
	saq_passed_date__c                          VARCHAR,
	saq_sent_date__c                            VARCHAR,
	saq_signed_date__c                          VARCHAR,
	saq_status__c                               VARCHAR,
	shippingcity                                VARCHAR,
	shippingcountry                             VARCHAR,
	shippingcountrycode                         VARCHAR,
	shippinggeocodeaccuracy                     VARCHAR,
	shippinglatitude                            VARCHAR,
	shippinglongitude                           VARCHAR,
	shippingpostalcode                          VARCHAR,
	shippingstate                               VARCHAR,
	shippingstatecode                           VARCHAR,
	shippingstreet                              VARCHAR,
	sicdesc                                     VARCHAR,
	stage_netsuite__c                           VARCHAR,
	star_rating__c                              VARCHAR,
	star_rating__pc                             VARCHAR,
	sub_affiliate_brand__c                      VARCHAR,
	sub_region__c                               VARCHAR,
	subsidiaries__c                             VARCHAR,
	sum_of_margin__c                            VARCHAR,
	sum_of_visits__c                            VARCHAR,
	swift__c                                    VARCHAR,
	swift_in_house_packages__c                  VARCHAR,
	swift_travelist__c                          VARCHAR,
	swift_validation__c                         VARCHAR,
	swift_validation_row__c                     VARCHAR,
	swift_value_netsuite__c                     VARCHAR,
	synxis_id__c                                VARCHAR,
	systemmodstamp                              VARCHAR,
	target_account_list__c                      VARCHAR,
	tax_item__c                                 VARCHAR,
	taxable_netsuite__c                         VARCHAR,
	taxexempt_netsuite__c                       VARCHAR,
	telephone_ins_prov__c                       VARCHAR,
	telephone_sales_commission__c               VARCHAR,
	temp_contact_checkbox__pc                   VARCHAR,
	third_party_notes__c                        VARCHAR,
	third_party_opt_in__c                       VARCHAR,
	third_party_payment_notes__c                VARCHAR,
	third_party_provider__c                     VARCHAR,
	today__c                                    VARCHAR,
	today_number__c                             VARCHAR,
	today_text__c                               VARCHAR,
	total_credit_cashed__c                      VARCHAR,
	total_member_spend__c                       VARCHAR,
	total_reviews_ta__c                         VARCHAR,
	travelbird_id__c                            VARCHAR,
	travelist_active__c                         VARCHAR,
	trimmed_hotel_name_contracts__c             VARCHAR,
	tripadvisor_link__c                         VARCHAR,
	tripadvisor_rating__c                       VARCHAR,
	trivago_link__c                             VARCHAR,
	tvl_company_signed_date__c                  VARCHAR,
	tvl_old_contract_version__c                 VARCHAR,
	type_ebd__c                                 VARCHAR,
	type_of_third_party__c                      VARCHAR,
	type                                        VARCHAR,
	uk_contact_status__c                        VARCHAR,
	uk_opportunity_status__c                    VARCHAR,
	update_customer_ns__c                       VARCHAR,
	update_vendor_ns__c                         VARCHAR,
	user_who_experienced_error__c               VARCHAR,
	vat_number__c                               VARCHAR,
	vat_number_id_ns__c                         VARCHAR,
	vat_number_in_house_packages__c             VARCHAR,
	vat_number_travelist__c                     VARCHAR,
	vat_number_validation__c                    VARCHAR,
	vat_number_validation_row__c                VARCHAR,
	vatregnumber_netsuite__c                    VARCHAR,
	vcc_netsuite__c                             VARCHAR,
	vendor_customer_sync_readiness__c           VARCHAR,
	vendor_id_netsuite__c                       VARCHAR,
	vendor_insert_ns__c                         VARCHAR,
	version_8_contract_approval_way__c          VARCHAR,
	virtual_credit_card__c                      VARCHAR,
	virtual_credit_card_in_house_packages__c    VARCHAR,
	virtual_credit_card_ns_id__c                VARCHAR,
	voucher_opt_in__c                           VARCHAR,
	web_phone__pc                               VARCHAR,
	website_sales_commission__c                 VARCHAR,
	website                                     VARCHAR,
	weekly_opt_in__c                            VARCHAR,
	wheelchair_accessible__c                    VARCHAR,
	zero_deposit__c                             VARCHAR,
	zoho_account_id__c                          VARCHAR,
	zoho_contact_id__pc                         VARCHAR,
	PRIMARY KEY (dataset_name, dataset_source, schedule_interval, schedule_tstamp, run_tstamp, filename,
				 file_row_number)
)
;


INSERT INTO raw_vault.sfsc.account_m_z (dataset_name,
										dataset_source,
										schedule_interval,
										schedule_tstamp,
										run_tstamp,
										loaded_at,
										filename,
										file_row_number,
										extract_metadata,
										id,
										lastmodifieddate,
										manual__c,
										marketing_addendum__c,
										marketing_id__c,
										master_contract_field_updated_by__c,
										master_contract_signed__c,
										master_contract_signed_group__c,
										master_contract_wf__c,
										master_group_field_updated_by__c,
										masteraccount__c,
										masteraccountid__c,
										masterrecordid,
										media_contact_territory__pc,
										most_recent_addendum_request__c,
										most_recent_addendum_status__c,
										most_recent_booking__c,
										most_recent_chain_addendum_status__c,
										most_recent_close_date__c,
										most_recent_commission__c,
										most_recent_contract_effective_date__c,
										most_recent_contract_effective_date_ro__c,
										most_recent_contract_effective_date_uk__c,
										most_recent_cw_close_date__c,
										most_recent_deal_end_date__c,
										most_recent_finance_edit_datetime__c,
										most_recent_group_chain_addendum_request__c,
										most_recent_ihp_addendum_request__c,
										most_recent_ihp_addendum_status__c,
										most_recent_ihp_contract_signed_date__c,
										most_recent_margin__c,
										most_recent_master_contract_signed_date__c,
										most_recent_opp__c,
										most_recent_package_destination__c,
										most_recent_pd_proposed_start_date__c,
										most_recent_proposed_start_date__c,
										most_recent_proposed_start_date__pc,
										most_recent_sale_id__c,
										most_recent_successful_deal__c,
										most_recent_successful_sync__c,
										most_recent_sync_datetime__c,
										most_recent_sync_outcome__c,
										most_recent_ta_check__c,
										name,
										nearest_airport_code__c,
										need_periods__c,
										new_business_challenge__c,
										next_proposed_start_date__c,
										no_gdpr_clause_signed_approved_by_sd__c,
										notes__pc,
										notes_on_working_with_se__c,
										ns_category__c,
										ns_category_customer__c,
										ns_contract_type__c,
										ns_update_bank_details__c,
										nscrm__balance__c,
										nscrm__credit_hold__c,
										nscrm__credit_limit__c,
										nscrm__days_overdue__c,
										nscrm__ns_credit_term_id__c,
										nscrm__ns_customer_category_id__c,
										nscrm__ns_internal_id__c,
										nscrm__ns_internal_id__pc,
										nscrm__ns_sales_rep_id__c,
										nscrm__ns_shipping_item_id__c,
										nscrm__ns_subsidiary_id__c,
										nscrm__ns_tax_item_id__c,
										nscrm__overdue_balance__c,
										nscrm__subsidiary__c,
										nscrm__taxable__c,
										number_of_active_addendums__c,
										number_of_addendums__c,
										number_of_bookings__c,
										number_of_floors__c,
										number_of_opps__c,
										number_of_personal_injuries__c,
										number_of_rooms__c,
										numberofemployees,
										open_opps__pc,
										opportunity_listing_fee__c,
										opportunity_to_pull_offers_from__c,
										opted_in_for_always_on__c,
										opted_in_for_refundable_deals__c,
										opted_in_for_suvc__c,
										original_contractor__c,
										overduebalance_netsuite__c,
										ownerid,
										package_bank_country_selection__c,
										parent_customer_ns_id__c,
										parent_ns_id__c,
										parent_vendor_ns_id__c,
										parentid,
										partner_membership__c,
										partner_product__c,
										partner_region__c,
										partner_stage__c,
										payment_ns_id__c,
										payment_process__c,
										payment_process_ns_id__c,
										payment_terms_contracts__c,
										payment_terms_days__c,
										payment_terms_days_in_house_packages__c,
										payment_terms_days_ns_id__c,
										person_account_email_address__c,
										person_account_status__c,
										person_account_subscription_staatus__c,
										person_account_territory__c,
										person_address_city__c,
										person_address_country__c,
										person_address_line_1__c,
										person_address_line_2__c,
										person_address_post_code__c,
										person_referred_by__c,
										personassistantname,
										personassistantphone,
										personbirthdate,
										personcontactid,
										persondepartment,
										personemail,
										personemailbounceddate,
										personemailbouncedreason,
										personhasoptedoutofemail,
										personhomephone,
										personlastcurequestdate,
										personlastcuupdatedate,
										personleadsource,
										personmailingcity,
										personmailingcountry,
										personmailingcountrycode,
										personmailinggeocodeaccuracy,
										personmailinglatitude,
										personmailinglongitude,
										personmailingpostalcode,
										personmailingstate,
										personmailingstatecode,
										personmailingstreet,
										personmobilephone,
										personothercity,
										personothercountry,
										personothercountrycode,
										personothergeocodeaccuracy,
										personotherlatitude,
										personotherlongitude,
										personotherphone,
										personotherpostalcode,
										personotherstate,
										personotherstatecode,
										personotherstreet,
										persontitle,
										phone,
										photourl,
										posu_cluster__c,
										postandcommentprocessed__c,
										pre_qualification_status__c,
										pre_qualification_dach__c,
										pre_qualification_row__c,
										pre_qualification_uk__c,
										previous_account_name__c,
										price_check_url__c,
										primary__pc,
										primary_contact__c,
										primary_contact_email__c,
										primary_contact_job_title__c,
										primary_contact_phone__c,
										primary_contact_to_confirm_preview_link__c,
										printtransactions_netsuite__c,
										property_id__c,
										public_liability_insurance__c,
										public_liability_insurance_confirmed__c,
										public_liability_insurance_expiry__c,
										qc_account_name__c,
										qc_contact_email__c,
										qc_contact_job_role__c,
										qc_contact_name__c,
										qc_contact_phone__c,
										qc_destination__c,
										qc_rating_t_a__c,
										qc_region__c,
										qc_rooms__c,
										qc_shipping_address__c,
										qc_star_rating__c,
										qc_sub_region__c,
										qc_tripadvisor_link__c,
										qc_tripadvisor_rating__c,
										qc_website__c,
										rate_query_end_date__c,
										rate_query_start_date__c,
										rating_booking_com__c,
										rating_ta__c,
										rating,
										reason_for_omission__c,
										record_count__c,
										recordstocheck__c,
										recordtypeid,
										recovered_amount__c,
										recoveries_next_steps_or_issues__c,
										recoveries_owner__c,
										recoveries_payment_method__c,
										recoveries_status__c,
										recovery_date__c,
										red_flag__c,
										red_flag__pc,
										red_flag_date_time__c,
										red_flag_reason__c,
										red_flag_tp__c,
										red_flagged_by__c,
										region__c,
										region_type__c,
										remove_red_flag__c,
										salutation,
										saq_contact__c,
										saq_created__c,
										saq_form_link__c,
										saq_management_approval_needed__c,
										saq_passed_date__c,
										saq_sent_date__c,
										saq_signed_date__c,
										saq_status__c,
										shippingcity,
										shippingcountry,
										shippingcountrycode,
										shippinggeocodeaccuracy,
										shippinglatitude,
										shippinglongitude,
										shippingpostalcode,
										shippingstate,
										shippingstatecode,
										shippingstreet,
										sicdesc,
										stage_netsuite__c,
										star_rating__c,
										star_rating__pc,
										sub_affiliate_brand__c,
										sub_region__c,
										subsidiaries__c,
										sum_of_margin__c,
										sum_of_visits__c,
										swift__c,
										swift_in_house_packages__c,
										swift_travelist__c,
										swift_validation__c,
										swift_validation_row__c,
										swift_value_netsuite__c,
										synxis_id__c,
										systemmodstamp,
										target_account_list__c,
										tax_item__c,
										taxable_netsuite__c,
										taxexempt_netsuite__c,
										telephone_ins_prov__c,
										telephone_sales_commission__c,
										temp_contact_checkbox__pc,
										third_party_notes__c,
										third_party_opt_in__c,
										third_party_payment_notes__c,
										third_party_provider__c,
										today__c,
										today_number__c,
										today_text__c,
										total_credit_cashed__c,
										total_member_spend__c,
										total_reviews_ta__c,
										travelbird_id__c,
										travelist_active__c,
										trimmed_hotel_name_contracts__c,
										tripadvisor_link__c,
										tripadvisor_rating__c,
										trivago_link__c,
										tvl_company_signed_date__c,
										tvl_old_contract_version__c,
										type_ebd__c,
										type_of_third_party__c,
										type,
										uk_contact_status__c,
										uk_opportunity_status__c,
										update_customer_ns__c,
										update_vendor_ns__c,
										user_who_experienced_error__c,
										vat_number__c,
										vat_number_id_ns__c,
										vat_number_in_house_packages__c,
										vat_number_travelist__c,
										vat_number_validation__c,
										vat_number_validation_row__c,
										vatregnumber_netsuite__c,
										vcc_netsuite__c,
										vendor_customer_sync_readiness__c,
										vendor_id_netsuite__c,
										vendor_insert_ns__c,
										version_8_contract_approval_way__c,
										virtual_credit_card__c,
										virtual_credit_card_in_house_packages__c,
										virtual_credit_card_ns_id__c,
										voucher_opt_in__c,
										web_phone__pc,
										website_sales_commission__c,
										website,
										weekly_opt_in__c,
										wheelchair_accessible__c,
										zero_deposit__c,
										zoho_account_id__c,
										zoho_contact_id__pc)
SELECT
	dataset_name,
	dataset_source,
	schedule_interval,
	schedule_tstamp,
	run_tstamp,
	loaded_at,
	filename,
	file_row_number,
	extract_metadata,
	id,
	lastmodifieddate,
	manual__c,
	marketing_addendum__c,
	marketing_id__c,
	master_contract_field_updated_by__c,
	master_contract_signed__c,
	master_contract_signed_group__c,
	master_contract_wf__c,
	master_group_field_updated_by__c,
	masteraccount__c,
	masteraccountid__c,
	masterrecordid,
	media_contact_territory__pc,
	most_recent_addendum_request__c,
	most_recent_addendum_status__c,
	most_recent_booking__c,
	most_recent_chain_addendum_status__c,
	most_recent_close_date__c,
	most_recent_commission__c,
	most_recent_contract_effective_date__c,
	most_recent_contract_effective_date_ro__c,
	most_recent_contract_effective_date_uk__c,
	most_recent_cw_close_date__c,
	most_recent_deal_end_date__c,
	most_recent_finance_edit_datetime__c,
	most_recent_group_chain_addendum_request__c,
	most_recent_ihp_addendum_request__c,
	most_recent_ihp_addendum_status__c,
	most_recent_ihp_contract_signed_date__c,
	most_recent_margin__c,
	most_recent_master_contract_signed_date__c,
	most_recent_opp__c,
	most_recent_package_destination__c,
	most_recent_pd_proposed_start_date__c,
	most_recent_proposed_start_date__c,
	most_recent_proposed_start_date__pc,
	most_recent_sale_id__c,
	most_recent_successful_deal__c,
	most_recent_successful_sync__c,
	most_recent_sync_datetime__c,
	most_recent_sync_outcome__c,
	most_recent_ta_check__c,
	name,
	nearest_airport_code__c,
	need_periods__c,
	new_business_challenge__c,
	next_proposed_start_date__c,
	no_gdpr_clause_signed_approved_by_sd__c,
	notes__pc,
	notes_on_working_with_se__c,
	ns_category__c,
	ns_category_customer__c,
	ns_contract_type__c,
	ns_update_bank_details__c,
	nscrm__balance__c,
	nscrm__credit_hold__c,
	nscrm__credit_limit__c,
	nscrm__days_overdue__c,
	nscrm__ns_credit_term_id__c,
	nscrm__ns_customer_category_id__c,
	nscrm__ns_internal_id__c,
	nscrm__ns_internal_id__pc,
	nscrm__ns_sales_rep_id__c,
	nscrm__ns_shipping_item_id__c,
	nscrm__ns_subsidiary_id__c,
	nscrm__ns_tax_item_id__c,
	nscrm__overdue_balance__c,
	nscrm__subsidiary__c,
	nscrm__taxable__c,
	number_of_active_addendums__c,
	number_of_addendums__c,
	number_of_bookings__c,
	number_of_floors__c,
	number_of_opps__c,
	number_of_personal_injuries__c,
	number_of_rooms__c,
	numberofemployees,
	open_opps__pc,
	opportunity_listing_fee__c,
	opportunity_to_pull_offers_from__c,
	opted_in_for_always_on__c,
	opted_in_for_refundable_deals__c,
	opted_in_for_suvc__c,
	original_contractor__c,
	overduebalance_netsuite__c,
	ownerid,
	package_bank_country_selection__c,
	parent_customer_ns_id__c,
	parent_ns_id__c,
	parent_vendor_ns_id__c,
	parentid,
	partner_membership__c,
	partner_product__c,
	partner_region__c,
	partner_stage__c,
	payment_ns_id__c,
	payment_process__c,
	payment_process_ns_id__c,
	payment_terms_contracts__c,
	payment_terms_days__c,
	payment_terms_days_in_house_packages__c,
	payment_terms_days_ns_id__c,
	person_account_email_address__c,
	person_account_status__c,
	person_account_subscription_staatus__c,
	person_account_territory__c,
	person_address_city__c,
	person_address_country__c,
	person_address_line_1__c,
	person_address_line_2__c,
	person_address_post_code__c,
	person_referred_by__c,
	personassistantname,
	personassistantphone,
	personbirthdate,
	personcontactid,
	persondepartment,
	personemail,
	personemailbounceddate,
	personemailbouncedreason,
	personhasoptedoutofemail,
	personhomephone,
	personlastcurequestdate,
	personlastcuupdatedate,
	personleadsource,
	personmailingcity,
	personmailingcountry,
	personmailingcountrycode,
	personmailinggeocodeaccuracy,
	personmailinglatitude,
	personmailinglongitude,
	personmailingpostalcode,
	personmailingstate,
	personmailingstatecode,
	personmailingstreet,
	personmobilephone,
	personothercity,
	personothercountry,
	personothercountrycode,
	personothergeocodeaccuracy,
	personotherlatitude,
	personotherlongitude,
	personotherphone,
	personotherpostalcode,
	personotherstate,
	personotherstatecode,
	personotherstreet,
	persontitle,
	phone,
	photourl,
	posu_cluster__c,
	postandcommentprocessed__c,
	pre_qualification_status__c,
	NULL,
	NULL,
	NULL,
	previous_account_name__c,
	price_check_url__c,
	primary__pc,
	primary_contact__c,
	primary_contact_email__c,
	primary_contact_job_title__c,
	primary_contact_phone__c,
	primary_contact_to_confirm_preview_link__c,
	printtransactions_netsuite__c,
	property_id__c,
	public_liability_insurance__c,
	public_liability_insurance_confirmed__c,
	public_liability_insurance_expiry__c,
	qc_account_name__c,
	qc_contact_email__c,
	qc_contact_job_role__c,
	qc_contact_name__c,
	qc_contact_phone__c,
	qc_destination__c,
	qc_rating_t_a__c,
	qc_region__c,
	qc_rooms__c,
	qc_shipping_address__c,
	qc_star_rating__c,
	qc_sub_region__c,
	qc_tripadvisor_link__c,
	qc_tripadvisor_rating__c,
	qc_website__c,
	rate_query_end_date__c,
	rate_query_start_date__c,
	rating_booking_com__c,
	rating_ta__c,
	rating,
	reason_for_omission__c,
	record_count__c,
	recordstocheck__c,
	recordtypeid,
	recovered_amount__c,
	recoveries_next_steps_or_issues__c,
	recoveries_owner__c,
	recoveries_payment_method__c,
	recoveries_status__c,
	recovery_date__c,
	red_flag__c,
	red_flag__pc,
	red_flag_date_time__c,
	red_flag_reason__c,
	red_flag_tp__c,
	red_flagged_by__c,
	region__c,
	region_type__c,
	remove_red_flag__c,
	salutation,
	saq_contact__c,
	saq_created__c,
	saq_form_link__c,
	saq_management_approval_needed__c,
	saq_passed_date__c,
	saq_sent_date__c,
	saq_signed_date__c,
	saq_status__c,
	shippingcity,
	shippingcountry,
	shippingcountrycode,
	shippinggeocodeaccuracy,
	shippinglatitude,
	shippinglongitude,
	shippingpostalcode,
	shippingstate,
	shippingstatecode,
	shippingstreet,
	sicdesc,
	stage_netsuite__c,
	star_rating__c,
	star_rating__pc,
	sub_affiliate_brand__c,
	sub_region__c,
	subsidiaries__c,
	sum_of_margin__c,
	sum_of_visits__c,
	swift__c,
	swift_in_house_packages__c,
	swift_travelist__c,
	swift_validation__c,
	swift_validation_row__c,
	swift_value_netsuite__c,
	synxis_id__c,
	systemmodstamp,
	target_account_list__c,
	tax_item__c,
	taxable_netsuite__c,
	taxexempt_netsuite__c,
	telephone_ins_prov__c,
	telephone_sales_commission__c,
	temp_contact_checkbox__pc,
	third_party_notes__c,
	third_party_opt_in__c,
	third_party_payment_notes__c,
	third_party_provider__c,
	today__c,
	today_number__c,
	today_text__c,
	total_credit_cashed__c,
	total_member_spend__c,
	total_reviews_ta__c,
	travelbird_id__c,
	travelist_active__c,
	trimmed_hotel_name_contracts__c,
	tripadvisor_link__c,
	tripadvisor_rating__c,
	trivago_link__c,
	tvl_company_signed_date__c,
	tvl_old_contract_version__c,
	type_ebd__c,
	type_of_third_party__c,
	type,
	uk_contact_status__c,
	uk_opportunity_status__c,
	update_customer_ns__c,
	update_vendor_ns__c,
	user_who_experienced_error__c,
	vat_number__c,
	vat_number_id_ns__c,
	vat_number_in_house_packages__c,
	vat_number_travelist__c,
	vat_number_validation__c,
	vat_number_validation_row__c,
	vatregnumber_netsuite__c,
	vcc_netsuite__c,
	vendor_customer_sync_readiness__c,
	vendor_id_netsuite__c,
	vendor_insert_ns__c,
	version_8_contract_approval_way__c,
	virtual_credit_card__c,
	virtual_credit_card_in_house_packages__c,
	virtual_credit_card_ns_id__c,
	voucher_opt_in__c,
	web_phone__pc,
	website_sales_commission__c,
	website,
	weekly_opt_in__c,
	wheelchair_accessible__c,
	zero_deposit__c,
	zoho_account_id__c,
	zoho_contact_id__pc
FROM raw_vault.sfsc.account_m_z_20250917 a
;

CREATE OR REPLACE TABLE hygiene_vault.sfsc.account_m_z
(
	-- (lineage) metadata for the current job
	schedule_tstamp                                      TIMESTAMP NOT NULL,
	run_tstamp                                           TIMESTAMP NOT NULL,
	operation_id                                         VARCHAR   NOT NULL,
	created_at                                           TIMESTAMP NOT NULL,
	updated_at                                           TIMESTAMP NOT NULL,

	-- (lineage) original metadata of row itself
	row_dataset_name                                     VARCHAR   NOT NULL,
	row_dataset_source                                   VARCHAR   NOT NULL,
	row_loaded_at                                        TIMESTAMP NOT NULL,
	row_schedule_tstamp                                  TIMESTAMP NOT NULL,
	row_run_tstamp                                       TIMESTAMP NOT NULL,
	row_filename                                         VARCHAR   NOT NULL,
	row_file_row_number                                  INT       NOT NULL,
	row_extract_metadata                                 VARIANT,


	-- transformed columns


	-- original columns
	id                                                   VARCHAR,
	lastmodifieddate                                     TIMESTAMP,
	manual__c                                            BOOLEAN,
	marketing_addendum__c                                BOOLEAN,
	marketing_id__c                                      VARCHAR,
	master_contract_field_updated_by__c                  VARCHAR,
	master_contract_signed__c                            BOOLEAN,
	master_contract_signed_group__c                      BOOLEAN,
	master_contract_wf__c                                BOOLEAN,
	master_group_field_updated_by__c                     VARCHAR,
	masteraccount__c                                     VARCHAR,
	masteraccountid__c                                   VARCHAR,
	masterrecordid                                       VARCHAR,
	media_contact_territory__pc                          VARCHAR,
	most_recent_addendum_request__c                      VARCHAR,
	most_recent_addendum_status__c                       VARCHAR,
	most_recent_booking__c                               TIMESTAMP,
	most_recent_chain_addendum_status__c                 VARCHAR,
	most_recent_close_date__c                            DATE,
	most_recent_commission__c                            DOUBLE PRECISION,
	most_recent_contract_effective_date__c               DATE,
	most_recent_contract_effective_date_ro__c            VARCHAR,
	most_recent_contract_effective_date_uk__c            VARCHAR,
	most_recent_cw_close_date__c                         DATE,
	most_recent_deal_end_date__c                         DATE,
	most_recent_finance_edit_datetime__c                 TIMESTAMP,
	most_recent_group_chain_addendum_request__c          VARCHAR,
	most_recent_ihp_addendum_request__c                  VARCHAR,
	most_recent_ihp_addendum_status__c                   VARCHAR,
	most_recent_ihp_contract_signed_date__c              DATE,
	most_recent_margin__c                                DOUBLE PRECISION,
	most_recent_master_contract_signed_date__c           DATE,
	most_recent_opp__c                                   VARCHAR,
	most_recent_package_destination__c                   VARCHAR,
	most_recent_pd_proposed_start_date__c                DATE,
	most_recent_proposed_start_date__c                   DATE,
	most_recent_proposed_start_date__pc                  DATE,
	most_recent_sale_id__c                               VARCHAR,
	most_recent_successful_deal__c                       DATE,
	most_recent_successful_sync__c                       TIMESTAMP,
	most_recent_sync_datetime__c                         TIMESTAMP,
	most_recent_sync_outcome__c                          VARCHAR,
	most_recent_ta_check__c                              DATE,
	name                                                 VARCHAR,
	nearest_airport_code__c                              VARCHAR,
	need_periods__c                                      VARCHAR,
	new_business_challenge__c                            BOOLEAN,
	next_proposed_start_date__c                          DATE,
	no_gdpr_clause_signed_approved_by_sd__c              BOOLEAN,
	notes__pc                                            VARCHAR,
	notes_on_working_with_se__c                          VARCHAR,
	ns_category__c                                       VARCHAR,
	ns_category_customer__c                              VARCHAR,
	ns_contract_type__c                                  VARCHAR,
	ns_update_bank_details__c                            BOOLEAN,
	nscrm__balance__c                                    DOUBLE PRECISION,
	nscrm__credit_hold__c                                BOOLEAN,
	nscrm__credit_limit__c                               DOUBLE PRECISION,
	nscrm__days_overdue__c                               DOUBLE PRECISION,
	nscrm__ns_credit_term_id__c                          VARCHAR,
	nscrm__ns_customer_category_id__c                    VARCHAR,
	nscrm__ns_internal_id__c                             VARCHAR,
	nscrm__ns_internal_id__pc                            VARCHAR,
	nscrm__ns_sales_rep_id__c                            VARCHAR,
	nscrm__ns_shipping_item_id__c                        VARCHAR,
	nscrm__ns_subsidiary_id__c                           VARCHAR,
	nscrm__ns_tax_item_id__c                             VARCHAR,
	nscrm__overdue_balance__c                            DOUBLE PRECISION,
	nscrm__subsidiary__c                                 VARCHAR,
	nscrm__taxable__c                                    BOOLEAN,
	number_of_active_addendums__c                        DOUBLE PRECISION,
	number_of_addendums__c                               DOUBLE PRECISION,
	number_of_bookings__c                                DOUBLE PRECISION,
	number_of_floors__c                                  DOUBLE PRECISION,
	number_of_opps__c                                    DOUBLE PRECISION,
	number_of_personal_injuries__c                       DOUBLE PRECISION,
	number_of_rooms__c                                   DOUBLE PRECISION,
	numberofemployees                                    INT,
	open_opps__pc                                        DOUBLE PRECISION,
	opportunity_listing_fee__c                           DOUBLE PRECISION,
	opportunity_to_pull_offers_from__c                   VARCHAR,
	opted_in_for_always_on__c                            VARCHAR,
	opted_in_for_refundable_deals__c                     VARCHAR,
	opted_in_for_suvc__c                                 VARCHAR,
	original_contractor__c                               VARCHAR,
	overduebalance_netsuite__c                           DOUBLE PRECISION,
	ownerid                                              VARCHAR,
	package_bank_country_selection__c                    VARCHAR,
	parent_customer_ns_id__c                             VARCHAR,
	parent_ns_id__c                                      VARCHAR,
	parent_vendor_ns_id__c                               VARCHAR,
	parentid                                             VARCHAR,
	partner_membership__c                                VARCHAR,
	partner_product__c                                   VARCHAR,
	partner_region__c                                    VARCHAR,
	partner_stage__c                                     VARCHAR,
	payment_ns_id__c                                     VARCHAR,
	payment_process__c                                   VARCHAR,
	payment_process_ns_id__c                             VARCHAR,
	payment_terms_contracts__c                           VARCHAR,
	payment_terms_days__c                                VARCHAR,
	payment_terms_days_in_house_packages__c              VARCHAR,
	payment_terms_days_ns_id__c                          VARCHAR,
	person_account_email_address__c                      VARCHAR,
	person_account_status__c                             VARCHAR,
	person_account_subscription_staatus__c               VARCHAR,
	person_account_territory__c                          VARCHAR,
	person_address_city__c                               VARCHAR,
	person_address_country__c                            VARCHAR,
	person_address_line_1__c                             VARCHAR,
	person_address_line_2__c                             VARCHAR,
	person_address_post_code__c                          VARCHAR,
	person_referred_by__c                                VARCHAR,
	personassistantname                                  VARCHAR,
	personassistantphone                                 VARCHAR,
	personbirthdate                                      DATE,
	personcontactid                                      VARCHAR,
	persondepartment                                     VARCHAR,
	personemail                                          VARCHAR,
	personemailbounceddate                               TIMESTAMP,
	personemailbouncedreason                             VARCHAR,
	personhasoptedoutofemail                             BOOLEAN,
	personhomephone                                      VARCHAR,
	personlastcurequestdate                              TIMESTAMP,
	personlastcuupdatedate                               TIMESTAMP,
	personleadsource                                     VARCHAR,
	personmailingcity                                    VARCHAR,
	personmailingcountry                                 VARCHAR,
	personmailingcountrycode                             VARCHAR,
	personmailinggeocodeaccuracy                         VARCHAR,
	personmailinglatitude                                DOUBLE PRECISION,
	personmailinglongitude                               DOUBLE PRECISION,
	personmailingpostalcode                              VARCHAR,
	personmailingstate                                   VARCHAR,
	personmailingstatecode                               VARCHAR,
	personmailingstreet                                  VARCHAR,
	personmobilephone                                    VARCHAR,
	personothercity                                      VARCHAR,
	personothercountry                                   VARCHAR,
	personothercountrycode                               VARCHAR,
	personothergeocodeaccuracy                           VARCHAR,
	personotherlatitude                                  DOUBLE PRECISION,
	personotherlongitude                                 DOUBLE PRECISION,
	personotherphone                                     VARCHAR,
	personotherpostalcode                                VARCHAR,
	personotherstate                                     VARCHAR,
	personotherstatecode                                 VARCHAR,
	personotherstreet                                    VARCHAR,
	persontitle                                          VARCHAR,
	phone                                                VARCHAR,
	photourl                                             VARCHAR,
	posu_cluster__c                                      VARCHAR,
	postandcommentprocessed__c                           BOOLEAN,
	pre_qualification_status__c                          VARCHAR,
	pre_qualification_dach__c                            VARCHAR,
	pre_qualification_row__c                             VARCHAR,
	pre_qualification_uk__c                              VARCHAR,
	previous_account_name__c                             VARCHAR,
	price_check_url__c                                   VARCHAR,
	primary__pc                                          BOOLEAN,
	primary_contact__c                                   VARCHAR,
	primary_contact_email__c                             VARCHAR,
	primary_contact_job_title__c                         VARCHAR,
	primary_contact_phone__c                             VARCHAR,
	primary_contact_to_confirm_preview_link__c           VARCHAR,
	printtransactions_netsuite__c                        BOOLEAN,
	property_id__c                                       VARCHAR,
	public_liability_insurance__c                        BOOLEAN,
	public_liability_insurance_confirmed__c              BOOLEAN,
	public_liability_insurance_expiry__c                 DATE,
	qc_account_name__c                                   DOUBLE PRECISION,
	qc_contact_email__c                                  DOUBLE PRECISION,
	qc_contact_job_role__c                               DOUBLE PRECISION,
	qc_contact_name__c                                   DOUBLE PRECISION,
	qc_contact_phone__c                                  DOUBLE PRECISION,
	qc_destination__c                                    DOUBLE PRECISION,
	qc_rating_t_a__c                                     DOUBLE PRECISION,
	qc_region__c                                         DOUBLE PRECISION,
	qc_rooms__c                                          DOUBLE PRECISION,
	qc_shipping_address__c                               DOUBLE PRECISION,
	qc_star_rating__c                                    DOUBLE PRECISION,
	qc_sub_region__c                                     DOUBLE PRECISION,
	qc_tripadvisor_link__c                               DOUBLE PRECISION,
	qc_tripadvisor_rating__c                             DOUBLE PRECISION,
	qc_website__c                                        DOUBLE PRECISION,
	rate_query_end_date__c                               DATE,
	rate_query_start_date__c                             DATE,
	rating                                               VARCHAR,
	rating_booking_com__c                                VARCHAR,
	rating_ta__c                                         DOUBLE PRECISION,
	reason_for_omission__c                               VARCHAR,
	record_count__c                                      DOUBLE PRECISION,
	recordstocheck__c                                    BOOLEAN,
	recordtypeid                                         VARCHAR,
	recovered_amount__c                                  DOUBLE PRECISION,
	recoveries_next_steps_or_issues__c                   VARCHAR,
	recoveries_owner__c                                  VARCHAR,
	recoveries_payment_method__c                         VARCHAR,
	recoveries_status__c                                 VARCHAR,
	recovery_date__c                                     DATE,
	red_flag__c                                          BOOLEAN,
	red_flag__pc                                         BOOLEAN,
	red_flag_date_time__c                                TIMESTAMP,
	red_flag_reason__c                                   VARCHAR,
	red_flag_tp__c                                       BOOLEAN,
	red_flagged_by__c                                    VARCHAR,
	region__c                                            VARCHAR,
	region_type__c                                       VARCHAR,
	remove_red_flag__c                                   BOOLEAN,
	salutation                                           VARCHAR,
	saq_contact__c                                       VARCHAR,
	saq_created__c                                       BOOLEAN,
	saq_form_link__c                                     VARCHAR,
	saq_management_approval_needed__c                    BOOLEAN,
	saq_passed_date__c                                   DATE,
	saq_sent_date__c                                     DATE,
	saq_signed_date__c                                   DATE,
	saq_status__c                                        VARCHAR,
	shippingcity                                         VARCHAR,
	shippingcountry                                      VARCHAR,
	shippingcountrycode                                  VARCHAR,
	shippinggeocodeaccuracy                              VARCHAR,
	shippinglatitude                                     DOUBLE PRECISION,
	shippinglongitude                                    DOUBLE PRECISION,
	shippingpostalcode                                   VARCHAR,
	shippingstate                                        VARCHAR,
	shippingstatecode                                    VARCHAR,
	shippingstreet                                       VARCHAR,
	sicdesc                                              VARCHAR,
	stage_netsuite__c                                    VARCHAR,
	star_rating__c                                       VARCHAR,
	star_rating__pc                                      VARCHAR,
	sub_affiliate_brand__c                               VARCHAR,
	sub_region__c                                        VARCHAR,
	subsidiaries__c                                      VARCHAR,
	sum_of_margin__c                                     DOUBLE PRECISION,
	sum_of_visits__c                                     DOUBLE PRECISION,
	swift__c                                             VARCHAR,
	swift_in_house_packages__c                           VARCHAR,
	swift_travelist__c                                   VARCHAR,
	swift_validation__c                                  VARCHAR,
	swift_validation_row__c                              VARCHAR,
	swift_value_netsuite__c                              VARCHAR,
	synxis_id__c                                         VARCHAR,
	systemmodstamp                                       TIMESTAMP,
	target_account_list__c                               VARCHAR,
	tax_item__c                                          VARCHAR,
	taxable_netsuite__c                                  BOOLEAN,
	taxexempt_netsuite__c                                BOOLEAN,
	telephone_ins_prov__c                                VARCHAR,
	telephone_sales_commission__c                        DOUBLE PRECISION,
	temp_contact_checkbox__pc                            BOOLEAN,
	third_party_notes__c                                 VARCHAR,
	third_party_opt_in__c                                VARCHAR,
	third_party_payment_notes__c                         VARCHAR,
	third_party_provider__c                              VARCHAR,
	today__c                                             VARCHAR,
	today_number__c                                      DATE,
	today_text__c                                        VARCHAR,
	total_credit_cashed__c                               DOUBLE PRECISION,
	total_member_spend__c                                DOUBLE PRECISION,
	total_reviews_ta__c                                  DOUBLE PRECISION,
	travelbird_id__c                                     VARCHAR,
	travelist_active__c                                  BOOLEAN,
	trimmed_hotel_name_contracts__c                      VARCHAR,
	tripadvisor_link__c                                  VARCHAR,
	tripadvisor_rating__c                                DOUBLE PRECISION,
	trivago_link__c                                      VARCHAR,
	tvl_company_signed_date__c                           DATE,
	tvl_old_contract_version__c                          VARCHAR,
	type                                                 VARCHAR,
	type_ebd__c                                          DOUBLE PRECISION,
	type_of_third_party__c                               VARCHAR,
	uk_contact_status__c                                 VARCHAR,
	uk_opportunity_status__c                             VARCHAR,
	update_customer_ns__c                                BOOLEAN,
	update_vendor_ns__c                                  BOOLEAN,
	user_who_experienced_error__c                        VARCHAR,
	vat_number__c                                        VARCHAR,
	vat_number_id_ns__c                                  VARCHAR,
	vat_number_in_house_packages__c                      VARCHAR,
	vat_number_travelist__c                              VARCHAR,
	vat_number_validation__c                             VARCHAR,
	vat_number_validation_row__c                         VARCHAR,
	vatregnumber_netsuite__c                             VARCHAR,
	vcc_netsuite__c                                      DOUBLE PRECISION,
	vendor_customer_sync_readiness__c                    VARCHAR,
	vendor_id_netsuite__c                                VARCHAR,
	vendor_insert_ns__c                                  BOOLEAN,
	version_8_contract_approval_way__c                   VARCHAR,
	virtual_credit_card__c                               VARCHAR,
	virtual_credit_card_in_house_packages__c             VARCHAR,
	virtual_credit_card_ns_id__c                         VARCHAR,
	voucher_opt_in__c                                    VARCHAR,
	web_phone__pc                                        VARCHAR,
	website                                              VARCHAR,
	website_sales_commission__c                          DOUBLE PRECISION,
	weekly_opt_in__c                                     VARCHAR,
	wheelchair_accessible__c                             VARCHAR,
	zero_deposit__c                                      BOOLEAN,
	zoho_account_id__c                                   VARCHAR,
	zoho_contact_id__pc                                  VARCHAR,

	-- validation columns
	failed_some_validation                               INT,
	fails_validation__id__expected_nonnull               INT,
	fails_validation__lastmodifieddate__expected_nonnull INT
)
;

INSERT INTO hygiene_vault.sfsc.account_m_z (schedule_tstamp,
											run_tstamp,
											operation_id,
											created_at,
											updated_at,
											row_dataset_name,
											row_dataset_source,
											row_loaded_at,
											row_schedule_tstamp,
											row_run_tstamp,
											row_filename,
											row_file_row_number,
											row_extract_metadata,
											id,
											lastmodifieddate,
											manual__c,
											marketing_addendum__c,
											marketing_id__c,
											master_contract_field_updated_by__c,
											master_contract_signed__c,
											master_contract_signed_group__c,
											master_contract_wf__c,
											master_group_field_updated_by__c,
											masteraccount__c,
											masteraccountid__c,
											masterrecordid,
											media_contact_territory__pc,
											most_recent_addendum_request__c,
											most_recent_addendum_status__c,
											most_recent_booking__c,
											most_recent_chain_addendum_status__c,
											most_recent_close_date__c,
											most_recent_commission__c,
											most_recent_contract_effective_date__c,
											most_recent_contract_effective_date_ro__c,
											most_recent_contract_effective_date_uk__c,
											most_recent_cw_close_date__c,
											most_recent_deal_end_date__c,
											most_recent_finance_edit_datetime__c,
											most_recent_group_chain_addendum_request__c,
											most_recent_ihp_addendum_request__c,
											most_recent_ihp_addendum_status__c,
											most_recent_ihp_contract_signed_date__c,
											most_recent_margin__c,
											most_recent_master_contract_signed_date__c,
											most_recent_opp__c,
											most_recent_package_destination__c,
											most_recent_pd_proposed_start_date__c,
											most_recent_proposed_start_date__c,
											most_recent_proposed_start_date__pc,
											most_recent_sale_id__c,
											most_recent_successful_deal__c,
											most_recent_successful_sync__c,
											most_recent_sync_datetime__c,
											most_recent_sync_outcome__c,
											most_recent_ta_check__c,
											name,
											nearest_airport_code__c,
											need_periods__c,
											new_business_challenge__c,
											next_proposed_start_date__c,
											no_gdpr_clause_signed_approved_by_sd__c,
											notes__pc,
											notes_on_working_with_se__c,
											ns_category__c,
											ns_category_customer__c,
											ns_contract_type__c,
											ns_update_bank_details__c,
											nscrm__balance__c,
											nscrm__credit_hold__c,
											nscrm__credit_limit__c,
											nscrm__days_overdue__c,
											nscrm__ns_credit_term_id__c,
											nscrm__ns_customer_category_id__c,
											nscrm__ns_internal_id__c,
											nscrm__ns_internal_id__pc,
											nscrm__ns_sales_rep_id__c,
											nscrm__ns_shipping_item_id__c,
											nscrm__ns_subsidiary_id__c,
											nscrm__ns_tax_item_id__c,
											nscrm__overdue_balance__c,
											nscrm__subsidiary__c,
											nscrm__taxable__c,
											number_of_active_addendums__c,
											number_of_addendums__c,
											number_of_bookings__c,
											number_of_floors__c,
											number_of_opps__c,
											number_of_personal_injuries__c,
											number_of_rooms__c,
											numberofemployees,
											open_opps__pc,
											opportunity_listing_fee__c,
											opportunity_to_pull_offers_from__c,
											opted_in_for_always_on__c,
											opted_in_for_refundable_deals__c,
											opted_in_for_suvc__c,
											original_contractor__c,
											overduebalance_netsuite__c,
											ownerid,
											package_bank_country_selection__c,
											parent_customer_ns_id__c,
											parent_ns_id__c,
											parent_vendor_ns_id__c,
											parentid,
											partner_membership__c,
											partner_product__c,
											partner_region__c,
											partner_stage__c,
											payment_ns_id__c,
											payment_process__c,
											payment_process_ns_id__c,
											payment_terms_contracts__c,
											payment_terms_days__c,
											payment_terms_days_in_house_packages__c,
											payment_terms_days_ns_id__c,
											person_account_email_address__c,
											person_account_status__c,
											person_account_subscription_staatus__c,
											person_account_territory__c,
											person_address_city__c,
											person_address_country__c,
											person_address_line_1__c,
											person_address_line_2__c,
											person_address_post_code__c,
											person_referred_by__c,
											personassistantname,
											personassistantphone,
											personbirthdate,
											personcontactid,
											persondepartment,
											personemail,
											personemailbounceddate,
											personemailbouncedreason,
											personhasoptedoutofemail,
											personhomephone,
											personlastcurequestdate,
											personlastcuupdatedate,
											personleadsource,
											personmailingcity,
											personmailingcountry,
											personmailingcountrycode,
											personmailinggeocodeaccuracy,
											personmailinglatitude,
											personmailinglongitude,
											personmailingpostalcode,
											personmailingstate,
											personmailingstatecode,
											personmailingstreet,
											personmobilephone,
											personothercity,
											personothercountry,
											personothercountrycode,
											personothergeocodeaccuracy,
											personotherlatitude,
											personotherlongitude,
											personotherphone,
											personotherpostalcode,
											personotherstate,
											personotherstatecode,
											personotherstreet,
											persontitle,
											phone,
											photourl,
											posu_cluster__c,
											postandcommentprocessed__c,
											pre_qualification_status__c,
											pre_qualification_dach__c,
											pre_qualification_row__c,
											pre_qualification_uk__c,
											previous_account_name__c,
											price_check_url__c,
											primary__pc,
											primary_contact__c,
											primary_contact_email__c,
											primary_contact_job_title__c,
											primary_contact_phone__c,
											primary_contact_to_confirm_preview_link__c,
											printtransactions_netsuite__c,
											property_id__c,
											public_liability_insurance__c,
											public_liability_insurance_confirmed__c,
											public_liability_insurance_expiry__c,
											qc_account_name__c,
											qc_contact_email__c,
											qc_contact_job_role__c,
											qc_contact_name__c,
											qc_contact_phone__c,
											qc_destination__c,
											qc_rating_t_a__c,
											qc_region__c,
											qc_rooms__c,
											qc_shipping_address__c,
											qc_star_rating__c,
											qc_sub_region__c,
											qc_tripadvisor_link__c,
											qc_tripadvisor_rating__c,
											qc_website__c,
											rate_query_end_date__c,
											rate_query_start_date__c,
											rating,
											rating_booking_com__c,
											rating_ta__c,
											reason_for_omission__c,
											record_count__c,
											recordstocheck__c,
											recordtypeid,
											recovered_amount__c,
											recoveries_next_steps_or_issues__c,
											recoveries_owner__c,
											recoveries_payment_method__c,
											recoveries_status__c,
											recovery_date__c,
											red_flag__c,
											red_flag__pc,
											red_flag_date_time__c,
											red_flag_reason__c,
											red_flag_tp__c,
											red_flagged_by__c,
											region__c,
											region_type__c,
											remove_red_flag__c,
											salutation,
											saq_contact__c,
											saq_created__c,
											saq_form_link__c,
											saq_management_approval_needed__c,
											saq_passed_date__c,
											saq_sent_date__c,
											saq_signed_date__c,
											saq_status__c,
											shippingcity,
											shippingcountry,
											shippingcountrycode,
											shippinggeocodeaccuracy,
											shippinglatitude,
											shippinglongitude,
											shippingpostalcode,
											shippingstate,
											shippingstatecode,
											shippingstreet,
											sicdesc,
											stage_netsuite__c,
											star_rating__c,
											star_rating__pc,
											sub_affiliate_brand__c,
											sub_region__c,
											subsidiaries__c,
											sum_of_margin__c,
											sum_of_visits__c,
											swift__c,
											swift_in_house_packages__c,
											swift_travelist__c,
											swift_validation__c,
											swift_validation_row__c,
											swift_value_netsuite__c,
											synxis_id__c,
											systemmodstamp,
											target_account_list__c,
											tax_item__c,
											taxable_netsuite__c,
											taxexempt_netsuite__c,
											telephone_ins_prov__c,
											telephone_sales_commission__c,
											temp_contact_checkbox__pc,
											third_party_notes__c,
											third_party_opt_in__c,
											third_party_payment_notes__c,
											third_party_provider__c,
											today__c,
											today_number__c,
											today_text__c,
											total_credit_cashed__c,
											total_member_spend__c,
											total_reviews_ta__c,
											travelbird_id__c,
											travelist_active__c,
											trimmed_hotel_name_contracts__c,
											tripadvisor_link__c,
											tripadvisor_rating__c,
											trivago_link__c,
											tvl_company_signed_date__c,
											tvl_old_contract_version__c,
											type,
											type_ebd__c,
											type_of_third_party__c,
											uk_contact_status__c,
											uk_opportunity_status__c,
											update_customer_ns__c,
											update_vendor_ns__c,
											user_who_experienced_error__c,
											vat_number__c,
											vat_number_id_ns__c,
											vat_number_in_house_packages__c,
											vat_number_travelist__c,
											vat_number_validation__c,
											vat_number_validation_row__c,
											vatregnumber_netsuite__c,
											vcc_netsuite__c,
											vendor_customer_sync_readiness__c,
											vendor_id_netsuite__c,
											vendor_insert_ns__c,
											version_8_contract_approval_way__c,
											virtual_credit_card__c,
											virtual_credit_card_in_house_packages__c,
											virtual_credit_card_ns_id__c,
											voucher_opt_in__c,
											web_phone__pc,
											website,
											website_sales_commission__c,
											weekly_opt_in__c,
											wheelchair_accessible__c,
											zero_deposit__c,
											zoho_account_id__c,
											zoho_contact_id__pc,
											failed_some_validation,
											fails_validation__id__expected_nonnull,
											fails_validation__lastmodifieddate__expected_nonnull)
SELECT
	schedule_tstamp,
	run_tstamp,
	operation_id,
	created_at,
	updated_at,
	row_dataset_name,
	row_dataset_source,
	row_loaded_at,
	row_schedule_tstamp,
	row_run_tstamp,
	row_filename,
	row_file_row_number,
	row_extract_metadata,
	id,
	lastmodifieddate,
	manual__c,
	marketing_addendum__c,
	marketing_id__c,
	master_contract_field_updated_by__c,
	master_contract_signed__c,
	master_contract_signed_group__c,
	master_contract_wf__c,
	master_group_field_updated_by__c,
	masteraccount__c,
	masteraccountid__c,
	masterrecordid,
	media_contact_territory__pc,
	most_recent_addendum_request__c,
	most_recent_addendum_status__c,
	most_recent_booking__c,
	most_recent_chain_addendum_status__c,
	most_recent_close_date__c,
	most_recent_commission__c,
	most_recent_contract_effective_date__c,
	most_recent_contract_effective_date_ro__c,
	most_recent_contract_effective_date_uk__c,
	most_recent_cw_close_date__c,
	most_recent_deal_end_date__c,
	most_recent_finance_edit_datetime__c,
	most_recent_group_chain_addendum_request__c,
	most_recent_ihp_addendum_request__c,
	most_recent_ihp_addendum_status__c,
	most_recent_ihp_contract_signed_date__c,
	most_recent_margin__c,
	most_recent_master_contract_signed_date__c,
	most_recent_opp__c,
	most_recent_package_destination__c,
	most_recent_pd_proposed_start_date__c,
	most_recent_proposed_start_date__c,
	most_recent_proposed_start_date__pc,
	most_recent_sale_id__c,
	most_recent_successful_deal__c,
	most_recent_successful_sync__c,
	most_recent_sync_datetime__c,
	most_recent_sync_outcome__c,
	most_recent_ta_check__c,
	name,
	nearest_airport_code__c,
	need_periods__c,
	new_business_challenge__c,
	next_proposed_start_date__c,
	no_gdpr_clause_signed_approved_by_sd__c,
	notes__pc,
	notes_on_working_with_se__c,
	ns_category__c,
	ns_category_customer__c,
	ns_contract_type__c,
	ns_update_bank_details__c,
	nscrm__balance__c,
	nscrm__credit_hold__c,
	nscrm__credit_limit__c,
	nscrm__days_overdue__c,
	nscrm__ns_credit_term_id__c,
	nscrm__ns_customer_category_id__c,
	nscrm__ns_internal_id__c,
	nscrm__ns_internal_id__pc,
	nscrm__ns_sales_rep_id__c,
	nscrm__ns_shipping_item_id__c,
	nscrm__ns_subsidiary_id__c,
	nscrm__ns_tax_item_id__c,
	nscrm__overdue_balance__c,
	nscrm__subsidiary__c,
	nscrm__taxable__c,
	number_of_active_addendums__c,
	number_of_addendums__c,
	number_of_bookings__c,
	number_of_floors__c,
	number_of_opps__c,
	number_of_personal_injuries__c,
	number_of_rooms__c,
	numberofemployees,
	open_opps__pc,
	opportunity_listing_fee__c,
	opportunity_to_pull_offers_from__c,
	opted_in_for_always_on__c,
	opted_in_for_refundable_deals__c,
	opted_in_for_suvc__c,
	original_contractor__c,
	overduebalance_netsuite__c,
	ownerid,
	package_bank_country_selection__c,
	parent_customer_ns_id__c,
	parent_ns_id__c,
	parent_vendor_ns_id__c,
	parentid,
	partner_membership__c,
	partner_product__c,
	partner_region__c,
	partner_stage__c,
	payment_ns_id__c,
	payment_process__c,
	payment_process_ns_id__c,
	payment_terms_contracts__c,
	payment_terms_days__c,
	payment_terms_days_in_house_packages__c,
	payment_terms_days_ns_id__c,
	person_account_email_address__c,
	person_account_status__c,
	person_account_subscription_staatus__c,
	person_account_territory__c,
	person_address_city__c,
	person_address_country__c,
	person_address_line_1__c,
	person_address_line_2__c,
	person_address_post_code__c,
	person_referred_by__c,
	personassistantname,
	personassistantphone,
	personbirthdate,
	personcontactid,
	persondepartment,
	personemail,
	personemailbounceddate,
	personemailbouncedreason,
	personhasoptedoutofemail,
	personhomephone,
	personlastcurequestdate,
	personlastcuupdatedate,
	personleadsource,
	personmailingcity,
	personmailingcountry,
	personmailingcountrycode,
	personmailinggeocodeaccuracy,
	personmailinglatitude,
	personmailinglongitude,
	personmailingpostalcode,
	personmailingstate,
	personmailingstatecode,
	personmailingstreet,
	personmobilephone,
	personothercity,
	personothercountry,
	personothercountrycode,
	personothergeocodeaccuracy,
	personotherlatitude,
	personotherlongitude,
	personotherphone,
	personotherpostalcode,
	personotherstate,
	personotherstatecode,
	personotherstreet,
	persontitle,
	phone,
	photourl,
	posu_cluster__c,
	postandcommentprocessed__c,
	pre_qualification_status__c,
	NULL,
	NULL,
	NULL,
	previous_account_name__c,
	price_check_url__c,
	primary__pc,
	primary_contact__c,
	primary_contact_email__c,
	primary_contact_job_title__c,
	primary_contact_phone__c,
	primary_contact_to_confirm_preview_link__c,
	printtransactions_netsuite__c,
	property_id__c,
	public_liability_insurance__c,
	public_liability_insurance_confirmed__c,
	public_liability_insurance_expiry__c,
	qc_account_name__c,
	qc_contact_email__c,
	qc_contact_job_role__c,
	qc_contact_name__c,
	qc_contact_phone__c,
	qc_destination__c,
	qc_rating_t_a__c,
	qc_region__c,
	qc_rooms__c,
	qc_shipping_address__c,
	qc_star_rating__c,
	qc_sub_region__c,
	qc_tripadvisor_link__c,
	qc_tripadvisor_rating__c,
	qc_website__c,
	rate_query_end_date__c,
	rate_query_start_date__c,
	rating,
	rating_booking_com__c,
	rating_ta__c,
	reason_for_omission__c,
	record_count__c,
	recordstocheck__c,
	recordtypeid,
	recovered_amount__c,
	recoveries_next_steps_or_issues__c,
	recoveries_owner__c,
	recoveries_payment_method__c,
	recoveries_status__c,
	recovery_date__c,
	red_flag__c,
	red_flag__pc,
	red_flag_date_time__c,
	red_flag_reason__c,
	red_flag_tp__c,
	red_flagged_by__c,
	region__c,
	region_type__c,
	remove_red_flag__c,
	salutation,
	saq_contact__c,
	saq_created__c,
	saq_form_link__c,
	saq_management_approval_needed__c,
	saq_passed_date__c,
	saq_sent_date__c,
	saq_signed_date__c,
	saq_status__c,
	shippingcity,
	shippingcountry,
	shippingcountrycode,
	shippinggeocodeaccuracy,
	shippinglatitude,
	shippinglongitude,
	shippingpostalcode,
	shippingstate,
	shippingstatecode,
	shippingstreet,
	sicdesc,
	stage_netsuite__c,
	star_rating__c,
	star_rating__pc,
	sub_affiliate_brand__c,
	sub_region__c,
	subsidiaries__c,
	sum_of_margin__c,
	sum_of_visits__c,
	swift__c,
	swift_in_house_packages__c,
	swift_travelist__c,
	swift_validation__c,
	swift_validation_row__c,
	swift_value_netsuite__c,
	synxis_id__c,
	systemmodstamp,
	target_account_list__c,
	tax_item__c,
	taxable_netsuite__c,
	taxexempt_netsuite__c,
	telephone_ins_prov__c,
	telephone_sales_commission__c,
	temp_contact_checkbox__pc,
	third_party_notes__c,
	third_party_opt_in__c,
	third_party_payment_notes__c,
	third_party_provider__c,
	today__c,
	today_number__c,
	today_text__c,
	total_credit_cashed__c,
	total_member_spend__c,
	total_reviews_ta__c,
	travelbird_id__c,
	travelist_active__c,
	trimmed_hotel_name_contracts__c,
	tripadvisor_link__c,
	tripadvisor_rating__c,
	trivago_link__c,
	tvl_company_signed_date__c,
	tvl_old_contract_version__c,
	type,
	type_ebd__c,
	type_of_third_party__c,
	uk_contact_status__c,
	uk_opportunity_status__c,
	update_customer_ns__c,
	update_vendor_ns__c,
	user_who_experienced_error__c,
	vat_number__c,
	vat_number_id_ns__c,
	vat_number_in_house_packages__c,
	vat_number_travelist__c,
	vat_number_validation__c,
	vat_number_validation_row__c,
	vatregnumber_netsuite__c,
	vcc_netsuite__c,
	vendor_customer_sync_readiness__c,
	vendor_id_netsuite__c,
	vendor_insert_ns__c,
	version_8_contract_approval_way__c,
	virtual_credit_card__c,
	virtual_credit_card_in_house_packages__c,
	virtual_credit_card_ns_id__c,
	voucher_opt_in__c,
	web_phone__pc,
	website,
	website_sales_commission__c,
	weekly_opt_in__c,
	wheelchair_accessible__c,
	zero_deposit__c,
	zoho_account_id__c,
	zoho_contact_id__pc,
	failed_some_validation,
	fails_validation__id__expected_nonnull,
	fails_validation__lastmodifieddate__expected_nonnull

FROM hygiene_vault.sfsc.account_m_z_20250918
;

CREATE OR REPLACE TABLE latest_vault.sfsc.account_m_z
(
	-- (lineage) metadata for the current job
	schedule_tstamp                             TIMESTAMP NOT NULL,
	run_tstamp                                  TIMESTAMP NOT NULL,
	operation_id                                VARCHAR   NOT NULL,
	created_at                                  TIMESTAMP NOT NULL,
	updated_at                                  TIMESTAMP NOT NULL,

	-- (lineage) original metadata of row itself
	row_dataset_name                            VARCHAR   NOT NULL,
	row_dataset_source                          VARCHAR   NOT NULL,
	row_loaded_at                               TIMESTAMP NOT NULL,
	row_schedule_tstamp                         TIMESTAMP NOT NULL,
	row_run_tstamp                              TIMESTAMP NOT NULL,
	row_filename                                VARCHAR   NOT NULL,
	row_file_row_number                         INT       NOT NULL,
	row_extract_metadata                        VARIANT,

	-- transformed columns


	-- original columns
	id                                          VARCHAR,
	lastmodifieddate                            TIMESTAMP,
	manual__c                                   BOOLEAN,
	marketing_addendum__c                       BOOLEAN,
	marketing_id__c                             VARCHAR,
	master_contract_field_updated_by__c         VARCHAR,
	master_contract_signed__c                   BOOLEAN,
	master_contract_signed_group__c             BOOLEAN,
	master_contract_wf__c                       BOOLEAN,
	master_group_field_updated_by__c            VARCHAR,
	masteraccount__c                            VARCHAR,
	masteraccountid__c                          VARCHAR,
	masterrecordid                              VARCHAR,
	media_contact_territory__pc                 VARCHAR,
	most_recent_addendum_request__c             VARCHAR,
	most_recent_addendum_status__c              VARCHAR,
	most_recent_booking__c                      TIMESTAMP,
	most_recent_chain_addendum_status__c        VARCHAR,
	most_recent_close_date__c                   DATE,
	most_recent_commission__c                   DOUBLE PRECISION,
	most_recent_contract_effective_date__c      DATE,
	most_recent_contract_effective_date_ro__c   VARCHAR,
	most_recent_contract_effective_date_uk__c   VARCHAR,
	most_recent_cw_close_date__c                DATE,
	most_recent_deal_end_date__c                DATE,
	most_recent_finance_edit_datetime__c        TIMESTAMP,
	most_recent_group_chain_addendum_request__c VARCHAR,
	most_recent_ihp_addendum_request__c         VARCHAR,
	most_recent_ihp_addendum_status__c          VARCHAR,
	most_recent_ihp_contract_signed_date__c     DATE,
	most_recent_margin__c                       DOUBLE PRECISION,
	most_recent_master_contract_signed_date__c  DATE,
	most_recent_opp__c                          VARCHAR,
	most_recent_package_destination__c          VARCHAR,
	most_recent_pd_proposed_start_date__c       DATE,
	most_recent_proposed_start_date__c          DATE,
	most_recent_proposed_start_date__pc         DATE,
	most_recent_sale_id__c                      VARCHAR,
	most_recent_successful_deal__c              DATE,
	most_recent_successful_sync__c              TIMESTAMP,
	most_recent_sync_datetime__c                TIMESTAMP,
	most_recent_sync_outcome__c                 VARCHAR,
	most_recent_ta_check__c                     DATE,
	name                                        VARCHAR,
	nearest_airport_code__c                     VARCHAR,
	need_periods__c                             VARCHAR,
	new_business_challenge__c                   BOOLEAN,
	next_proposed_start_date__c                 DATE,
	no_gdpr_clause_signed_approved_by_sd__c     BOOLEAN,
	notes__pc                                   VARCHAR,
	notes_on_working_with_se__c                 VARCHAR,
	ns_category__c                              VARCHAR,
	ns_category_customer__c                     VARCHAR,
	ns_contract_type__c                         VARCHAR,
	ns_update_bank_details__c                   BOOLEAN,
	nscrm__balance__c                           DOUBLE PRECISION,
	nscrm__credit_hold__c                       BOOLEAN,
	nscrm__credit_limit__c                      DOUBLE PRECISION,
	nscrm__days_overdue__c                      DOUBLE PRECISION,
	nscrm__ns_credit_term_id__c                 VARCHAR,
	nscrm__ns_customer_category_id__c           VARCHAR,
	nscrm__ns_internal_id__c                    VARCHAR,
	nscrm__ns_internal_id__pc                   VARCHAR,
	nscrm__ns_sales_rep_id__c                   VARCHAR,
	nscrm__ns_shipping_item_id__c               VARCHAR,
	nscrm__ns_subsidiary_id__c                  VARCHAR,
	nscrm__ns_tax_item_id__c                    VARCHAR,
	nscrm__overdue_balance__c                   DOUBLE PRECISION,
	nscrm__subsidiary__c                        VARCHAR,
	nscrm__taxable__c                           BOOLEAN,
	number_of_active_addendums__c               DOUBLE PRECISION,
	number_of_addendums__c                      DOUBLE PRECISION,
	number_of_bookings__c                       DOUBLE PRECISION,
	number_of_floors__c                         DOUBLE PRECISION,
	number_of_opps__c                           DOUBLE PRECISION,
	number_of_personal_injuries__c              DOUBLE PRECISION,
	number_of_rooms__c                          DOUBLE PRECISION,
	numberofemployees                           INT,
	open_opps__pc                               DOUBLE PRECISION,
	opportunity_listing_fee__c                  DOUBLE PRECISION,
	opportunity_to_pull_offers_from__c          VARCHAR,
	opted_in_for_always_on__c                   VARCHAR,
	opted_in_for_refundable_deals__c            VARCHAR,
	opted_in_for_suvc__c                        VARCHAR,
	original_contractor__c                      VARCHAR,
	overduebalance_netsuite__c                  DOUBLE PRECISION,
	ownerid                                     VARCHAR,
	package_bank_country_selection__c           VARCHAR,
	parent_customer_ns_id__c                    VARCHAR,
	parent_ns_id__c                             VARCHAR,
	parent_vendor_ns_id__c                      VARCHAR,
	parentid                                    VARCHAR,
	partner_membership__c                       VARCHAR,
	partner_product__c                          VARCHAR,
	partner_region__c                           VARCHAR,
	partner_stage__c                            VARCHAR,
	payment_ns_id__c                            VARCHAR,
	payment_process__c                          VARCHAR,
	payment_process_ns_id__c                    VARCHAR,
	payment_terms_contracts__c                  VARCHAR,
	payment_terms_days__c                       VARCHAR,
	payment_terms_days_in_house_packages__c     VARCHAR,
	payment_terms_days_ns_id__c                 VARCHAR,
	person_account_email_address__c             VARCHAR,
	person_account_status__c                    VARCHAR,
	person_account_subscription_staatus__c      VARCHAR,
	person_account_territory__c                 VARCHAR,
	person_address_city__c                      VARCHAR,
	person_address_country__c                   VARCHAR,
	person_address_line_1__c                    VARCHAR,
	person_address_line_2__c                    VARCHAR,
	person_address_post_code__c                 VARCHAR,
	person_referred_by__c                       VARCHAR,
	personassistantname                         VARCHAR,
	personassistantphone                        VARCHAR,
	personbirthdate                             DATE,
	personcontactid                             VARCHAR,
	persondepartment                            VARCHAR,
	personemail                                 VARCHAR,
	personemailbounceddate                      TIMESTAMP,
	personemailbouncedreason                    VARCHAR,
	personhasoptedoutofemail                    BOOLEAN,
	personhomephone                             VARCHAR,
	personlastcurequestdate                     TIMESTAMP,
	personlastcuupdatedate                      TIMESTAMP,
	personleadsource                            VARCHAR,
	personmailingcity                           VARCHAR,
	personmailingcountry                        VARCHAR,
	personmailingcountrycode                    VARCHAR,
	personmailinggeocodeaccuracy                VARCHAR,
	personmailinglatitude                       DOUBLE PRECISION,
	personmailinglongitude                      DOUBLE PRECISION,
	personmailingpostalcode                     VARCHAR,
	personmailingstate                          VARCHAR,
	personmailingstatecode                      VARCHAR,
	personmailingstreet                         VARCHAR,
	personmobilephone                           VARCHAR,
	personothercity                             VARCHAR,
	personothercountry                          VARCHAR,
	personothercountrycode                      VARCHAR,
	personothergeocodeaccuracy                  VARCHAR,
	personotherlatitude                         DOUBLE PRECISION,
	personotherlongitude                        DOUBLE PRECISION,
	personotherphone                            VARCHAR,
	personotherpostalcode                       VARCHAR,
	personotherstate                            VARCHAR,
	personotherstatecode                        VARCHAR,
	personotherstreet                           VARCHAR,
	persontitle                                 VARCHAR,
	phone                                       VARCHAR,
	photourl                                    VARCHAR,
	posu_cluster__c                             VARCHAR,
	postandcommentprocessed__c                  BOOLEAN,
	pre_qualification_status__c                 VARCHAR,
	pre_qualification_dach__c                   VARCHAR,
	pre_qualification_row__c                    VARCHAR,
	pre_qualification_uk__c                     VARCHAR,
	previous_account_name__c                    VARCHAR,
	price_check_url__c                          VARCHAR,
	primary__pc                                 BOOLEAN,
	primary_contact__c                          VARCHAR,
	primary_contact_email__c                    VARCHAR,
	primary_contact_job_title__c                VARCHAR,
	primary_contact_phone__c                    VARCHAR,
	primary_contact_to_confirm_preview_link__c  VARCHAR,
	printtransactions_netsuite__c               BOOLEAN,
	property_id__c                              VARCHAR,
	public_liability_insurance__c               BOOLEAN,
	public_liability_insurance_confirmed__c     BOOLEAN,
	public_liability_insurance_expiry__c        DATE,
	qc_account_name__c                          DOUBLE PRECISION,
	qc_contact_email__c                         DOUBLE PRECISION,
	qc_contact_job_role__c                      DOUBLE PRECISION,
	qc_contact_name__c                          DOUBLE PRECISION,
	qc_contact_phone__c                         DOUBLE PRECISION,
	qc_destination__c                           DOUBLE PRECISION,
	qc_rating_t_a__c                            DOUBLE PRECISION,
	qc_region__c                                DOUBLE PRECISION,
	qc_rooms__c                                 DOUBLE PRECISION,
	qc_shipping_address__c                      DOUBLE PRECISION,
	qc_star_rating__c                           DOUBLE PRECISION,
	qc_sub_region__c                            DOUBLE PRECISION,
	qc_tripadvisor_link__c                      DOUBLE PRECISION,
	qc_tripadvisor_rating__c                    DOUBLE PRECISION,
	qc_website__c                               DOUBLE PRECISION,
	rate_query_end_date__c                      DATE,
	rate_query_start_date__c                    DATE,
	rating                                      VARCHAR,
	rating_booking_com__c                       VARCHAR,
	rating_ta__c                                DOUBLE PRECISION,
	reason_for_omission__c                      VARCHAR,
	record_count__c                             DOUBLE PRECISION,
	recordstocheck__c                           BOOLEAN,
	recordtypeid                                VARCHAR,
	recovered_amount__c                         DOUBLE PRECISION,
	recoveries_next_steps_or_issues__c          VARCHAR,
	recoveries_owner__c                         VARCHAR,
	recoveries_payment_method__c                VARCHAR,
	recoveries_status__c                        VARCHAR,
	recovery_date__c                            DATE,
	red_flag__c                                 BOOLEAN,
	red_flag__pc                                BOOLEAN,
	red_flag_date_time__c                       TIMESTAMP,
	red_flag_reason__c                          VARCHAR,
	red_flag_tp__c                              BOOLEAN,
	red_flagged_by__c                           VARCHAR,
	region__c                                   VARCHAR,
	region_type__c                              VARCHAR,
	remove_red_flag__c                          BOOLEAN,
	salutation                                  VARCHAR,
	saq_contact__c                              VARCHAR,
	saq_created__c                              BOOLEAN,
	saq_form_link__c                            VARCHAR,
	saq_management_approval_needed__c           BOOLEAN,
	saq_passed_date__c                          DATE,
	saq_sent_date__c                            DATE,
	saq_signed_date__c                          DATE,
	saq_status__c                               VARCHAR,
	shippingcity                                VARCHAR,
	shippingcountry                             VARCHAR,
	shippingcountrycode                         VARCHAR,
	shippinggeocodeaccuracy                     VARCHAR,
	shippinglatitude                            DOUBLE PRECISION,
	shippinglongitude                           DOUBLE PRECISION,
	shippingpostalcode                          VARCHAR,
	shippingstate                               VARCHAR,
	shippingstatecode                           VARCHAR,
	shippingstreet                              VARCHAR,
	sicdesc                                     VARCHAR,
	stage_netsuite__c                           VARCHAR,
	star_rating__c                              VARCHAR,
	star_rating__pc                             VARCHAR,
	sub_affiliate_brand__c                      VARCHAR,
	sub_region__c                               VARCHAR,
	subsidiaries__c                             VARCHAR,
	sum_of_margin__c                            DOUBLE PRECISION,
	sum_of_visits__c                            DOUBLE PRECISION,
	swift__c                                    VARCHAR,
	swift_in_house_packages__c                  VARCHAR,
	swift_travelist__c                          VARCHAR,
	swift_validation__c                         VARCHAR,
	swift_validation_row__c                     VARCHAR,
	swift_value_netsuite__c                     VARCHAR,
	synxis_id__c                                VARCHAR,
	systemmodstamp                              TIMESTAMP,
	target_account_list__c                      VARCHAR,
	tax_item__c                                 VARCHAR,
	taxable_netsuite__c                         BOOLEAN,
	taxexempt_netsuite__c                       BOOLEAN,
	telephone_ins_prov__c                       VARCHAR,
	telephone_sales_commission__c               DOUBLE PRECISION,
	temp_contact_checkbox__pc                   BOOLEAN,
	third_party_notes__c                        VARCHAR,
	third_party_opt_in__c                       VARCHAR,
	third_party_payment_notes__c                VARCHAR,
	third_party_provider__c                     VARCHAR,
	today__c                                    VARCHAR,
	today_number__c                             DATE,
	today_text__c                               VARCHAR,
	total_credit_cashed__c                      DOUBLE PRECISION,
	total_member_spend__c                       DOUBLE PRECISION,
	total_reviews_ta__c                         DOUBLE PRECISION,
	travelbird_id__c                            VARCHAR,
	travelist_active__c                         BOOLEAN,
	trimmed_hotel_name_contracts__c             VARCHAR,
	tripadvisor_link__c                         VARCHAR,
	tripadvisor_rating__c                       DOUBLE PRECISION,
	trivago_link__c                             VARCHAR,
	tvl_company_signed_date__c                  DATE,
	tvl_old_contract_version__c                 VARCHAR,
	type                                        VARCHAR,
	type_ebd__c                                 DOUBLE PRECISION,
	type_of_third_party__c                      VARCHAR,
	uk_contact_status__c                        VARCHAR,
	uk_opportunity_status__c                    VARCHAR,
	update_customer_ns__c                       BOOLEAN,
	update_vendor_ns__c                         BOOLEAN,
	user_who_experienced_error__c               VARCHAR,
	vat_number__c                               VARCHAR,
	vat_number_id_ns__c                         VARCHAR,
	vat_number_in_house_packages__c             VARCHAR,
	vat_number_travelist__c                     VARCHAR,
	vat_number_validation__c                    VARCHAR,
	vat_number_validation_row__c                VARCHAR,
	vatregnumber_netsuite__c                    VARCHAR,
	vcc_netsuite__c                             DOUBLE PRECISION,
	vendor_customer_sync_readiness__c           VARCHAR,
	vendor_id_netsuite__c                       VARCHAR,
	vendor_insert_ns__c                         BOOLEAN,
	version_8_contract_approval_way__c          VARCHAR,
	virtual_credit_card__c                      VARCHAR,
	virtual_credit_card_in_house_packages__c    VARCHAR,
	virtual_credit_card_ns_id__c                VARCHAR,
	voucher_opt_in__c                           VARCHAR,
	web_phone__pc                               VARCHAR,
	website                                     VARCHAR,
	website_sales_commission__c                 DOUBLE PRECISION,
	weekly_opt_in__c                            VARCHAR,
	wheelchair_accessible__c                    VARCHAR,
	zero_deposit__c                             BOOLEAN,
	zoho_account_id__c                          VARCHAR,
	zoho_contact_id__pc                         VARCHAR,
	CONSTRAINT pk_1 PRIMARY KEY (id)
)
;

INSERT INTO latest_vault.sfsc.account_m_z (schedule_tstamp,
										   run_tstamp,
										   operation_id,
										   created_at,
										   updated_at,
										   row_dataset_name,
										   row_dataset_source,
										   row_loaded_at,
										   row_schedule_tstamp,
										   row_run_tstamp,
										   row_filename,
										   row_file_row_number,
										   row_extract_metadata,
										   id,
										   lastmodifieddate,
										   manual__c,
										   marketing_addendum__c,
										   marketing_id__c,
										   master_contract_field_updated_by__c,
										   master_contract_signed__c,
										   master_contract_signed_group__c,
										   master_contract_wf__c,
										   master_group_field_updated_by__c,
										   masteraccount__c,
										   masteraccountid__c,
										   masterrecordid,
										   media_contact_territory__pc,
										   most_recent_addendum_request__c,
										   most_recent_addendum_status__c,
										   most_recent_booking__c,
										   most_recent_chain_addendum_status__c,
										   most_recent_close_date__c,
										   most_recent_commission__c,
										   most_recent_contract_effective_date__c,
										   most_recent_contract_effective_date_ro__c,
										   most_recent_contract_effective_date_uk__c,
										   most_recent_cw_close_date__c,
										   most_recent_deal_end_date__c,
										   most_recent_finance_edit_datetime__c,
										   most_recent_group_chain_addendum_request__c,
										   most_recent_ihp_addendum_request__c,
										   most_recent_ihp_addendum_status__c,
										   most_recent_ihp_contract_signed_date__c,
										   most_recent_margin__c,
										   most_recent_master_contract_signed_date__c,
										   most_recent_opp__c,
										   most_recent_package_destination__c,
										   most_recent_pd_proposed_start_date__c,
										   most_recent_proposed_start_date__c,
										   most_recent_proposed_start_date__pc,
										   most_recent_sale_id__c,
										   most_recent_successful_deal__c,
										   most_recent_successful_sync__c,
										   most_recent_sync_datetime__c,
										   most_recent_sync_outcome__c,
										   most_recent_ta_check__c,
										   name,
										   nearest_airport_code__c,
										   need_periods__c,
										   new_business_challenge__c,
										   next_proposed_start_date__c,
										   no_gdpr_clause_signed_approved_by_sd__c,
										   notes__pc,
										   notes_on_working_with_se__c,
										   ns_category__c,
										   ns_category_customer__c,
										   ns_contract_type__c,
										   ns_update_bank_details__c,
										   nscrm__balance__c,
										   nscrm__credit_hold__c,
										   nscrm__credit_limit__c,
										   nscrm__days_overdue__c,
										   nscrm__ns_credit_term_id__c,
										   nscrm__ns_customer_category_id__c,
										   nscrm__ns_internal_id__c,
										   nscrm__ns_internal_id__pc,
										   nscrm__ns_sales_rep_id__c,
										   nscrm__ns_shipping_item_id__c,
										   nscrm__ns_subsidiary_id__c,
										   nscrm__ns_tax_item_id__c,
										   nscrm__overdue_balance__c,
										   nscrm__subsidiary__c,
										   nscrm__taxable__c,
										   number_of_active_addendums__c,
										   number_of_addendums__c,
										   number_of_bookings__c,
										   number_of_floors__c,
										   number_of_opps__c,
										   number_of_personal_injuries__c,
										   number_of_rooms__c,
										   numberofemployees,
										   open_opps__pc,
										   opportunity_listing_fee__c,
										   opportunity_to_pull_offers_from__c,
										   opted_in_for_always_on__c,
										   opted_in_for_refundable_deals__c,
										   opted_in_for_suvc__c,
										   original_contractor__c,
										   overduebalance_netsuite__c,
										   ownerid,
										   package_bank_country_selection__c,
										   parent_customer_ns_id__c,
										   parent_ns_id__c,
										   parent_vendor_ns_id__c,
										   parentid,
										   partner_membership__c,
										   partner_product__c,
										   partner_region__c,
										   partner_stage__c,
										   payment_ns_id__c,
										   payment_process__c,
										   payment_process_ns_id__c,
										   payment_terms_contracts__c,
										   payment_terms_days__c,
										   payment_terms_days_in_house_packages__c,
										   payment_terms_days_ns_id__c,
										   person_account_email_address__c,
										   person_account_status__c,
										   person_account_subscription_staatus__c,
										   person_account_territory__c,
										   person_address_city__c,
										   person_address_country__c,
										   person_address_line_1__c,
										   person_address_line_2__c,
										   person_address_post_code__c,
										   person_referred_by__c,
										   personassistantname,
										   personassistantphone,
										   personbirthdate,
										   personcontactid,
										   persondepartment,
										   personemail,
										   personemailbounceddate,
										   personemailbouncedreason,
										   personhasoptedoutofemail,
										   personhomephone,
										   personlastcurequestdate,
										   personlastcuupdatedate,
										   personleadsource,
										   personmailingcity,
										   personmailingcountry,
										   personmailingcountrycode,
										   personmailinggeocodeaccuracy,
										   personmailinglatitude,
										   personmailinglongitude,
										   personmailingpostalcode,
										   personmailingstate,
										   personmailingstatecode,
										   personmailingstreet,
										   personmobilephone,
										   personothercity,
										   personothercountry,
										   personothercountrycode,
										   personothergeocodeaccuracy,
										   personotherlatitude,
										   personotherlongitude,
										   personotherphone,
										   personotherpostalcode,
										   personotherstate,
										   personotherstatecode,
										   personotherstreet,
										   persontitle,
										   phone,
										   photourl,
										   posu_cluster__c,
										   postandcommentprocessed__c,
										   pre_qualification_status__c,
										   pre_qualification_dach__c,
										   pre_qualification_row__c,
										   pre_qualification_uk__c,
										   previous_account_name__c,
										   price_check_url__c,
										   primary__pc,
										   primary_contact__c,
										   primary_contact_email__c,
										   primary_contact_job_title__c,
										   primary_contact_phone__c,
										   primary_contact_to_confirm_preview_link__c,
										   printtransactions_netsuite__c,
										   property_id__c,
										   public_liability_insurance__c,
										   public_liability_insurance_confirmed__c,
										   public_liability_insurance_expiry__c,
										   qc_account_name__c,
										   qc_contact_email__c,
										   qc_contact_job_role__c,
										   qc_contact_name__c,
										   qc_contact_phone__c,
										   qc_destination__c,
										   qc_rating_t_a__c,
										   qc_region__c,
										   qc_rooms__c,
										   qc_shipping_address__c,
										   qc_star_rating__c,
										   qc_sub_region__c,
										   qc_tripadvisor_link__c,
										   qc_tripadvisor_rating__c,
										   qc_website__c,
										   rate_query_end_date__c,
										   rate_query_start_date__c,
										   rating,
										   rating_booking_com__c,
										   rating_ta__c,
										   reason_for_omission__c,
										   record_count__c,
										   recordstocheck__c,
										   recordtypeid,
										   recovered_amount__c,
										   recoveries_next_steps_or_issues__c,
										   recoveries_owner__c,
										   recoveries_payment_method__c,
										   recoveries_status__c,
										   recovery_date__c,
										   red_flag__c,
										   red_flag__pc,
										   red_flag_date_time__c,
										   red_flag_reason__c,
										   red_flag_tp__c,
										   red_flagged_by__c,
										   region__c,
										   region_type__c,
										   remove_red_flag__c,
										   salutation,
										   saq_contact__c,
										   saq_created__c,
										   saq_form_link__c,
										   saq_management_approval_needed__c,
										   saq_passed_date__c,
										   saq_sent_date__c,
										   saq_signed_date__c,
										   saq_status__c,
										   shippingcity,
										   shippingcountry,
										   shippingcountrycode,
										   shippinggeocodeaccuracy,
										   shippinglatitude,
										   shippinglongitude,
										   shippingpostalcode,
										   shippingstate,
										   shippingstatecode,
										   shippingstreet,
										   sicdesc,
										   stage_netsuite__c,
										   star_rating__c,
										   star_rating__pc,
										   sub_affiliate_brand__c,
										   sub_region__c,
										   subsidiaries__c,
										   sum_of_margin__c,
										   sum_of_visits__c,
										   swift__c,
										   swift_in_house_packages__c,
										   swift_travelist__c,
										   swift_validation__c,
										   swift_validation_row__c,
										   swift_value_netsuite__c,
										   synxis_id__c,
										   systemmodstamp,
										   target_account_list__c,
										   tax_item__c,
										   taxable_netsuite__c,
										   taxexempt_netsuite__c,
										   telephone_ins_prov__c,
										   telephone_sales_commission__c,
										   temp_contact_checkbox__pc,
										   third_party_notes__c,
										   third_party_opt_in__c,
										   third_party_payment_notes__c,
										   third_party_provider__c,
										   today__c,
										   today_number__c,
										   today_text__c,
										   total_credit_cashed__c,
										   total_member_spend__c,
										   total_reviews_ta__c,
										   travelbird_id__c,
										   travelist_active__c,
										   trimmed_hotel_name_contracts__c,
										   tripadvisor_link__c,
										   tripadvisor_rating__c,
										   trivago_link__c,
										   tvl_company_signed_date__c,
										   tvl_old_contract_version__c,
										   type,
										   type_ebd__c,
										   type_of_third_party__c,
										   uk_contact_status__c,
										   uk_opportunity_status__c,
										   update_customer_ns__c,
										   update_vendor_ns__c,
										   user_who_experienced_error__c,
										   vat_number__c,
										   vat_number_id_ns__c,
										   vat_number_in_house_packages__c,
										   vat_number_travelist__c,
										   vat_number_validation__c,
										   vat_number_validation_row__c,
										   vatregnumber_netsuite__c,
										   vcc_netsuite__c,
										   vendor_customer_sync_readiness__c,
										   vendor_id_netsuite__c,
										   vendor_insert_ns__c,
										   version_8_contract_approval_way__c,
										   virtual_credit_card__c,
										   virtual_credit_card_in_house_packages__c,
										   virtual_credit_card_ns_id__c,
										   voucher_opt_in__c,
										   web_phone__pc,
										   website,
										   website_sales_commission__c,
										   weekly_opt_in__c,
										   wheelchair_accessible__c,
										   zero_deposit__c,
										   zoho_account_id__c,
										   zoho_contact_id__pc)
SELECT
	schedule_tstamp,
	run_tstamp,
	operation_id,
	created_at,
	updated_at,
	row_dataset_name,
	row_dataset_source,
	row_loaded_at,
	row_schedule_tstamp,
	row_run_tstamp,
	row_filename,
	row_file_row_number,
	row_extract_metadata,
	id,
	lastmodifieddate,
	manual__c,
	marketing_addendum__c,
	marketing_id__c,
	master_contract_field_updated_by__c,
	master_contract_signed__c,
	master_contract_signed_group__c,
	master_contract_wf__c,
	master_group_field_updated_by__c,
	masteraccount__c,
	masteraccountid__c,
	masterrecordid,
	media_contact_territory__pc,
	most_recent_addendum_request__c,
	most_recent_addendum_status__c,
	most_recent_booking__c,
	most_recent_chain_addendum_status__c,
	most_recent_close_date__c,
	most_recent_commission__c,
	most_recent_contract_effective_date__c,
	most_recent_contract_effective_date_ro__c,
	most_recent_contract_effective_date_uk__c,
	most_recent_cw_close_date__c,
	most_recent_deal_end_date__c,
	most_recent_finance_edit_datetime__c,
	most_recent_group_chain_addendum_request__c,
	most_recent_ihp_addendum_request__c,
	most_recent_ihp_addendum_status__c,
	most_recent_ihp_contract_signed_date__c,
	most_recent_margin__c,
	most_recent_master_contract_signed_date__c,
	most_recent_opp__c,
	most_recent_package_destination__c,
	most_recent_pd_proposed_start_date__c,
	most_recent_proposed_start_date__c,
	most_recent_proposed_start_date__pc,
	most_recent_sale_id__c,
	most_recent_successful_deal__c,
	most_recent_successful_sync__c,
	most_recent_sync_datetime__c,
	most_recent_sync_outcome__c,
	most_recent_ta_check__c,
	name,
	nearest_airport_code__c,
	need_periods__c,
	new_business_challenge__c,
	next_proposed_start_date__c,
	no_gdpr_clause_signed_approved_by_sd__c,
	notes__pc,
	notes_on_working_with_se__c,
	ns_category__c,
	ns_category_customer__c,
	ns_contract_type__c,
	ns_update_bank_details__c,
	nscrm__balance__c,
	nscrm__credit_hold__c,
	nscrm__credit_limit__c,
	nscrm__days_overdue__c,
	nscrm__ns_credit_term_id__c,
	nscrm__ns_customer_category_id__c,
	nscrm__ns_internal_id__c,
	nscrm__ns_internal_id__pc,
	nscrm__ns_sales_rep_id__c,
	nscrm__ns_shipping_item_id__c,
	nscrm__ns_subsidiary_id__c,
	nscrm__ns_tax_item_id__c,
	nscrm__overdue_balance__c,
	nscrm__subsidiary__c,
	nscrm__taxable__c,
	number_of_active_addendums__c,
	number_of_addendums__c,
	number_of_bookings__c,
	number_of_floors__c,
	number_of_opps__c,
	number_of_personal_injuries__c,
	number_of_rooms__c,
	numberofemployees,
	open_opps__pc,
	opportunity_listing_fee__c,
	opportunity_to_pull_offers_from__c,
	opted_in_for_always_on__c,
	opted_in_for_refundable_deals__c,
	opted_in_for_suvc__c,
	original_contractor__c,
	overduebalance_netsuite__c,
	ownerid,
	package_bank_country_selection__c,
	parent_customer_ns_id__c,
	parent_ns_id__c,
	parent_vendor_ns_id__c,
	parentid,
	partner_membership__c,
	partner_product__c,
	partner_region__c,
	partner_stage__c,
	payment_ns_id__c,
	payment_process__c,
	payment_process_ns_id__c,
	payment_terms_contracts__c,
	payment_terms_days__c,
	payment_terms_days_in_house_packages__c,
	payment_terms_days_ns_id__c,
	person_account_email_address__c,
	person_account_status__c,
	person_account_subscription_staatus__c,
	person_account_territory__c,
	person_address_city__c,
	person_address_country__c,
	person_address_line_1__c,
	person_address_line_2__c,
	person_address_post_code__c,
	person_referred_by__c,
	personassistantname,
	personassistantphone,
	personbirthdate,
	personcontactid,
	persondepartment,
	personemail,
	personemailbounceddate,
	personemailbouncedreason,
	personhasoptedoutofemail,
	personhomephone,
	personlastcurequestdate,
	personlastcuupdatedate,
	personleadsource,
	personmailingcity,
	personmailingcountry,
	personmailingcountrycode,
	personmailinggeocodeaccuracy,
	personmailinglatitude,
	personmailinglongitude,
	personmailingpostalcode,
	personmailingstate,
	personmailingstatecode,
	personmailingstreet,
	personmobilephone,
	personothercity,
	personothercountry,
	personothercountrycode,
	personothergeocodeaccuracy,
	personotherlatitude,
	personotherlongitude,
	personotherphone,
	personotherpostalcode,
	personotherstate,
	personotherstatecode,
	personotherstreet,
	persontitle,
	phone,
	photourl,
	posu_cluster__c,
	postandcommentprocessed__c,
	pre_qualification_status__c,
	NULL,
	NULL,
	NULL,
	previous_account_name__c,
	price_check_url__c,
	primary__pc,
	primary_contact__c,
	primary_contact_email__c,
	primary_contact_job_title__c,
	primary_contact_phone__c,
	primary_contact_to_confirm_preview_link__c,
	printtransactions_netsuite__c,
	property_id__c,
	public_liability_insurance__c,
	public_liability_insurance_confirmed__c,
	public_liability_insurance_expiry__c,
	qc_account_name__c,
	qc_contact_email__c,
	qc_contact_job_role__c,
	qc_contact_name__c,
	qc_contact_phone__c,
	qc_destination__c,
	qc_rating_t_a__c,
	qc_region__c,
	qc_rooms__c,
	qc_shipping_address__c,
	qc_star_rating__c,
	qc_sub_region__c,
	qc_tripadvisor_link__c,
	qc_tripadvisor_rating__c,
	qc_website__c,
	rate_query_end_date__c,
	rate_query_start_date__c,
	rating,
	rating_booking_com__c,
	rating_ta__c,
	reason_for_omission__c,
	record_count__c,
	recordstocheck__c,
	recordtypeid,
	recovered_amount__c,
	recoveries_next_steps_or_issues__c,
	recoveries_owner__c,
	recoveries_payment_method__c,
	recoveries_status__c,
	recovery_date__c,
	red_flag__c,
	red_flag__pc,
	red_flag_date_time__c,
	red_flag_reason__c,
	red_flag_tp__c,
	red_flagged_by__c,
	region__c,
	region_type__c,
	remove_red_flag__c,
	salutation,
	saq_contact__c,
	saq_created__c,
	saq_form_link__c,
	saq_management_approval_needed__c,
	saq_passed_date__c,
	saq_sent_date__c,
	saq_signed_date__c,
	saq_status__c,
	shippingcity,
	shippingcountry,
	shippingcountrycode,
	shippinggeocodeaccuracy,
	shippinglatitude,
	shippinglongitude,
	shippingpostalcode,
	shippingstate,
	shippingstatecode,
	shippingstreet,
	sicdesc,
	stage_netsuite__c,
	star_rating__c,
	star_rating__pc,
	sub_affiliate_brand__c,
	sub_region__c,
	subsidiaries__c,
	sum_of_margin__c,
	sum_of_visits__c,
	swift__c,
	swift_in_house_packages__c,
	swift_travelist__c,
	swift_validation__c,
	swift_validation_row__c,
	swift_value_netsuite__c,
	synxis_id__c,
	systemmodstamp,
	target_account_list__c,
	tax_item__c,
	taxable_netsuite__c,
	taxexempt_netsuite__c,
	telephone_ins_prov__c,
	telephone_sales_commission__c,
	temp_contact_checkbox__pc,
	third_party_notes__c,
	third_party_opt_in__c,
	third_party_payment_notes__c,
	third_party_provider__c,
	today__c,
	today_number__c,
	today_text__c,
	total_credit_cashed__c,
	total_member_spend__c,
	total_reviews_ta__c,
	travelbird_id__c,
	travelist_active__c,
	trimmed_hotel_name_contracts__c,
	tripadvisor_link__c,
	tripadvisor_rating__c,
	trivago_link__c,
	tvl_company_signed_date__c,
	tvl_old_contract_version__c,
	type,
	type_ebd__c,
	type_of_third_party__c,
	uk_contact_status__c,
	uk_opportunity_status__c,
	update_customer_ns__c,
	update_vendor_ns__c,
	user_who_experienced_error__c,
	vat_number__c,
	vat_number_id_ns__c,
	vat_number_in_house_packages__c,
	vat_number_travelist__c,
	vat_number_validation__c,
	vat_number_validation_row__c,
	vatregnumber_netsuite__c,
	vcc_netsuite__c,
	vendor_customer_sync_readiness__c,
	vendor_id_netsuite__c,
	vendor_insert_ns__c,
	version_8_contract_approval_way__c,
	virtual_credit_card__c,
	virtual_credit_card_in_house_packages__c,
	virtual_credit_card_ns_id__c,
	voucher_opt_in__c,
	web_phone__pc,
	website,
	website_sales_commission__c,
	weekly_opt_in__c,
	wheelchair_accessible__c,
	zero_deposit__c,
	zoho_account_id__c,
	zoho_contact_id__pc
FROM latest_vault.sfsc.account_m_z_20250919
;

./
scripts/
mwaa-cli production "dags backfill --start-date '2024-11-01 00:00:00' --end-date '2024-11-01 00:00:00' --donot-pickle incoming__sfsc__account_m_z__hourly"

SELECT *
FROM latest_vault.sfsc.account_m_z amz
WHERE amz.pre_qualification_uk__c IS NOT NULL
;

SELECT *
FROM data_vault_mvp.dwh.sfsc__account sa
WHERE sa.pre_qualification_dach__c IS NOT NULL
;

SELECT *
FROM se.data_pii.sfsc_account_object sa
WHERE sa.pre_qualification_dach__c IS NOT NULL
;